<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25" zv="Cache for Windows (x86-64) 2013.1.4 (Build 801)" ts="2017-10-31 08:38:39">
<Class name="HTML.js.vuejs.v216.VueJS">
<Description><![CDATA[

<br>Скрипт(JS):
<br> &lt;script src='HTML.js.vuejs.v216.VueJS.cls'&gt;&lt;/script&gt; 
<br> <!--  <script src='HTML.js.vuejs.v216.VueJS.cls'></script>   -->]]></Description>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>64421,45903.804153</TimeChanged>
<TimeCreated>64421,43362.332462</TimeCreated>

<Parameter name="Frag916644214336221796288690">
<Default>IGFuZCB0cmVhdCBpdCBhcyB0ZXh0CiAgICAgICAgICBuZXh0ID0gcmVzdCQxLmluZGV4T2YoJzwn
LCAxKTsKICAgICAgICAgIGlmIChuZXh0IDwgMCkgeyBicmVhayB9CiAgICAgICAgICB0ZXh0RW5k
ICs9IG5leHQ7CiAgICAgICAgICByZXN0JDEgPSBodG1sLnNsaWNlKHRleHRFbmQpOwogICAgICAg
IH0KICAgICAgICB0ZXh0ID0gaHRtbC5zdWJzdHJpbmcoMCwgdGV4dEVuZCk7CiAgICAgICAgYWR2
YW5jZSh0ZXh0RW5kKTsKICAgICAgfQoKICAgICAgaWYgKHRleHRFbmQgPCAwKSB7CiAgICAgICAg
dGV4dCA9IGh0bWw7CiAgICAgICAgaHRtbCA9ICcnOwogICAgICB9CgogICAgICBpZiAob3B0aW9u
cy5jaGFycyAmJiB0ZXh0KSB7CiAgICAgICAgb3B0aW9ucy5jaGFycyh0ZXh0KTsKICAgICAgfQog
ICAgfSBlbHNlIHsKICAgICAgdmFyIHN0YWNrZWRUYWcgPSBsYXN0VGFnLnRvTG93ZXJDYXNlKCk7
CiAgICAgIHZhciByZVN0YWNrZWRUYWcgPSByZUNhY2hlW3N0YWNrZWRUYWddIHx8IChyZUNhY2hl
W3N0YWNrZWRUYWddID0gbmV3IFJlZ0V4cCgnKFtcXHNcXFNdKj8pKDwvJyArIHN0YWNrZWRUYWcg
KyAnW14+XSo+KScsICdpJykpOwogICAgICB2YXIgZW5kVGFnTGVuZ3RoID0gMDsKICAgICAgdmFy
IHJlc3QgPSBodG1sLnJlcGxhY2UocmVTdGFja2VkVGFnLCBmdW5jdGlvbiAoYWxsLCB0ZXh0LCBl
bmRUYWcpIHsKICAgICAgICBlbmRUYWdMZW5ndGggPSBlbmRUYWcubGVuZ3RoOwogICAgICAgIGlm
IChzdGFja2VkVGFnICE9PSAnc2NyaXB0JyAmJiBzdGFja2VkVGFnICE9PSAnc3R5bGUnICYmIHN0
YWNrZWRUYWcgIT09ICdub3NjcmlwdCcpIHsKICAgICAgICAgIHRleHQgPSB0ZXh0CiAgICAgICAg
ICAgIC5yZXBsYWNlKC88IS0tKFtcc1xTXSo/KS0tPi9nLCAnJDEnKQogICAgICAgICAgICAucmVw
bGFjZSgvPCFcW0NEQVRBXFsoW1xzXFNdKj8pXV0+L2csICckMScpOwogICAgICAgIH0KICAgICAg
ICBpZiAob3B0aW9ucy5jaGFycykgewogICAgICAgICAgb3B0aW9ucy5jaGFycyh0ZXh0KTsKICAg
ICAgICB9CiAgICAgICAgcmV0dXJuICcnCiAgICAgIH0pOwogICAgICBpbmRleCArPSBodG1sLmxl
bmd0aCAtIHJlc3QubGVuZ3RoOwogICAgICBodG1sID0gcmVzdDsKICAgICAgcGFyc2VFbmRUYWco
JzwvJyArIHN0YWNrZWRUYWcgKyAnPicsIHN0YWNrZWRUYWcsIGluZGV4IC0gZW5kVGFnTGVuZ3Ro
LCBpbmRleCk7CiAgICB9CgogICAgaWYgKGh0bWwgPT09IGxhc3QgJiYgb3B0aW9ucy5jaGFycykg
ewogICAgICBvcHRpb25zLmNoYXJzKGh0bWwpOwogICAgICBicmVhawogICAgfQogIH0KCiAgLy8g
Q2xlYW4gdXAgYW55IHJlbWFpbmluZyB0YWdzCiAgcGFyc2VFbmRUYWcoKTsKCiAgZnVuY3Rpb24g
YWR2YW5jZSAobikgewogICAgaW5kZXggKz0gbjsKICAgIGh0bWwgPSBodG1sLnN1YnN0cmluZyhu
KTsKICB9CgogIGZ1bmN0aW9uIHBhcnNlU3RhcnRUYWcgKCkgewogICAgdmFyIHN0YXJ0ID0gaHRt
bC5tYXRjaChzdGFydFRhZ09wZW4pOwogICAgaWYgKHN0YXJ0KSB7CiAgICAgIHZhciBtYXRjaCA9
IHsKICAgICAgICB0YWdOYW1lOiBzdGFydFsxXSwKICAgICAgICBhdHRyczogW10sCiAgICAgICAg
c3RhcnQ6IGluZGV4CiAgICAgIH07CiAgICAgIGFkdmFuY2Uoc3RhcnRbMF0ubGVuZ3RoKTsKICAg
ICAgdmFyIGVuZCwgYXR0cjsKICAgICAgd2hpbGUgKCEoZW5kID0gaHRtbC5tYXRjaChzdGFydFRh
Z0Nsb3NlKSkgJiYgKGF0dHIgPSBodG1sLm1hdGNoKGF0dHJpYnV0ZSkpKSB7CiAgICAgICAgYWR2
YW5jZShhdHRyWzBdLmxlbmd0aCk7CiAgICAgICAgbWF0Y2guYXR0cnMucHVzaChhdHRyKTsKICAg
ICAgfQogICAgICBpZiAoZW5kKSB7CiAgICAgICAgbWF0Y2gudW5hcnlTbGFzaCA9IGVuZFsxXTsK
ICAgICAgICBhZHZhbmNlKGVuZFswXS5sZW5ndGgpOwogICAgICAgIG1hdGNoLmVuZCA9IGluZGV4
OwogICAgICAgIHJldHVybiBtYXRjaAogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBoYW5k
bGVTdGFydFRhZyAobWF0Y2gpIHsKICAgIHZhciB0YWdOYW1lID0gbWF0Y2gudGFnTmFtZTsKICAg
IHZhciB1bmFyeVNsYXNoID0gbWF0Y2gudW5hcnlTbGFzaDsKCiAgICBpZiAoZXhwZWN0SFRNTCkg
ewogICAgICBpZiAobGFzdFRhZyA9PT0gJ3AnICYmIGlzTm9uUGhyYXNpbmdUYWcodGFnTmFtZSkp
IHsKICAgICAgICBwYXJzZUVuZFRhZygnJywgbGFzdFRhZyk7CiAgICAgIH0KICAgICAgaWYgKGNh
bkJlTGVmdE9wZW5UYWcodGFnTmFtZSkgJiYgbGFzdFRhZyA9PT0gdGFnTmFtZSkgewogICAgICAg
IHBhcnNlRW5kVGFnKCcnLCB0YWdOYW1lKTsKICAgICAgfQogICAgfQoKICAgIHZhciB1bmFyeSA9
IGlzVW5hcnlUYWckJDEodGFnTmFtZSkgfHwgdGFnTmFtZSA9PT0gJ2h0bWwnICYmIGxhc3RUYWcg
PT09ICdoZWFkJyB8fCAhIXVuYXJ5U2xhc2g7CgogICAgdmFyIGwgPSBtYXRjaC5hdHRycy5sZW5n
dGg7CiAgICB2YXIgYXR0cnMgPSBuZXcgQXJyYXkobCk7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8
IGw7IGkrKykgewogICAgICB2YXIgYXJncyA9IG1hdGNoLmF0dHJzW2ldOwogICAgICAvLyBoYWNr
aXNoIHdvcmsgYXJvdW5kIEZGIGJ1ZyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3df
YnVnLmNnaT9pZD0zNjk3NzgKICAgICAgaWYgKElTX1JFR0VYX0NBUFRVUklOR19CUk9LRU4gJiYg
YXJnc1swXS5pbmRleE9mKCciIicpID09PSAtMSkgewogICAgICAgIGlmIChhcmdzWzNdID09PSAn
JykgeyBkZWxldGUgYXJnc1szXTsgfQogICAgICAgIGlmIChhcmdzWzRdID09PSAnJykgeyBkZWxl
dGUgYXJnc1s0XTsgfQogICAgICAgIGlmIChhcmdzWzVdID09PSAnJykgeyBkZWxldGUgYXJnc1s1
XTsgfQogICAgICB9CiAgICAgIHZhciB2YWx1ZSA9IGFyZ3NbM10gfHwgYXJnc1s0XSB8fCBhcmdz
WzVdIHx8ICcnOwogICAgICBhdHRyc1tpXSA9IHsKICAgICAgICBuYW1lOiBhcmdzWzFdLAogICAg
ICAgIHZhbHVlOiBkZWNvZGVBdHRyKAogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBvcHRpb25z
LnNob3VsZERlY29kZU5ld2xpbmVzCiAgICAgICAgKQogICAgICB9OwogICAgfQoKICAgIGlmICgh
dW5hcnkpIHsKICAgICAgc3RhY2sucHVzaCh7IHRhZzogdGFnTmFtZSwgYXR0cnM6IGF0dHJzIH0p
OwogICAgICBsYXN0VGFnID0gdGFnTmFtZTsKICAgICAgdW5hcnlTbGFzaCA9ICcnOwogICAgfQoK
ICAgIGlmIChvcHRpb25zLnN0YXJ0KSB7CiAgICAgIG9wdGlvbnMuc3RhcnQodGFnTmFtZSwgYXR0
cnMsIHVuYXJ5LCBtYXRjaC5zdGFydCwgbWF0Y2guZW5kKTsKICAgIH0KICB9CgogIGZ1bmN0aW9u
IHBhcnNlRW5kVGFnICh0YWcsIHRhZ05hbWUsIHN0YXJ0LCBlbmQpIHsKICAgIHZhciBwb3M7CiAg
ICBpZiAoc3RhcnQgPT0gbnVsbCkgeyBzdGFydCA9IGluZGV4OyB9CiAgICBpZiAoZW5kID09IG51
bGwpIHsgZW5kID0gaW5kZXg7IH0KCiAgICAvLyBGaW5kIHRoZSBjbG9zZXN0IG9wZW5lZCB0YWcg
b2YgdGhlIHNhbWUgdHlwZQogICAgaWYgKHRhZ05hbWUpIHsKICAgICAgdmFyIG5lZWRsZSA9IHRh
Z05hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgZm9yIChwb3MgPSBzdGFjay5sZW5ndGggLSAxOyBw
b3MgPj0gMDsgcG9zLS0pIHsKICAgICAgICBpZiAoc3RhY2tbcG9zXS50YWcudG9Mb3dlckNhc2Uo
KSA9PT0gbmVlZGxlKSB7CiAgICAgICAgICBicmVhawogICAgICAgIH0KICAgICAgfQogICAgfSBl
bHNlIHsKICAgICAgLy8gSWYgbm8gdGFnIG5hbWUgaXMgcHJvdmlkZWQsIGNsZWFuIHNob3AKICAg
ICAgcG9zID0gMDsKICAgIH0KCiAgICBpZiAocG9zID49IDApIHsKICAgICAgLy8gQ2xvc2UgYWxs
IHRoZSBvcGVuIGVsZW1lbnRzLCB1cCB0aGUgc3RhY2sKICAgICAgZm9yICh2YXIgaSA9IHN0YWNr
Lmxlbmd0aCAtIDE7IGkgPj0gcG9zOyBpLS0pIHsKICAgICAgICBpZiAob3B0aW9ucy5lbmQpIHsK
ICAgICAgICAgIG9wdGlvbnMuZW5kKHN0YWNrW2ldLnRhZywgc3RhcnQsIGVuZCk7CiAgICAgICAg
fQogICAgICB9CgogICAgICAvLyBSZW1vdmUgdGhlIG9wZW4gZWxlbWVudHMgZnJvbSB0aGUgc3Rh
Y2sKICAgICAgc3RhY2subGVuZ3RoID0gcG9zOwogICAgICBsYXN0VGFnID0gcG9zICYmIHN0YWNr
W3BvcyAtIDFdLnRhZzsKICAgIH0gZWxzZSBpZiAodGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAn
YnInKSB7CiAgICAgIGlmIChvcHRpb25zLnN0YXJ0KSB7CiAgICAgICAgb3B0aW9ucy5zdGFydCh0
YWdOYW1lLCBbXSwgdHJ1ZSwgc3RhcnQsIGVuZCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodGFn
TmFtZS50b0xvd2VyQ2FzZSgpID09PSAncCcpIHsKICAgICAgaWYgKG9wdGlvbnMuc3RhcnQpIHsK
ICAgICAgICBvcHRpb25zLnN0YXJ0KHRhZ05hbWUsIFtdLCBmYWxzZSwgc3RhcnQsIGVuZCk7CiAg
ICAgIH0KICAgICAgaWYgKG9wdGlvbnMuZW5kKSB7CiAgICAgICAgb3B0aW9ucy5lbmQodGFnTmFt
ZSwgc3RhcnQsIGVuZCk7CiAgICAgIH0KICAgIH0KICB9Cn0KCi8qICAqLwoKZnVuY3Rpb24gcGFy
c2VGaWx0ZXJzIChleHApIHsKICB2YXIgaW5TaW5nbGUgPSBmYWxzZTsKICB2YXIgaW5Eb3VibGUg
PSBmYWxzZTsKICB2YXIgaW5UZW1wbGF0ZVN0cmluZyA9IGZhbHNlOwogIHZhciBpblJlZ2V4ID0g
ZmFsc2U7CiAgdmFyIGN1cmx5ID0gMDsKICB2YXIgc3F1YXJlID0gMDsKICB2YXIgcGFyZW4gPSAw
OwogIHZhciBsYXN0RmlsdGVySW5kZXggPSAwOwogIHZhciBjLCBwcmV2LCBpLCBleHByZXNzaW9u
LCBmaWx0ZXJzOwoKICBmb3IgKGkgPSAwOyBpIDwgZXhwLmxlbmd0aDsgaSsrKSB7CiAgICBwcmV2
ID0gYzsKICAgIGMgPSBleHAuY2hhckNvZGVBdChpKTsKICAgIGlmIChpblNpbmdsZSkgewogICAg
ICBpZiAoYyA9PT0gMHgyNyAmJiBwcmV2ICE9PSAweDVDKSB7IGluU2luZ2xlID0gZmFsc2U7IH0K
ICAgIH0gZWxzZSBpZiAoaW5Eb3VibGUpIHsKICAgICAgaWYgKGMgPT09IDB4MjIgJiYgcHJldiAh
PT0gMHg1QykgeyBpbkRvdWJsZSA9IGZhbHNlOyB9CiAgICB9IGVsc2UgaWYgKGluVGVtcGxhdGVT
dHJpbmcpIHsKICAgICAgaWYgKGMgPT09IDB4NjAgJiYgcHJldiAhPT0gMHg1QykgeyBpblRlbXBs
YXRlU3RyaW5nID0gZmFsc2U7IH0KICAgIH0gZWxzZSBpZiAoaW5SZWdleCkgewogICAgICBpZiAo
YyA9PT0gMHgyZiAmJiBwcmV2ICE9PSAweDVDKSB7IGluUmVnZXggPSBmYWxzZTsgfQogICAgfSBl
bHNlIGlmICgKICAgICAgYyA9PT0gMHg3QyAmJiAvLyBwaXBlCiAgICAgIGV4cC5jaGFyQ29kZUF0
KGkgKyAxKSAhPT0gMHg3QyAmJgogICAgICBleHAuY2hhckNvZGVBdChpIC0gMSkgIT09IDB4N0Mg
JiYKICAgICAgIWN1cmx5ICYmICFzcXVhcmUgJiYgIXBhcmVuCiAgICApIHsKICAgICAgaWYgKGV4
cHJlc3Npb24gPT09IHVuZGVmaW5lZCkgewogICAgICAgIC8vIGZpcnN0IGZpbHRlciwgZW5kIG9m
IGV4cHJlc3Npb24KICAgICAgICBsYXN0RmlsdGVySW5kZXggPSBpICsgMTsKICAgICAgICBleHBy
ZXNzaW9uID0gZXhwLnNsaWNlKDAsIGkpLnRyaW0oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBw
dXNoRmlsdGVyKCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHN3aXRjaCAoYykgewogICAg
ICAgIGNhc2UgMHgyMjogaW5Eb3VibGUgPSB0cnVlOyBicmVhayAgICAgICAgIC8vICIKICAgICAg
ICBjYXNlIDB4Mjc6IGluU2luZ2xlID0gdHJ1ZTsgYnJlYWsgICAgICAgICAvLyAnCiAgICAgICAg
Y2FzZSAweDYwOiBpblRlbXBsYXRlU3RyaW5nID0gdHJ1ZTsgYnJlYWsgLy8gYAogICAgICAgIGNh
c2UgMHgyODogcGFyZW4rKzsgYnJlYWsgICAgICAgICAgICAgICAgIC8vICgKICAgICAgICBjYXNl
IDB4Mjk6IHBhcmVuLS07IGJyZWFrICAgICAgICAgICAgICAgICAvLyApCiAgICAgICAgY2FzZSAw
eDVCOiBzcXVhcmUrKzsgYnJlYWsgICAgICAgICAgICAgICAgLy8gWwogICAgICAgIGNhc2UgMHg1
RDogc3F1YXJlLS07IGJyZWFrICAgICAgICAgICAgICAgIC8vIF0KICAgICAgICBjYXNlIDB4N0I6
IGN1cmx5Kys7IGJyZWFrICAgICAgICAgICAgICAgICAvLyB7CiAgICAgICAgY2FzZSAweDdEOiBj
dXJseS0tOyBicmVhayAgICAgICAgICAgICAgICAgLy8gfQogICAgICB9CiAgICAgIGlmIChjID09
PSAweDJmKSB7IC8vIC8KICAgICAgICB2YXIgaiA9IGkgLSAxOwogICAgICAgIHZhciBwID0gKHZv
aWQgMCk7CiAgICAgICAgLy8gZmluZCBmaXJzdCBub24td2hpdGVzcGFjZSBwcmV2IGNoYXIKICAg
ICAgICBmb3IgKDsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgIHAgPSBleHAuY2hhckF0KGopOwog
ICAgICAgICAgaWYgKHAgIT09ICcgJykgeyBicmVhayB9CiAgICAgICAgfQogICAgICAgIGlmICgh
cCB8fCAhL1tcdyRdLy50ZXN0KHApKSB7CiAgICAgICAgICBpblJlZ2V4ID0gdHJ1ZTsKICAgICAg
ICB9CiAgICAgIH0KICAgIH0KICB9CgogIGlmIChleHByZXNzaW9uID09PSB1bmRlZmluZWQpIHsK
ICAgIGV4cHJlc3Npb24gPSBleHAuc2xpY2UoMCwgaSkudHJpbSgpOwogIH0gZWxzZSBpZiAobGFz
dEZpbHRlckluZGV4ICE9PSAwKSB7CiAgICBwdXNoRmlsdGVyKCk7CiAgfQoKICBmdW5jdGlvbiBw
dXNoRmlsdGVyICgpIHsKICAgIChmaWx0ZXJzIHx8IChmaWx0ZXJzID0gW10pKS5wdXNoKGV4cC5z
bGljZShsYXN0RmlsdGVySW5kZXgsIGkpLnRyaW0oKSk7CiAgICBsYXN0RmlsdGVySW5kZXggPSBp
ICsgMTsKICB9CgogIGlmIChmaWx0ZXJzKSB7CiAgICBmb3IgKGkgPSAwOyBpIDwgZmlsdGVycy5s
ZW5ndGg7IGkrKykgewogICAgICBleHByZXNzaW9uID0gd3JhcEZpbHRlcihleHByZXNzaW9uLCBm
aWx0ZXJzW2ldKTsKICAgIH0KICB9CgogIHJldHVybiBleHByZXNzaW9uCn0KCmZ1bmN0aW9uIHdy
YXBGaWx0ZXIgKGV4cCwgZmlsdGVyKSB7CiAgdmFyIGkgPSBmaWx0ZXIuaW5kZXhPZignKCcpOwog
IGlmIChpIDwgMCkgewogICAgLy8gX2Y6IHJlc29sdmVGaWx0ZXIKICAgIHJldHVybiAoIl9mKFwi
IiArIGZpbHRlciArICJcIikoIiArIGV4cCArICIpIikKICB9IGVsc2UgewogICAgdmFyIG5hbWUg
PSBmaWx0ZXIuc2xpY2UoMCwgaSk7CiAgICB2YXIgYXJncyA9IGZpbHRlci5zbGljZShpICsgMSk7
CiAgICByZXR1cm4gKCJfZihcIiIgKyBuYW1lICsgIlwiKSgiICsgZXhwICsgIiwiICsgYXJncykK
ICB9Cn0KCi8qICAqLwoKdmFyIGRlZmF1bHRUYWdSRSA9IC9ce1x7KCg/Oi58XG4pKz8pXH1cfS9n
Owp2YXIgcmVnZXhFc2NhcGVSRSA9IC9bLS4qKz9eJHt9KCl8W1xdL1xcXS9nOwoKdmFyIGJ1aWxk
UmVnZXggPSBjYWNoZWQoZnVuY3Rpb24gKGRlbGltaXRlcnMpIHsKICB2YXIgb3BlbiA9IGRlbGlt
aXRlcnNbMF0ucmVwbGFjZShyZWdleEVzY2FwZVJFLCAnXFwkJicpOwogIHZhciBjbG9zZSA9IGRl
bGltaXRlcnNbMV0ucmVwbGFjZShyZWdleEVzY2FwZVJFLCAnXFwkJicpOwogIHJldHVybiBuZXcg
UmVnRXhwKG9wZW4gKyAnKCg/Oi58XFxuKSs/KScgKyBjbG9zZSwgJ2cnKQp9KTsKCmZ1bmN0aW9u
IHBhcnNlVGV4dCAoCiAgdGV4dCwKICBkZWxpbWl0ZXJzCikgewogIHZhciB0YWdSRSA9IGRlbGlt
aXRlcnMgPyBidWlsZFJlZ2V4KGRlbGltaXRlcnMpIDogZGVmYXVsdFRhZ1JFOwogIGlmICghdGFn
UkUudGVzdCh0ZXh0KSkgewogICAgcmV0dXJuCiAgfQogIHZhciB0b2tlbnMgPSBbXTsKICB2YXIg
bGFzdEluZGV4ID0gdGFnUkUubGFzdEluZGV4ID0gMDsKICB2YXIgbWF0Y2gsIGluZGV4OwogIHdo
aWxlICgobWF0Y2ggPSB0YWdSRS5leGVjKHRleHQpKSkgewogICAgaW5kZXggPSBtYXRjaC5pbmRl
eDsKICAgIC8vIHB1c2ggdGV4dCB0b2tlbgogICAgaWYgKGluZGV4ID4gbGFzdEluZGV4KSB7CiAg
ICAgIHRva2Vucy5wdXNoKEpTT04uc3RyaW5naWZ5KHRleHQuc2xpY2UobGFzdEluZGV4LCBpbmRl
eCkpKTsKICAgIH0KICAgIC8vIHRhZyB0b2tlbgogICAgdmFyIGV4cCA9IHBhcnNlRmlsdGVycyht
YXRjaFsxXS50cmltKCkpOwogICAgdG9rZW5zLnB1c2goKCJfcygiICsgZXhwICsgIikiKSk7CiAg
ICBsYXN0SW5kZXggPSBpbmRleCArIG1hdGNoWzBdLmxlbmd0aDsKICB9CiAgaWYgKGxhc3RJbmRl
eCA8IHRleHQubGVuZ3RoKSB7CiAgICB0b2tlbnMucHVzaChKU09OLnN0cmluZ2lmeSh0ZXh0LnNs
aWNlKGxhc3RJbmRleCkpKTsKICB9CiAgcmV0dXJuIHRva2Vucy5qb2luKCcrJykKfQoKLyogICov
CgpmdW5jdGlvbiBiYXNlV2FybiAobXNnKSB7CiAgY29uc29sZS5lcnJvcigoIltWdWUgcGFyc2Vy
XTogIiArIG1zZykpOwp9CgpmdW5jdGlvbiBwbHVja01vZHVsZUZ1bmN0aW9uICgKICBtb2R1bGVz
LAogIGtleQopIHsKICByZXR1cm4gbW9kdWxlcwogICAgPyBtb2R1bGVzLm1hcChmdW5jdGlvbiAo
bSkgeyByZXR1cm4gbVtrZXldOyB9KS5maWx0ZXIoZnVuY3Rpb24gKF8pIHsgcmV0dXJuIF87IH0p
CiAgICA6IFtdCn0KCmZ1bmN0aW9uIGFkZFByb3AgKGVsLCBuYW1lLCB2YWx1ZSkgewogIChlbC5w
cm9wcyB8fCAoZWwucHJvcHMgPSBbXSkpLnB1c2goeyBuYW1lOiBuYW1lLCB2YWx1ZTogdmFsdWUg
fSk7Cn0KCmZ1bmN0aW9uIGFkZEF0dHIgKGVsLCBuYW1lLCB2YWx1ZSkgewogIChlbC5hdHRycyB8
fCAoZWwuYXR0cnMgPSBbXSkpLnB1c2goeyBuYW1lOiBuYW1lLCB2YWx1ZTogdmFsdWUgfSk7Cn0K
CmZ1bmN0aW9uIGFkZERpcmVjdGl2ZSAoCiAgZWwsCiAgbmFtZSwKICByYXdOYW1lLAogIHZhbHVl
LAogIGFyZywKICBtb2RpZmllcnMKKSB7CiAgKGVsLmRpcmVjdGl2ZXMgfHwgKGVsLmRpcmVjdGl2
ZXMgPSBbXSkpLnB1c2goeyBuYW1lOiBuYW1lLCByYXdOYW1lOiByYXdOYW1lLCB2YWx1ZTogdmFs
dWUsIGFyZzogYXJnLCBtb2RpZmllcnM6IG1vZGlmaWVycyB9KTsKfQoKZnVuY3Rpb24gYWRkSGFu
ZGxlciAoCiAgZWwsCiAgbmFtZSwKICB2YWx1ZSwKICBtb2RpZmllcnMsCiAgaW1wb3J0YW50Cikg
ewogIC8vIGNoZWNrIGNhcHR1cmUgbW9kaWZpZXIKICBpZiAobW9kaWZpZXJzICYmIG1vZGlmaWVy
cy5jYXB0dXJlKSB7CiAgICBkZWxldGUgbW9kaWZpZXJzLmNhcHR1cmU7CiAgICBuYW1lID0gJyEn
ICsgbmFtZTsgLy8gbWFyayB0aGUgZXZlbnQgYXMgY2FwdHVyZWQKICB9CiAgaWYgKG1vZGlmaWVy
cyAmJiBtb2RpZmllcnMub25jZSkgewogICAgZGVsZXRlIG1vZGlmaWVycy5vbmNlOwogICAgbmFt
ZSA9ICd+JyArIG5hbWU7IC8vIG1hcmsgdGhlIGV2ZW50IGFzIG9uY2UKICB9CiAgdmFyIGV2ZW50
czsKICBpZiAobW9kaWZpZXJzICYmIG1vZGlmaWVycy5uYXRpdmUpIHsKICAgIGRlbGV0ZSBtb2Rp
ZmllcnMubmF0aXZlOwogICAgZXZlbnRzID0gZWwubmF0aXZlRXZlbnRzIHx8IChlbC5uYXRpdmVF
dmVudHMgPSB7fSk7CiAgfSBlbHNlIHsKICAgIGV2ZW50cyA9IGVsLmV2ZW50cyB8fCAoZWwuZXZl
bnRzID0ge30pOwogIH0KICB2YXIgbmV3SGFuZGxlciA9IHsgdmFsdWU6IHZhbHVlLCBtb2RpZmll
cnM6IG1vZGlmaWVycyB9OwogIHZhciBoYW5kbGVycyA9IGV2ZW50c1tuYW1lXTsKICAvKiBpc3Rh
bmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAoQXJyYXkuaXNBcnJheShoYW5kbGVycykpIHsKICAgIGlt
cG9ydGFudCA/IGhhbmRsZXJzLnVuc2hpZnQobmV3SGFuZGxlcikgOiBoYW5kbGVycy5wdXNoKG5l
d0hhbmRsZXIpOwogIH0gZWxzZSBpZiAoaGFuZGxlcnMpIHsKICAgIGV2ZW50c1tuYW1lXSA9IGlt
cG9ydGFudCA/IFtuZXdIYW5kbGVyLCBoYW5kbGVyc10gOiBbaGFuZGxlcnMsIG5ld0hhbmRsZXJd
OwogIH0gZWxzZSB7CiAgICBldmVudHNbbmFtZV0gPSBuZXdIYW5kbGVyOwogIH0KfQoKZnVuY3Rp
b24gZ2V0QmluZGluZ0F0dHIgKAogIGVsLAogIG5hbWUsCiAgZ2V0U3RhdGljCikgewogIHZhciBk
eW5hbWljVmFsdWUgPQogICAgZ2V0QW5kUmVtb3ZlQXR0cihlbCwgJzonICsgbmFtZSkgfHwKICAg
IGdldEFuZFJlbW92ZUF0dHIoZWwsICd2LWJpbmQ6JyArIG5hbWUpOwogIGlmIChkeW5hbWljVmFs
dWUgIT0gbnVsbCkgewogICAgcmV0dXJuIHBhcnNlRmlsdGVycyhkeW5hbWljVmFsdWUpCiAgfSBl
bHNlIGlmIChnZXRTdGF0aWMgIT09IGZhbHNlKSB7CiAgICB2YXIgc3RhdGljVmFsdWUgPSBnZXRB
bmRSZW1vdmVBdHRyKGVsLCBuYW1lKTsKICAgIGlmIChzdGF0aWNWYWx1ZSAhPSBudWxsKSB7CiAg
ICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShzdGF0aWNWYWx1ZSkKICAgIH0KICB9Cn0KCmZ1bmN0
aW9uIGdldEFuZFJlbW92ZUF0dHIgKGVsLCBuYW1lKSB7CiAgdmFyIHZhbDsKICBpZiAoKHZhbCA9
IGVsLmF0dHJzTWFwW25hbWVdKSAhPSBudWxsKSB7CiAgICB2YXIgbGlzdCA9IGVsLmF0dHJzTGlz
dDsKICAgIGZvciAodmFyIGkgPSAwLCBsID0gbGlzdC5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAg
ICAgaWYgKGxpc3RbaV0ubmFtZSA9PT0gbmFtZSkgewogICAgICAgIGxpc3Quc3BsaWNlKGksIDEp
OwogICAgICAgIGJyZWFrCiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHZhbAp9Cgp2YXIgbGVu
Owp2YXIgc3RyOwp2YXIgY2hyOwp2YXIgaW5kZXgkMTsKdmFyIGV4cHJlc3Npb25Qb3M7CnZhciBl
eHByZXNzaW9uRW5kUG9zOwoKLyoqCiAqIHBhcnNlIGRpcmVjdGl2ZSBtb2RlbCB0byBkbyB0aGUg
YXJyYXkgdXBkYXRlIHRyYW5zZm9ybS4gYVtpZHhdID0gdmFsID0+ICQkYS5zcGxpY2UoJCRpZHgs
IDEsIHZhbCkKICoKICogZm9yIGxvb3AgcG9zc2libGUgY2FzZXM6CiAqCiAqIC0gdGVzdAogKiAt
IHRlc3RbaWR4XQogKiAtIHRlc3RbdGVzdDFbaWR4XV0KICogLSB0ZXN0WyJhIl1baWR4XQogKiAt
IHh4eC50ZXN0W2FbYV0udGVzdDFbaWR4XV0KICogLSB0ZXN0Lnh4eC5hWyJhc2EiXVt0ZXN0MVtp
ZHhdXQogKgogKi8KCmZ1bmN0aW9uIHBhcnNlTW9kZWwgKHZhbCkgewogIHN0ciA9IHZhbDsKICBs
ZW4gPSBzdHIubGVuZ3RoOwogIGluZGV4JDEgPSBleHByZXNzaW9uUG9zID0gZXhwcmVzc2lvbkVu
ZFBvcyA9IDA7CgogIGlmICh2YWwuaW5kZXhPZignWycpIDwgMCB8fCB2YWwubGFzdEluZGV4T2Yo
J10nKSA8IGxlbiAtIDEpIHsKICAgIHJldHVybiB7CiAgICAgIGV4cDogdmFsLAogICAgICBpZHg6
IG51bGwKICAgIH0KICB9CgogIHdoaWxlICghZW9mKCkpIHsKICAgIGNociA9IG5leHQoKTsKICAg
IC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKGlzU3RyaW5nU3RhcnQoY2hyKSkgewog
ICAgICBwYXJzZVN0cmluZyhjaHIpOwogICAgfSBlbHNlIGlmIChjaHIgPT09IDB4NUIpIHsKICAg
ICAgcGFyc2VCcmFja2V0KGNocik7CiAgICB9CiAgfQoKICByZXR1cm4gewogICAgZXhwOiB2YWwu
c3Vic3RyaW5nKDAsIGV4cHJlc3Npb25Qb3MpLAogICAgaWR4OiB2YWwuc3Vic3RyaW5nKGV4cHJl
c3Npb25Qb3MgKyAxLCBleHByZXNzaW9uRW5kUG9zKQogIH0KfQoKZnVuY3Rpb24gbmV4dCAoKSB7
CiAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KCsraW5kZXgkMSkKfQoKZnVuY3Rpb24gZW9mICgpIHsK
ICByZXR1cm4gaW5kZXgkMSA+PSBsZW4KfQoKZnVuY3Rpb24gaXNTdHJpbmdTdGFydCAoY2hyKSB7
CiAgcmV0dXJuIGNociA9PT0gMHgyMiB8fCBjaHIgPT09IDB4MjcKfQoKZnVuY3Rpb24gcGFyc2VC
cmFja2V0IChjaHIpIHsKICB2YXIgaW5CcmFja2V0ID0gMTsKICBleHByZXNzaW9uUG9zID0gaW5k
ZXgkMTsKICB3aGlsZSAoIWVvZigpKSB7CiAgICBjaHIgPSBuZXh0KCk7CiAgICBpZiAoaXNTdHJp
bmdTdGFydChjaHIpKSB7CiAgICAgIHBhcnNlU3RyaW5nKGNocik7CiAgICAgIGNvbnRpbnVlCiAg
ICB9CiAgICBpZiAoY2hyID09PSAweDVCKSB7IGluQnJhY2tldCsrOyB9CiAgICBpZiAoY2hyID09
PSAweDVEKSB7IGluQnJhY2tldC0tOyB9CiAgICBpZiAoaW5CcmFja2V0ID09PSAwKSB7CiAgICAg
IGV4cHJlc3Npb25FbmRQb3MgPSBpbmRleCQxOwogICAgICBicmVhawogICAgfQogIH0KfQoKZnVu
Y3Rpb24gcGFyc2VTdHJpbmcgKGNocikgewogIHZhciBzdHJpbmdRdW90ZSA9IGNocjsKICB3aGls
ZSAoIWVvZigpKSB7CiAgICBjaHIgPSBuZXh0KCk7CiAgICBpZiAoY2hyID09PSBzdHJpbmdRdW90
ZSkgewogICAgICBicmVhawogICAgfQogIH0KfQoKLyogICovCgp2YXIgZGlyUkUgPSAvXnYtfF5A
fF46LzsKdmFyIGZvckFsaWFzUkUgPSAvKC4qPylccysoPzppbnxvZilccysoLiopLzsKdmFyIGZv
ckl0ZXJhdG9yUkUgPSAvXCgoXHtbXn1dKlx9fFteLF0qKSwoW14sXSopKD86LChbXixdKikpP1wp
LzsKdmFyIGJpbmRSRSA9IC9eOnxedi1iaW5kOi87CnZhciBvblJFID0gL15AfF52LW9uOi87CnZh
ciBhcmdSRSA9IC86KC4qKSQvOwp2YXIgbW9kaWZpZXJSRSA9IC9cLlteLl0rL2c7Cgp2YXIgZGVj
b2RlSFRNTENhY2hlZCA9IGNhY2hlZChkZWNvZGUpOwoKLy8gY29uZmlndXJhYmxlIHN0YXRlCnZh
ciB3YXJuJDE7CnZhciBwbGF0Zm9ybUdldFRhZ05hbWVzcGFjZTsKdmFyIHBsYXRmb3JtTXVzdFVz
ZVByb3A7CnZhciBwbGF0Zm9ybUlzUHJlVGFnOwp2YXIgcHJlVHJhbnNmb3JtczsKdmFyIHRyYW5z
Zm9ybXM7CnZhciBwb3N0VHJhbnNmb3JtczsKdmFyIGRlbGltaXRlcnM7CgovKioKICogQ29udmVy
dCBIVE1MIHN0cmluZyB0byBBU1QuCiAqLwpmdW5jdGlvbiBwYXJzZSAoCiAgdGVtcGxhdGUsCiAg
b3B0aW9ucwopIHsKICB3YXJuJDEgPSBvcHRpb25zLndhcm4gfHwgYmFzZVdhcm47CiAgcGxhdGZv
cm1HZXRUYWdOYW1lc3BhY2UgPSBvcHRpb25zLmdldFRhZ05hbWVzcGFjZSB8fCBubzsKICBwbGF0
Zm9ybU11c3RVc2VQcm9wID0gb3B0aW9ucy5tdXN0VXNlUHJvcCB8fCBubzsKICBwbGF0Zm9ybUlz
UHJlVGFnID0gb3B0aW9ucy5pc1ByZVRhZyB8fCBubzsKICBwcmVUcmFuc2Zvcm1zID0gcGx1Y2tN
b2R1bGVGdW5jdGlvbihvcHRpb25zLm1vZHVsZXMsICdwcmVUcmFuc2Zvcm1Ob2RlJyk7CiAgdHJh
bnNmb3JtcyA9IHBsdWNrTW9kdWxlRnVuY3Rpb24ob3B0aW9ucy5tb2R1bGVzLCAndHJhbnNmb3Jt
Tm9kZScpOwogIHBvc3RUcmFuc2Zvcm1zID0gcGx1Y2tNb2R1bGVGdW5jdGlvbihvcHRpb25zLm1v
ZHVsZXMsICdwb3N0VHJhbnNmb3JtTm9kZScpOwogIGRlbGltaXRlcnMgPSBvcHRpb25zLmRlbGlt
aXRlcnM7CiAgdmFyIHN0YWNrID0gW107CiAgdmFyIHByZXNlcnZlV2hpdGVzcGFjZSA9IG9wdGlv
bnMucHJlc2VydmVXaGl0ZXNwYWNlICE9PSBmYWxzZTsKICB2YXIgcm9vdDsKICB2YXIgY3VycmVu
dFBhcmVudDsKICB2YXIgaW5WUHJlID0gZmFsc2U7CiAgdmFyIGluUHJlID0gZmFsc2U7CiAgdmFy
IHdhcm5lZCA9IGZhbHNlOwogIHBhcnNlSFRNTCh0ZW1wbGF0ZSwgewogICAgZXhwZWN0SFRNTDog
b3B0aW9ucy5leHBlY3RIVE1MLAogICAgaXNVbmFyeVRhZzogb3B0aW9ucy5pc1VuYXJ5VGFnLAog
ICAgc2hvdWxkRGVjb2RlTmV3bGluZXM6IG9wdGlvbnMuc2hvdWxkRGVjb2RlTmV3bGluZXMsCiAg
ICBzdGFydDogZnVuY3Rpb24gc3RhcnQgKHRhZywgYXR0cnMsIHVuYXJ5KSB7CiAgICAgIC8vIGNo
ZWNrIG5hbWVzcGFjZS4KICAgICAgLy8gaW5oZXJpdCBwYXJlbnQgbnMgaWYgdGhlcmUgaXMgb25l
CiAgICAgIHZhciBucyA9IChjdXJyZW50UGFyZW50ICYmIGN1cnJlbnRQYXJlbnQubnMpIHx8IHBs
YXRmb3JtR2V0VGFnTmFtZXNwYWNlKHRhZyk7CgogICAgICAvLyBoYW5kbGUgSUUgc3ZnIGJ1Zwog
ICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICAgICAgaWYgKGlzSUUgJiYgbnMgPT09ICdz
dmcnKSB7CiAgICAgICAgYXR0cnMgPSBndWFyZElFU1ZHQnVnKGF0dHJzKTsKICAgICAgfQoKICAg
ICAgdmFyIGVsZW1lbnQgPSB7CiAgICAgICAgdHlwZTogMSwKICAgICAgICB0YWc6IHRhZywKICAg
ICAgICBhdHRyc0xpc3Q6IGF0dHJzLAogICAgICAgIGF0dHJzTWFwOiBtYWtlQXR0cnNNYXAoYXR0
cnMpLAogICAgICAgIHBhcmVudDogY3VycmVudFBhcmVudCwKICAgICAgICBjaGlsZHJlbjogW10K
ICAgICAgfTsKICAgICAgaWYgKG5zKSB7CiAgICAgICAgZWxlbWVudC5ucyA9IG5zOwogICAgICB9
CgogICAgICBpZiAoaXNGb3JiaWRkZW5UYWcoZWxlbWVudCkgJiYgIWlzU2VydmVyUmVuZGVyaW5n
KCkpIHsKICAgICAgICBlbGVtZW50LmZvcmJpZGRlbiA9IHRydWU7CiAgICAgICAgImRldmVsb3Bt
ZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4kMSgKICAgICAgICAgICdUZW1wbGF0ZXMgc2hv
dWxkIG9ubHkgYmUgcmVzcG9uc2libGUgZm9yIG1hcHBpbmcgdGhlIHN0YXRlIHRvIHRoZSAnICsK
ICAgICAgICAgICdVSS4gQXZvaWQgcGxhY2luZyB0YWdzIHdpdGggc2lkZS1lZmZlY3RzIGluIHlv
dXIgdGVtcGxhdGVzLCBzdWNoIGFzICcgKwogICAgICAgICAgIjwiICsgdGFnICsgIj4uIgogICAg
ICAgICk7CiAgICAgIH0KCiAgICAgIC8vIGFwcGx5IHByZS10cmFuc2Zvcm1zCiAgICAgIGZvciAo
dmFyIGkgPSAwOyBpIDwgcHJlVHJhbnNmb3Jtcy5sZW5ndGg7IGkrKykgewogICAgICAgIHByZVRy
YW5zZm9ybXNbaV0oZWxlbWVudCwgb3B0aW9ucyk7CiAgICAgIH0KCiAgICAgIGlmICghaW5WUHJl
KSB7CiAgICAgICAgcHJvY2Vzc1ByZShlbGVtZW50KTsKICAgICAgICBpZiAoZWxlbWVudC5wcmUp
IHsKICAgICAgICAgIGluVlByZSA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChw
bGF0Zm9ybUlzUHJlVGFnKGVsZW1lbnQudGFnKSkgewogICAgICAgIGluUHJlID0gdHJ1ZTsKICAg
ICAgfQogICAgICBpZiAoaW5WUHJlKSB7CiAgICAgICAgcHJvY2Vzc1Jhd0F0dHJzKGVsZW1lbnQp
OwogICAgICB9IGVsc2UgewogICAgICAgIHByb2Nlc3NGb3IoZWxlbWVudCk7CiAgICAgICAgcHJv
Y2Vzc0lmKGVsZW1lbnQpOwogICAgICAgIHByb2Nlc3NPbmNlKGVsZW1lbnQpOwogICAgICAgIHBy
b2Nlc3NLZXkoZWxlbWVudCk7CgogICAgICAgIC8vIGRldGVybWluZSB3aGV0aGVyIHRoaXMgaXMg
YSBwbGFpbiBlbGVtZW50IGFmdGVyCiAgICAgICAgLy8gcmVtb3Zpbmcgc3RydWN0dXJhbCBhdHRy
aWJ1dGVzCiAgICAgICAgZWxlbWVudC5wbGFpbiA9ICFlbGVtZW50LmtleSAmJiAhYXR0cnMubGVu
Z3RoOwoKICAgICAgICBwcm9jZXNzUmVmKGVsZW1lbnQpOwogICAgICAgIHByb2Nlc3NTbG90KGVs
ZW1lbnQpOwogICAgICAgIHByb2Nlc3NDb21wb25lbnQoZWxlbWVudCk7CiAgICAgICAgZm9yICh2
YXIgaSQxID0gMDsgaSQxIDwgdHJhbnNmb3Jtcy5sZW5ndGg7IGkkMSsrKSB7CiAgICAgICAgICB0
cmFuc2Zvcm1zW2kkMV0oZWxlbWVudCwgb3B0aW9ucyk7CiAgICAgICAgfQogICAgICAgIHByb2Nl
c3NBdHRycyhlbGVtZW50KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gY2hlY2tSb290Q29uc3Ry
YWludHMgKGVsKSB7CiAgICAgICAgaWYgKCJkZXZlbG9wbWVudCIgIT09ICdwcm9kdWN0aW9uJyAm
JiAhd2FybmVkKSB7CiAgICAgICAgICBpZiAoZWwudGFnID09PSAnc2xvdCcgfHwgZWwudGFnID09
PSAndGVtcGxhdGUnKSB7CiAgICAgICAgICAgIHdhcm5lZCA9IHRydWU7CiAgICAgICAgICAgIHdh
cm4kMSgKICAgICAgICAgICAgICAiQ2Fubm90IHVzZSA8IiArIChlbC50YWcpICsgIj4gYXMgY29t
cG9uZW50IHJvb3QgZWxlbWVudCBiZWNhdXNlIGl0IG1heSAiICsKICAgICAgICAgICAgICAnY29u
dGFpbiBtdWx0aXBsZSBub2RlczpcbicgKyB0ZW1wbGF0ZQogICAgICAgICAgICApOwogICAgICAg
ICAgfQogICAgICAgICAgaWYgKGVsLmF0dHJzTWFwLmhhc093blByb3BlcnR5KCd2LWZvcicpKSB7
CiAgICAgICAgICAgIHdhcm5lZCA9IHRydWU7CiAgICAgICAgICAgIHdhcm4kMSgKICAgICAgICAg
ICAgICAnQ2Fubm90IHVzZSB2LWZvciBvbiBzdGF0ZWZ1bCBjb21wb25lbnQgcm9vdCBlbGVtZW50
IGJlY2F1c2UgJyArCiAgICAgICAgICAgICAgJ2l0IHJlbmRlcnMgbXVsdGlwbGUgZWxlbWVudHM6
XG4nICsgdGVtcGxhdGUKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAg
IH0KCiAgICAgIC8vIHRyZWUgbWFuYWdlbWVudAogICAgICBpZiAoIXJvb3QpIHsKICAgICAgICBy
b290ID0gZWxlbWVudDsKICAgICAgICBjaGVja1Jvb3RDb25zdHJhaW50cyhyb290KTsKICAgICAg
fSBlbHNlIGlmICghc3RhY2subGVuZ3RoKSB7CiAgICAgICAgLy8gYWxsb3cgcm9vdCBlbGVtZW50
cyB3aXRoIHYtaWYsIHYtZWxzZS1pZiBhbmQgdi1lbHNlCiAgICAgICAgaWYgKHJvb3QuaWYgJiYg
KGVsZW1lbnQuZWxzZWlmIHx8IGVsZW1lbnQuZWxzZSkpIHsKICAgICAgICAgIGNoZWNrUm9vdENv
bnN0cmFpbnRzKGVsZW1lbnQpOwogICAgICAgICAgYWRkSWZDb25kaXRpb24ocm9vdCwgewogICAg
ICAgICAgICBleHA6IGVsZW1lbnQuZWxzZWlmLAogICAgICAgICAgICBibG9jazogZWxlbWVudAog
ICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmICgiZGV2ZWxvcG1lbnQiICE9PSAncHJvZHVj
dGlvbicgJiYgIXdhcm5lZCkgewogICAgICAgICAgd2FybmVkID0gdHJ1ZTsKICAgICAgICAgIHdh
cm4kMSgKICAgICAgICAgICAgIkNvbXBvbmVudCB0ZW1wbGF0ZSBzaG91bGQgY29udGFpbiBleGFj
dGx5IG9uZSByb290IGVsZW1lbnQ6IiArCiAgICAgICAgICAgICJcblxuIiArIHRlbXBsYXRlICsg
IlxuXG4iICsKICAgICAgICAgICAgIklmIHlvdSBhcmUgdXNpbmcgdi1pZiBvbiBtdWx0aXBsZSBl
bGVtZW50cywgIiArCiAgICAgICAgICAgICJ1c2Ugdi1lbHNlLWlmIHRvIGNoYWluIHRoZW0gaW5z
dGVhZC4iCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoY3VycmVudFBh
cmVudCAmJiAhZWxlbWVudC5mb3JiaWRkZW4pIHsKICAgICAgICBpZiAoZWxlbWVudC5lbHNlaWYg
fHwgZWxlbWVudC5lbHNlKSB7CiAgICAgICAgICBwcm9jZXNzSWZDb25kaXRpb25zKGVsZW1lbnQs
IGN1cnJlbnRQYXJlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5zbG90U2NvcGUpIHsg
Ly8gc2NvcGVkIHNsb3QKICAgICAgICAgIGN1cnJlbnRQYXJlbnQucGxhaW4gPSBmYWxzZTsKICAg
ICAgICAgIHZhciBuYW1lID0gZWxlbWVudC5zbG90VGFyZ2V0IHx8ICdkZWZhdWx0JzsoY3VycmVu
dFBhcmVudC5zY29wZWRTbG90cyB8fCAoY3VycmVudFBhcmVudC5zY29wZWRTbG90cyA9IHt9KSlb
bmFtZV0gPSBlbGVtZW50OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJyZW50UGFyZW50
LmNoaWxkcmVuLnB1c2goZWxlbWVudCk7CiAgICAgICAgICBlbGVtZW50LnBhcmVudCA9IGN1cnJl
bnRQYXJlbnQ7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghdW5hcnkpIHsKICAgICAgICBj
dXJyZW50UGFyZW50ID0gZWxlbWVudDsKICAgICAgICBzdGFjay5wdXNoKGVsZW1lbnQpOwogICAg
ICB9CiAgICAgIC8vIGFwcGx5IHBvc3QtdHJhbnNmb3JtcwogICAgICBmb3IgKHZhciBpJDIgPSAw
OyBpJDIgPCBwb3N0VHJhbnNmb3Jtcy5sZW5ndGg7IGkkMisrKSB7CiAgICAgICAgcG9zdFRyYW5z
Zm9ybXNbaSQyXShlbGVtZW50LCBvcHRpb25zKTsKICAgICAgfQogICAgfSwKCiAgICBlbmQ6IGZ1
bmN0aW9uIGVuZCAoKSB7CiAgICAgIC8vIHJlbW92ZSB0cmFpbGluZyB3aGl0ZXNwYWNlCiAgICAg
IHZhciBlbGVtZW50ID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMV07CiAgICAgIHZhciBsYXN0Tm9k
ZSA9IGVsZW1lbnQuY2hpbGRyZW5bZWxlbWVudC5jaGlsZHJlbi5sZW5ndGggLSAxXTsKICAgICAg
aWYgKGxhc3ROb2RlICYmIGxhc3ROb2RlLnR5cGUgPT09IDMgJiYgbGFzdE5vZGUudGV4dCA9PT0g
JyAnKSB7CiAgICAgICAgZWxlbWVudC5jaGlsZHJlbi5wb3AoKTsKICAgICAgfQogICAgICAvLyBw
b3Agc3RhY2sKICAgICAgc3RhY2subGVuZ3RoIC09IDE7CiAgICAgIGN1cnJlbnRQYXJlbnQgPSBz
dGFja1tzdGFjay5sZW5ndGggLSAxXTsKICAgICAgLy8gY2hlY2sgcHJlIHN0YXRlCiAgICAgIGlm
IChlbGVtZW50LnByZSkgewogICAgICAgIGluVlByZSA9IGZhbHNlOwogICAgICB9CiAgICAgIGlm
IChwbGF0Zm9ybUlzUHJlVGFnKGVsZW1lbnQudGFnKSkgewogICAgICAgIGluUHJlID0gZmFsc2U7
CiAgICAgIH0KICAgIH0sCgogICAgY2hhcnM6IGZ1bmN0aW9uIGNoYXJzICh0ZXh0KSB7CiAgICAg
IGlmICghY3VycmVudFBhcmVudCkgewogICAgICAgIGlmICgiZGV2ZWxvcG1lbnQiICE9PSAncHJv
ZHVjdGlvbicgJiYgIXdhcm5lZCAmJiB0ZXh0ID09PSB0ZW1wbGF0ZSkgewogICAgICAgICAgd2Fy
bmVkID0gdHJ1ZTsKICAgICAgICAgIHdhcm4kMSgKICAgICAgICAgICAgJ0NvbXBvbmVudCB0ZW1w
bGF0ZSByZXF1aXJlcyBhIHJvb3QgZWxlbWVudCwgcmF0aGVyIHRoYW4ganVzdCB0ZXh0OlxuXG4n
ICsgdGVtcGxhdGUKICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgICB9
CiAgICAgIC8vIElFIHRleHRhcmVhIHBsYWNlaG9sZGVyIGJ1ZwogICAgICAvKiBpc3RhbmJ1bCBp
Z25vcmUgaWYgKi8KICAgICAgaWYgKGlzSUUgJiYKICAgICAgICAgIGN1cnJlbnRQYXJlbnQudGFn
ID09PSAndGV4dGFyZWEnICYmCiAgICAgICAgICBjdXJyZW50UGFyZW50LmF0dHJzTWFwLnBsYWNl
aG9sZGVyID09PSB0ZXh0KSB7CiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgdGV4dCA9IGlu
UHJlIHx8IHRleHQudHJpbSgpCiAgICAgICAgPyBkZWNvZGVIVE1MQ2FjaGVkKHRleHQpCiAgICAg
ICAgLy8gb25seSBwcmVzZXJ2ZSB3aGl0ZXNwYWNlIGlmIGl0cyBub3QgcmlnaHQgYWZ0ZXIgYSBz
dGFydGluZyB0YWcKICAgICAgICA6IHByZXNlcnZlV2hpdGVzcGFjZSAmJiBjdXJyZW50UGFyZW50
LmNoaWxkcmVuLmxlbmd0aCA/ICcgJyA6ICcnOwogICAgICBpZiAodGV4dCkgewogICAgICAgIHZh
ciBleHByZXNzaW9uOwogICAgICAgIGlmICghaW5WUHJlICYmIHRleHQgIT09ICcgJyAmJiAoZXhw
cmVzc2lvbiA9IHBhcnNlVGV4dCh0ZXh0LCBkZWxpbWl0ZXJzKSkpIHsKICAgICAgICAgIGN1cnJl
bnRQYXJlbnQuY2hpbGRyZW4ucHVzaCh7CiAgICAgICAgICAgIHR5cGU6IDIsCiAgICAgICAgICAg
IGV4cHJlc3Npb246IGV4cHJlc3Npb24sCiAgICAgICAgICAgIHRleHQ6IHRleHQKICAgICAgICAg
IH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJyZW50UGFyZW50LmNoaWxkcmVuLnB1
c2goewogICAgICAgICAgICB0eXBlOiAzLAogICAgICAgICAgICB0ZXh0OiB0ZXh0CiAgICAgICAg
ICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KTsKICByZXR1cm4gcm9vdAp9CgpmdW5j
dGlvbiBwcm9jZXNzUHJlIChlbCkgewogIGlmIChnZXRBbmRSZW1vdmVBdHRyKGVsLCAndi1wcmUn
KSAhPSBudWxsKSB7CiAgICBlbC5wcmUgPSB0cnVlOwogIH0KfQoKZnVuY3Rpb24gcHJvY2Vzc1Jh
d0F0dHJzIChlbCkgewogIHZhciBsID0gZWwuYXR0cnNMaXN0Lmxlbmd0aDsKICBpZiAobCkgewog
ICAgdmFyIGF0dHJzID0gZWwuYXR0cnMgPSBuZXcgQXJyYXkobCk7CiAgICBmb3IgKHZhciBpID0g
MDsgaSA8IGw7IGkrKykgewogICAgICBhdHRyc1tpXSA9IHsKICAgICAgICBuYW1lOiBlbC5hdHRy
c0xpc3RbaV0ubmFtZSwKICAgICAgICB2YWx1ZTogSlNPTi5zdHJpbmdpZnkoZWwuYXR0cnNMaXN0
W2ldLnZhbHVlKQogICAgICB9OwogICAgfQogIH0gZWxzZSBpZiAoIWVsLnByZSkgewogICAgLy8g
bm9uIHJvb3Qgbm9kZSBpbiBwcmUgYmxvY2tzIHdpdGggbm8gYXR0cmlidXRlcwogICAgZWwucGxh
aW4gPSB0cnVlOwogIH0KfQoKZnVuY3Rpb24gcHJvY2Vzc0tleSAoZWwpIHsKICB2YXIgZXhwID0g
Z2V0QmluZGluZ0F0dHIoZWwsICdrZXknKTsKICBpZiAoZXhwKSB7CiAgICBpZiAoImRldmVsb3Bt
ZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIGVsLnRhZyA9PT0gJ3RlbXBsYXRlJykgewogICAgICB3
YXJuJDEoIjx0ZW1wbGF0ZT4gY2Fubm90IGJlIGtleWVkLiBQbGFjZSB0aGUga2V5IG9uIHJlYWwg
ZWxlbWVudHMgaW5zdGVhZC4iKTsKICAgIH0KICAgIGVsLmtleSA9IGV4cDsKICB9Cn0KCmZ1bmN0
aW9uIHByb2Nlc3NSZWYgKGVsKSB7CiAgdmFyIHJlZiA9IGdldEJpbmRpbmdBdHRyKGVsLCAncmVm
Jyk7CiAgaWYgKHJlZikgewogICAgZWwucmVmID0gcmVmOwogICAgZWwucmVmSW5Gb3IgPSBjaGVj
a0luRm9yKGVsKTsKICB9Cn0KCmZ1bmN0aW9uIHByb2Nlc3NGb3IgKGVsKSB7CiAgdmFyIGV4cDsK
ICBpZiAoKGV4cCA9IGdldEFuZFJlbW92ZUF0dHIoZWwsICd2LWZvcicpKSkgewogICAgdmFyIGlu
TWF0Y2ggPSBleHAubWF0Y2goZm9yQWxpYXNSRSk7CiAgICBpZiAoIWluTWF0Y2gpIHsKICAgICAg
ImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4kMSgKICAgICAgICAoIkludmFs
aWQgdi1mb3IgZXhwcmVzc2lvbjogIiArIGV4cCkKICAgICAgKTsKICAgICAgcmV0dXJuCiAgICB9
CiAgICBlbC5mb3IgPSBpbk1hdGNoWzJdLnRyaW0oKTsKICAgIHZhciBhbGlhcyA9IGluTWF0Y2hb
MV0udHJpbSgpOwogICAgdmFyIGl0ZXJhdG9yTWF0Y2ggPSBhbGlhcy5tYXRjaChmb3JJdGVyYXRv
clJFKTsKICAgIGlmIChpdGVyYXRvck1hdGNoKSB7CiAgICAgIGVsLmFsaWFzID0gaXRlcmF0b3JN
YXRjaFsxXS50cmltKCk7CiAgICAgIGVsLml0ZXJhdG9yMSA9IGl0ZXJhdG9yTWF0Y2hbMl0udHJp
bSgpOwogICAgICBpZiAoaXRlcmF0b3JNYXRjaFszXSkgewogICAgICAgIGVsLml0ZXJhdG9yMiA9
IGl0ZXJhdG9yTWF0Y2hbM10udHJpbSgpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBlbC5h
bGlhcyA9IGFsaWFzOwogICAgfQogIH0KfQoKZnVuY3Rpb24gcHJvY2Vzc0lmIChlbCkgewogIHZh
ciBleHAgPSBnZXRBbmRSZW1vdmVBdHRyKGVsLCAndi1pZicpOwogIGlmIChleHApIHsKICAgIGVs
LmlmID0gZXhwOwogICAgYWRkSWZDb25kaXRpb24oZWwsIHsKICAgICAgZXhwOiBleHAsCiAgICAg
IGJsb2NrOiBlbAogICAgfSk7CiAgfSBlbHNlIHsKICAgIGlmIChnZXRBbmRSZW1vdmVBdHRyKGVs
LCAndi1lbHNlJykgIT0gbnVsbCkgewogICAgICBlbC5lbHNlID0gdHJ1ZTsKICAgIH0KICAgIHZh
ciBlbHNlaWYgPSBnZXRBbmRSZW1vdmVBdHRyKGVsLCAndi1lbHNlLWlmJyk7CiAgICBpZiAoZWxz
ZWlmKSB7CiAgICAgIGVsLmVsc2VpZiA9IGVsc2VpZjsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHBy
b2Nlc3NJZkNvbmRpdGlvbnMgKGVsLCBwYXJlbnQpIHsKICB2YXIgcHJldiA9IGZpbmRQcmV2RWxl
bWVudChwYXJlbnQuY2hpbGRyZW4pOwogIGlmIChwcmV2ICYmIHByZXYuaWYpIHsKICAgIGFkZElm
Q29uZGl0aW9uKHByZXYsIHsKICAgICAgZXhwOiBlbC5lbHNlaWYsCiAgICAgIGJsb2NrOiBlbAog
ICAgfSk7CiAgfSBlbHNlIHsKICAgIHdhcm4kMSgKICAgICAgInYtIiArIChlbC5lbHNlaWYgPyAo
J2Vsc2UtaWY9IicgKyBlbC5lbHNlaWYgKyAnIicpIDogJ2Vsc2UnKSArICIgIiArCiAgICAgICJ1
c2VkIG9uIGVsZW1lbnQgPCIgKyAoZWwudGFnKSArICI+IHdpdGhvdXQgY29ycmVzcG9uZGluZyB2
LWlmLiIKICAgICk7CiAgfQp9CgpmdW5jdGlvbiBhZGRJZkNvbmRpdGlvbiAoZWwsIGNvbmRpdGlv
bikgewogIGlmICghZWwuaWZDb25kaXRpb25zKSB7CiAgICBlbC5pZkNvbmRpdGlvbnMgPSBbXTsK
ICB9CiAgZWwuaWZDb25kaXRpb25zLnB1c2goY29uZGl0aW9uKTsKfQoKZnVuY3Rpb24gcHJvY2Vz
c09uY2UgKGVsKSB7CiAgdmFyIG9uY2UgPSBnZXRBbmRSZW1vdmVBdHRyKGVsLCAndi1vbmNlJyk7
CiAgaWYgKG9uY2UgIT0gbnVsbCkgewogICAgZWwub25jZSA9IHRydWU7CiAgfQp9CgpmdW5jdGlv
biBwcm9jZXNzU2xvdCAoZWwpIHsKICBpZiAoZWwudGFnID09PSAnc2xvdCcpIHsKICAgIGVsLnNs
b3ROYW1lID0gZ2V0QmluZGluZ0F0dHIoZWwsICduYW1lJyk7CiAgICBpZiAoImRldmVsb3BtZW50
IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIGVsLmtleSkgewogICAgICB3YXJuJDEoCiAgICAgICAgImBr
ZXlgIGRvZXMgbm90IHdvcmsgb24gPHNsb3Q+IGJlY2F1c2Ugc2xvdHMgYXJlIGFic3RyYWN0IG91
dGxldHMgIiArCiAgICAgICAgImFuZCBjYW4gcG9zc2libHkgZXhwYW5kIGludG8gbXVsdGlwbGUg
ZWxlbWVudHMuICIgKwogICAgICAgICJVc2UgdGhlIGtleSBvbiBhIHdyYXBwaW5nIGVsZW1lbnQg
aW5zdGVhZC4iCiAgICAgICk7CiAgICB9CiAgfSBlbHNlIHsKICAgIHZhciBzbG90VGFyZ2V0ID0g
Z2V0QmluZGluZ0F0dHIoZWwsICdzbG90Jyk7CiAgICBpZiAoc2xvdFRhcmdldCkgewogICAgICBl
bC5zbG90VGFyZ2V0ID0gc2xvdFRhcmdldCA9PT0gJyIiJyA/ICciZGVmYXVsdCInIDogc2xvdFRh
cmdldDsKICAgIH0KICAgIGlmIChlbC50YWcgPT09ICd0ZW1wbGF0ZScpIHsKICAgICAgZWwuc2xv
dFNjb3BlID0gZ2V0QW5kUmVtb3ZlQXR0cihlbCwgJ3Njb3BlJyk7CiAgICB9CiAgfQp9CgpmdW5j
dGlvbiBwcm9jZXNzQ29tcG9uZW50IChlbCkgewogIHZhciBiaW5kaW5nOwogIGlmICgoYmluZGlu
ZyA9IGdldEJpbmRpbmdBdHRyKGVsLCAnaXMnKSkpIHsKICAgIGVsLmNvbXBvbmVudCA9IGJpbmRp
bmc7CiAgfQogIGlmIChnZXRBbmRSZW1vdmVBdHRyKGVsLCAnaW5saW5lLXRlbXBsYXRlJykgIT0g
bnVsbCkgewogICAgZWwuaW5saW5lVGVtcGxhdGUgPSB0cnVlOwogIH0KfQoKZnVuY3Rpb24gcHJv
Y2Vzc0F0dHJzIChlbCkgewogIHZhciBsaXN0ID0gZWwuYXR0cnNMaXN0OwogIHZhciBpLCBsLCBu
YW1lLCByYXdOYW1lLCB2YWx1ZSwgYXJnLCBtb2RpZmllcnMsIGlzUHJvcDsKICBmb3IgKGkgPSAw
LCBsID0gbGlzdC5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIG5hbWUgPSByYXdOYW1lID0gbGlz
dFtpXS5uYW1lOwogICAgdmFsdWUgPSBsaXN0W2ldLnZhbHVlOwogICAgaWYgKGRpclJFLnRlc3Qo
bmFtZSkpIHsKICAgICAgLy8gbWFyayBlbGVtZW50IGFzIGR5bmFtaWMKICAgICAgZWwuaGFzQmlu
ZGluZ3MgPSB0cnVlOwogICAgICAvLyBtb2RpZmllcnMKICAgICAgbW9kaWZpZXJzID0gcGFyc2VN
b2RpZmllcnMobmFtZSk7CiAgICAgIGlmIChtb2RpZmllcnMpIHsKICAgICAgICBuYW1lID0gbmFt
ZS5yZXBsYWNlKG1vZGlmaWVyUkUsICcnKTsKICAgICAgfQogICAgICBpZiAoYmluZFJFLnRlc3Qo
bmFtZSkpIHsgLy8gdi1iaW5kCiAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZShiaW5kUkUsICcn
KTsKICAgICAgICB2YWx1ZSA9IHBhcnNlRmlsdGVycyh2YWx1ZSk7CiAgICAgICAgaXNQcm9wID0g
ZmFsc2U7CiAgICAgICAgaWYgKG1vZGlmaWVycykgewogICAgICAgICAgaWYgKG1vZGlmaWVycy5w
cm9wKSB7CiAgICAgICAgICAgIGlzUHJvcCA9IHRydWU7CiAgICAgICAgICAgIG5hbWUgPSBjYW1l
bGl6ZShuYW1lKTsKICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdpbm5lckh0bWwnKSB7IG5hbWUg
PSAnaW5uZXJIVE1MJzsgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKG1vZGlmaWVycy5jYW1l
bCkgewogICAgICAgICAgICBuYW1lID0gY2FtZWxpemUobmFtZSk7CiAgICAgICAgICB9CiAgICAg
ICAgfQogICAgICAgIGlmIChpc1Byb3AgfHwgcGxhdGZvcm1NdXN0VXNlUHJvcChlbC50YWcsIG5h
bWUpKSB7CiAgICAgICAgICBhZGRQcm9wKGVsLCBuYW1lLCB2YWx1ZSk7CiAgICAgICAgfSBlbHNl
IHsKICAgICAgICAgIGFkZEF0dHIoZWwsIG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0g
ZWxzZSBpZiAob25SRS50ZXN0KG5hbWUpKSB7IC8vIHYtb24KICAgICAgICBuYW1lID0gbmFtZS5y
ZXBsYWNlKG9uUkUsICcnKTsKICAgICAgICBhZGRIYW5kbGVyKGVsLCBuYW1lLCB2YWx1ZSwgbW9k
aWZpZXJzKTsKICAgICAgfSBlbHNlIHsgLy8gbm9ybWFsIGRpcmVjdGl2ZXMKICAgICAgICBuYW1l
ID0gbmFtZS5yZXBsYWNlKGRpclJFLCAnJyk7CiAgICAgICAgLy8gcGFyc2UgYXJnCiAgICAgICAg
dmFyIGFyZ01hdGNoID0gbmFtZS5tYXRjaChhcmdSRSk7CiAgICAgICAgaWYgKGFyZ01hdGNoICYm
IChhcmcgPSBhcmdNYXRjaFsxXSkpIHsKICAgICAgICAgIG5hbWUgPSBuYW1lLnNsaWNlKDAsIC0o
YXJnLmxlbmd0aCArIDEpKTsKICAgICAgICB9CiAgICAgICAgYWRkRGlyZWN0aXZlKGVsLCBuYW1l
LCByYXdOYW1lLCB2YWx1ZSwgYXJnLCBtb2RpZmllcnMpOwogICAgICAgIGlmICgiZGV2ZWxvcG1l
bnQiICE9PSAncHJvZHVjdGlvbicgJiYgbmFtZSA9PT0gJ21vZGVsJykgewogICAgICAgICAgY2hl
Y2tGb3JBbGlhc01vZGVsKGVsLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2Ug
ewogICAgICAvLyBsaXRlcmFsIGF0dHJpYnV0ZQogICAgICB7CiAgICAgICAgdmFyIGV4cHJlc3Np
b24gPSBwYXJzZVRleHQodmFsdWUsIGRlbGltaXRlcnMpOwogICAgICAgIGlmIChleHByZXNzaW9u
KSB7CiAgICAgICAgICB3YXJuJDEoCiAgICAgICAgICAgIG5hbWUgKyAiPVwiIiArIHZhbHVlICsg
IlwiOiAiICsKICAgICAgICAgICAgJ0ludGVycG9sYXRpb24gaW5zaWRlIGF0dHJpYnV0ZXMgaGFz
IGJlZW4gcmVtb3ZlZC4gJyArCiAgICAgICAgICAgICdVc2Ugdi1iaW5kIG9yIHRoZSBjb2xvbiBz
aG9ydGhhbmQgaW5zdGVhZC4gRm9yIGV4YW1wbGUsICcgKwogICAgICAgICAgICAnaW5zdGVhZCBv
ZiA8ZGl2IGlkPSJ7eyB2YWwgfX0iPiwgdXNlIDxkaXYgOmlkPSJ2YWwiPi4nCiAgICAgICAgICAp
OwogICAgICAgIH0KICAgICAgfQogICAgICBhZGRBdHRyKGVsLCBuYW1lLCBKU09OLnN0cmluZ2lm
eSh2YWx1ZSkpOwogICAgfQogIH0KfQoKZnVuY3Rpb24gY2hlY2tJbkZvciAoZWwpIHsKICB2YXIg
cGFyZW50ID0gZWw7CiAgd2hpbGUgKHBhcmVudCkgewogICAgaWYgKHBhcmVudC5mb3IgIT09IHVu
ZGVmaW5lZCkgewogICAgICByZXR1cm4gdHJ1ZQogICAgfQogICAgcGFyZW50ID0gcGFyZW50LnBh
cmVudDsKICB9CiAgcmV0dXJuIGZhbHNlCn0KCmZ1bmN0aW9uIHBhcnNlTW9kaWZpZXJzIChuYW1l
KSB7CiAgdmFyIG1hdGNoID0gbmFtZS5tYXRjaChtb2RpZmllclJFKTsKICBpZiAobWF0Y2gpIHsK
ICAgIHZhciByZXQgPSB7fTsKICAgIG1hdGNoLmZvckVhY2goZnVuY3Rpb24gKG0pIHsgcmV0W20u
c2xpY2UoMSldID0gdHJ1ZTsgfSk7CiAgICByZXR1cm4gcmV0CiAgfQp9CgpmdW5jdGlvbiBtYWtl
QXR0cnNNYXAgKGF0dHJzKSB7CiAgdmFyIG1hcCA9IHt9OwogIGZvciAodmFyIGkgPSAwLCBsID0g
YXR0cnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICBpZiAoImRldmVsb3BtZW50IiAhPT0gJ3By
b2R1Y3Rpb24nICYmIG1hcFthdHRyc1tpXS5uYW1lXSAmJiAhaXNJRSkgewogICAgICB3YXJuJDEo
J2R1cGxpY2F0ZSBhdHRyaWJ1dGU6ICcgKyBhdHRyc1tpXS5uYW1lKTsKICAgIH0KICAgIG1hcFth
dHRyc1tpXS5uYW1lXSA9IGF0dHJzW2ldLnZhbHVlOwogIH0KICByZXR1cm4gbWFwCn0KCmZ1bmN0
aW9uIGZpbmRQcmV2RWxlbWVudCAoY2hpbGRyZW4pIHsKICB2YXIgaSA9IGNoaWxkcmVuLmxlbmd0
aDsKICB3aGlsZSAoaS0tKSB7CiAgICBpZiAoY2hpbGRyZW5baV0udGFnKSB7IHJldHVybiBjaGls
ZHJlbltpXSB9CiAgfQp9CgpmdW5jdGlvbiBpc0ZvcmJpZGRlblRhZyAoZWwpIHsKICByZXR1cm4g
KAogICAgZWwudGFnID09PSAnc3R5bGUnIHx8CiAgICAoZWwudGFnID09PSAnc2NyaXB0JyAmJiAo
CiAgICAgICFlbC5hdHRyc01hcC50eXBlIHx8CiAgICAgIGVsLmF0dHJzTWFwLnR5cGUgPT09ICd0
ZXh0L2phdmFzY3JpcHQnCiAgICApKQogICkKfQoKdmFyIGllTlNCdWcgPSAvXnhtbG5zOk5TXGQr
LzsKdmFyIGllTlNQcmVmaXggPSAvXk5TXGQrOi87CgovKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAq
LwpmdW5jdGlvbiBndWFyZElFU1ZHQnVnIChhdHRycykgewogIHZhciByZXMgPSBbXTsKICBmb3Ig
KHZhciBpID0gMDsgaSA8IGF0dHJzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgYXR0ciA9IGF0dHJz
W2ldOwogICAgaWYgKCFpZU5TQnVnLnRlc3QoYXR0ci5uYW1lKSkgewogICAgICBhdHRyLm5hbWUg
PSBhdHRyLm5hbWUucmVwbGFjZShpZU5TUHJlZml4LCAnJyk7CiAgICAgIHJlcy5wdXNoKGF0dHIp
OwogICAgfQogIH0KICByZXR1cm4gcmVzCn0KCmZ1bmN0aW9uIGNoZWNrRm9yQWxpYXNNb2RlbCAo
ZWwsIHZhbHVlKSB7CiAgdmFyIF9lbCA9IGVsOwogIHdoaWxlIChfZWwpIHsKICAgIGlmIChfZWwu
Zm9yICYmIF9lbC5hbGlhcyA9PT0gdmFsdWUpIHsKICAgICAgd2FybiQxKAogICAgICAgICI8IiAr
IChlbC50YWcpICsgIiB2LW1vZGVsPVwiIiArIHZhbHVlICsgIlwiPjogIiArCiAgICAgICAgIllv
dSBhcmUgYmluZGluZyB2LW1vZGVsIGRpcmVjdGx5IHRvIGEgdi1mb3IgaXRlcmF0aW9uIGFsaWFz
LiAiICsKICAgICAgICAiVGhpcyB3aWxsIG5vdCBiZSBhYmxlIHRvIG1vZGlmeSB0aGUgdi1mb3Ig
c291cmNlIGFycmF5IGJlY2F1c2UgIiArCiAgICAgICAgIndyaXRpbmcgdG8gdGhlIGFsaWFzIGlz
IGxpa2UgbW9kaWZ5aW5nIGEgZnVuY3Rpb24gbG9jYWwgdmFyaWFibGUuICIgKwogICAgICAgICJD
b25zaWRlciB1c2luZyBhbiBhcnJheSBvZiBvYmplY3RzIGFuZCB1c2Ugdi1tb2RlbCBvbiBhbiBv
YmplY3QgcHJvcGVydHkgaW5zdGVhZC4iCiAgICAgICk7CiAgICB9CiAgICBfZWwgPSBfZWwucGFy
ZW50OwogIH0KfQoKLyogICovCgp2YXIgaXNTdGF0aWNLZXk7CnZhciBpc1BsYXRmb3JtUmVzZXJ2
ZWRUYWc7Cgp2YXIgZ2VuU3RhdGljS2V5c0NhY2hlZCA9IGNhY2hlZChnZW5TdGF0aWNLZXlzJDEp
OwoKLyoqCiAqIEdvYWwgb2YgdGhlIG9wdGltaXplcjogd2FsayB0aGUgZ2VuZXJhdGVkIHRlbXBs
YXRlIEFTVCB0cmVlCiAqIGFuZCBkZXRlY3Qgc3ViLXRyZWVzIHRoYXQgYXJlIHB1cmVseSBzdGF0
aWMsIGkuZS4gcGFydHMgb2YKICogdGhlIERPTSB0aGF0IG5ldmVyIG5lZWRzIHRvIGNoYW5nZS4K
ICoKICogT25jZSB3ZSBkZXRlY3QgdGhlc2Ugc3ViLXRyZWVzLCB3ZSBjYW46CiAqCiAqIDEuIEhv
aXN0IHRoZW0gaW50byBjb25zdGFudHMsIHNvIHRoYXQgd2Ugbm8gbG9uZ2VyIG5lZWQgdG8KICog
ICAgY3JlYXRlIGZyZXNoIG5vZGVzIGZvciB0aGVtIG9uIGVhY2ggcmUtcmVuZGVyOwogKiAyLiBD
b21wbGV0ZWx5IHNraXAgdGhlbSBpbiB0aGUgcGF0Y2hpbmcgcHJvY2Vzcy4KICovCmZ1bmN0aW9u
IG9wdGltaXplIChyb290LCBvcHRpb25zKSB7CiAgaWYgKCFyb290KSB7IHJldHVybiB9CiAgaXNT
dGF0aWNLZXkgPSBnZW5TdGF0aWNLZXlzQ2FjaGVkKG9wdGlvbnMuc3RhdGljS2V5cyB8fCAnJyk7
CiAgaXNQbGF0Zm9ybVJlc2VydmVkVGFnID0gb3B0aW9ucy5pc1Jlc2VydmVkVGFnIHx8IG5vOwog
IC8vIGZpcnN0IHBhc3M6IG1hcmsgYWxsIG5vbi1zdGF0aWMgbm9kZXMuCiAgbWFya1N0YXRpYyhy
b290KTsKICAvLyBzZWNvbmQgcGFzczogbWFyayBzdGF0aWMgcm9vdHMuCiAgbWFya1N0YXRpY1Jv
b3RzKHJvb3QsIGZhbHNlKTsKfQoKZnVuY3Rpb24gZ2VuU3RhdGljS2V5cyQxIChrZXlzKSB7CiAg
cmV0dXJuIG1ha2VNYXAoCiAgICAndHlwZSx0YWcsYXR0cnNMaXN0LGF0dHJzTWFwLHBsYWluLHBh
cmVudCxjaGlsZHJlbixhdHRycycgKwogICAgKGtleXMgPyAnLCcgKyBrZXlzIDogJycpCiAgKQp9
CgpmdW5jdGlvbiBtYXJrU3RhdGljIChub2RlKSB7CiAgbm9kZS5zdGF0aWMgPSBpc1N0YXRpYyhu
b2RlKTsKICBpZiAobm9kZS50eXBlID09PSAxKSB7CiAgICAvLyBkbyBub3QgbWFrZSBjb21wb25l
bnQgc2xvdCBjb250ZW50IHN0YXRpYy4gdGhpcyBhdm9pZHMKICAgIC8vIDEuIGNvbXBvbmVudHMg
bm90IGFibGUgdG8gbXV0YXRlIHNsb3Qgbm9kZXMKICAgIC8vIDIuIHN0YXRpYyBzbG90IGNvbnRl
bnQgZmFpbHMgZm9yIGhvdC1yZWxvYWRpbmcKICAgIGlmICgKICAgICAgIWlzUGxhdGZvcm1SZXNl
cnZlZFRhZyhub2RlLnRhZykgJiYKICAgICAgbm9kZS50YWcgIT09ICdzbG90JyAmJgogICAgICBu
b2RlLmF0dHJzTWFwWydpbmxpbmUtdGVtcGxhdGUnXSA9PSBudWxsCiAgICApIHsKICAgICAgcmV0
dXJuCiAgICB9CiAgICBmb3IgKHZhciBpID0gMCwgbCA9IG5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBp
IDwgbDsgaSsrKSB7CiAgICAgIHZhciBjaGlsZCA9IG5vZGUuY2hpbGRyZW5baV07CiAgICAgIG1h
cmtTdGF0aWMoY2hpbGQpOwogICAgICBpZiAoIWNoaWxkLnN0YXRpYykgewogICAgICAgIG5vZGUu
c3RhdGljID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9Cn0KCmZ1bmN0aW9uIG1hcmtTdGF0aWNS
b290cyAobm9kZSwgaXNJbkZvcikgewogIGlmIChub2RlLnR5cGUgPT09IDEpIHsKICAgIGlmIChu
b2RlLnN0YXRpYyB8fCBub2RlLm9uY2UpIHsKICAgICAgbm9kZS5zdGF0aWNJbkZvciA9IGlzSW5G
b3I7CiAgICB9CiAgICAvLyBGb3IgYSBub2RlIHRvIHF1YWxpZnkgYXMgYSBzdGF0aWMgcm9vdCwg
aXQgc2hvdWxkIGhhdmUgY2hpbGRyZW4gdGhhdAogICAgLy8gYXJlIG5vdCBqdXN0IHN0YXRpYyB0
ZXh0LiBPdGhlcndpc2UgdGhlIGNvc3Qgb2YgaG9pc3Rpbmcgb3V0IHdpbGwKICAgIC8vIG91dHdl
aWdoIHRoZSBiZW5lZml0cyBhbmQgaXQncyBiZXR0ZXIgb2ZmIHRvIGp1c3QgYWx3YXlzIHJlbmRl
ciBpdCBmcmVzaC4KICAgIGlmIChub2RlLnN0YXRpYyAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCAm
JiAhKAogICAgICBub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSAmJgogICAgICBub2RlLmNoaWxk
cmVuWzBdLnR5cGUgPT09IDMKICAgICkpIHsKICAgICAgbm9kZS5zdGF0aWNSb290ID0gdHJ1ZTsK
ICAgICAgcmV0dXJuCiAgICB9IGVsc2UgewogICAgICBub2RlLnN0YXRpY1Jvb3QgPSBmYWxzZTsK
ICAgIH0KICAgIGlmIChub2RlLmNoaWxkcmVuKSB7CiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0g
bm9kZS5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBtYXJrU3RhdGljUm9v
dHMobm9kZS5jaGlsZHJlbltpXSwgaXNJbkZvciB8fCAhIW5vZGUuZm9yKTsKICAgICAgfQogICAg
fQogICAgaWYgKG5vZGUuaWZDb25kaXRpb25zKSB7CiAgICAgIHdhbGtUaHJvdWdoQ29uZGl0aW9u
c0Jsb2Nrcyhub2RlLmlmQ29uZGl0aW9ucywgaXNJbkZvcik7CiAgICB9CiAgfQp9CgpmdW5jdGlv
biB3YWxrVGhyb3VnaENvbmRpdGlvbnNCbG9ja3MgKGNvbmRpdGlvbkJsb2NrcywgaXNJbkZvcikg
ewogIGZvciAodmFyIGkgPSAxLCBsZW4gPSBjb25kaXRpb25CbG9ja3MubGVuZ3RoOyBpIDwgbGVu
OyBpKyspIHsKICAgIG1hcmtTdGF0aWNSb290cyhjb25kaXRpb25CbG9ja3NbaV0uYmxvY2ssIGlz
SW5Gb3IpOwogIH0KfQoKZnVuY3Rpb24gaXNTdGF0aWMgKG5vZGUpIHsKICBpZiAobm9kZS50eXBl
ID09PSAyKSB7IC8vIGV4cHJlc3Npb24KICAgIHJldHVybiBmYWxzZQogIH0KICBpZiAobm9kZS50
eXBlID09PSAzKSB7IC8vIHRleHQKICAgIHJldHVybiB0cnVlCiAgfQogIHJldHVybiAhIShub2Rl
LnByZSB8fCAoCiAgICAhbm9kZS5oYXNCaW5kaW5ncyAmJiAvLyBubyBkeW5hbWljIGJpbmRpbmdz
CiAgICAhbm9kZS5pZiAmJiAhbm9kZS5mb3IgJiYgLy8gbm90IHYtaWYgb3Igdi1mb3Igb3Igdi1l
bHNlCiAgICAhaXNCdWlsdEluVGFnKG5vZGUudGFnKSAmJiAvLyBub3QgYSBidWlsdC1pbgogICAg
aXNQbGF0Zm9ybVJlc2VydmVkVGFnKG5vZGUudGFnKSAmJiAvLyBub3QgYSBjb21wb25lbnQKICAg
ICFpc0RpcmVjdENoaWxkT2ZUZW1wbGF0ZUZvcihub2RlKSAmJgogICAgT2JqZWN0LmtleXMobm9k
ZSkuZXZlcnkoaXNTdGF0aWNLZXkpCiAgKSkKfQoKZnVuY3Rpb24gaXNEaXJlY3RDaGlsZE9mVGVt
cGxhdGVGb3IgKG5vZGUpIHsKICB3aGlsZSAobm9kZS5wYXJlbnQpIHsKICAgIG5vZGUgPSBub2Rl
LnBhcmVudDsKICAgIGlmIChub2RlLnRhZyAhPT0gJ3RlbXBsYXRlJykgewogICAgICByZXR1cm4g
ZmFsc2UKICAgIH0KICAgIGlmIChub2RlLmZvcikgewogICAgICByZXR1cm4gdHJ1ZQogICAgfQog
IH0KICByZXR1cm4gZmFsc2UKfQoKLyogICovCgp2YXIgZm5FeHBSRSA9IC9eXHMqKFtcdyRfXSt8
XChbXildKj9cKSlccyo9PnxeZnVuY3Rpb25ccypcKC87CnZhciBzaW1wbGVQYXRoUkUgPSAvXlxz
KltBLVphLXpfJF1bXHckXSooPzpcLltBLVphLXpfJF1bXHckXSp8XFsnLio/J118XFsiLio/Il18
XFtcZCtdfFxbW0EtWmEtel8kXVtcdyRdKl0pKlxzKiQvOwoKLy8ga2V5Q29kZSBhbGlhc2VzCnZh
ciBrZXlDb2RlcyA9IHsKICBlc2M6IDI3LAogIHRhYjogOSwKICBlbnRlcjogMTMsCiAgc3BhY2U6
IDMyLAogIHVwOiAzOCwKICBsZWZ0OiAzNywKICByaWdodDogMzksCiAgZG93bjogNDAsCiAgJ2Rl
bGV0ZSc6IFs4LCA0Nl0KfTsKCnZhciBtb2RpZmllckNvZGUgPSB7CiAgc3RvcDogJyRldmVudC5z
dG9wUHJvcGFnYXRpb24oKTsnLAogIHByZXZlbnQ6ICckZXZlbnQucHJldmVudERlZmF1bHQoKTsn
LAogIHNlbGY6ICdpZigkZXZlbnQudGFyZ2V0ICE9PSAkZXZlbnQuY3VycmVudFRhcmdldClyZXR1
cm47JywKICBjdHJsOiAnaWYoISRldmVudC5jdHJsS2V5KXJldHVybjsnLAogIHNoaWZ0OiAnaWYo
ISRldmVudC5zaGlmdEtleSlyZXR1cm47JywKICBhbHQ6ICdpZighJGV2ZW50LmFsdEtleSlyZXR1
cm47JywKICBtZXRhOiAnaWYoISRldmVudC5tZXRhS2V5KXJldHVybjsnCn07CgpmdW5jdGlvbiBn
ZW5IYW5kbGVycyAoZXZlbnRzLCBuYXRpdmUpIHsKICB2YXIgcmVzID0gbmF0aXZlID8gJ25hdGl2
ZU9uOnsnIDogJ29uOnsnOwogIGZvciAodmFyIG5hbWUgaW4gZXZlbnRzKSB7CiAgICByZXMgKz0g
IlwiIiArIG5hbWUgKyAiXCI6IiArIChnZW5IYW5kbGVyKG5hbWUsIGV2ZW50c1tuYW1lXSkpICsg
IiwiOwogIH0KICByZXR1cm4gcmVzLnNsaWNlKDAsIC0xKSArICd9Jwp9CgpmdW5jdGlvbiBnZW5I
YW5kbGVyICgKICBuYW1lLAogIGhhbmRsZXIKKSB7CiAgaWYgKCFoYW5kbGVyKSB7CiAgICByZXR1
cm4gJ2Z1bmN0aW9uKCl7fScKICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaGFuZGxlcikpIHsK
ICAgIHJldHVybiAoIlsiICsgKGhhbmRsZXIubWFwKGZ1bmN0aW9uIChoYW5kbGVyKSB7IHJldHVy
biBnZW5IYW5kbGVyKG5hbWUsIGhhbmRsZXIpOyB9KS5qb2luKCcsJykpICsgIl0iKQogIH0gZWxz
ZSBpZiAoIWhhbmRsZXIubW9kaWZpZXJzKSB7CiAgICByZXR1cm4gZm5FeHBSRS50ZXN0KGhhbmRs
ZXIudmFsdWUpIHx8IHNpbXBsZVBhdGhSRS50ZXN0KGhhbmRsZXIudmFsdWUpCiAgICAgID8gaGFu
ZGxlci52YWx1ZQogICAgICA6ICgiZnVuY3Rpb24oJGV2ZW50KXsiICsgKGhhbmRsZXIudmFsdWUp
ICsgIn0iKQogIH0gZWxzZSB7CiAgICB2YXIgY29kZSA9ICcnOwogICAgdmFyIGtleXMgPSBbXTsK
ICAgIGZvciAodmFyIGtleSBpbiBoYW5kbGVyLm1vZGlmaWVycykgewogICAgICBpZiAobW9kaWZp
ZXJDb2RlW2tleV0pIHsKICAgICAgICBjb2RlICs9IG1vZGlmaWVyQ29kZVtrZXldOwogICAgICB9
IGVsc2UgewogICAgICAgIGtleXMucHVzaChrZXkpOwogICAgICB9CiAgICB9CiAgICBpZiAoa2V5
cy5sZW5ndGgpIHsKICAgICAgY29kZSA9IGdlbktleUZpbHRlcihrZXlzKSArIGNvZGU7CiAgICB9
CiAgICB2YXIgaGFuZGxlckNvZGUgPSBzaW1wbGVQYXRoUkUudGVzdChoYW5kbGVyLnZhbHVlKQog
ICAgICA/IGhhbmRsZXIudmFsdWUgKyAnKCRldmVudCknCiAgICAgIDogaGFuZGxlci52YWx1ZTsK
ICAgIHJldHVybiAnZnVuY3Rpb24oJGV2ZW50KXsnICsgY29kZSArIGhhbmRsZXJDb2RlICsgJ30n
CiAgfQp9CgpmdW5jdGlvbiBnZW5LZXlGaWx0ZXIgKGtleXMpIHsKICByZXR1cm4gKCJpZigiICsg
KGtleXMubWFwKGdlbkZpbHRlckNvZGUpLmpvaW4oJyYmJykpICsgIilyZXR1cm47IikKfQoKZnVu
Y3Rpb24gZ2VuRmlsdGVyQ29kZSAoa2V5KSB7CiAgdmFyIGtleVZhbCA9IHBhcnNlSW50KGtleSwg
MTApOwogIGlmIChrZXlWYWwpIHsKICAgIHJldHVybiAoIiRldmVudC5rZXlDb2RlIT09IiArIGtl
eVZhbCkKICB9CiAgdmFyIGFsaWFzID0ga2V5Q29kZXNba2V5XTsKICByZXR1cm4gKCJfaygkZXZl
bnQua2V5Q29kZSwiICsgKEpTT04uc3RyaW5naWZ5KGtleSkpICsgKGFsaWFzID8gJywnICsgSlNP
Ti5zdHJpbmdpZnkoYWxpYXMpIDogJycpICsgIikiKQp9CgovKiAgKi8KCmZ1bmN0aW9uIGJpbmQk
MiAoZWwsIGRpcikgewogIGVsLndyYXBEYXRhID0gZnVuY3Rpb24gKGNvZGUpIHsKICAgIHJldHVy
biAoIl9iKCIgKyBjb2RlICsgIiwnIiArIChlbC50YWcpICsgIicsIiArIChkaXIudmFsdWUpICsg
KGRpci5tb2RpZmllcnMgJiYgZGlyLm0=</Default>
</Parameter>

<Parameter name="Frag916644214336233193835390">
<Default>UGxhaW5PYmplY3QsCgl0b09iamVjdDogdG9PYmplY3QsCglub29wOiBub29wLAoJbm86IG5vLAoJ
aWRlbnRpdHk6IGlkZW50aXR5LAoJZ2VuU3RhdGljS2V5czogZ2VuU3RhdGljS2V5cywKCWxvb3Nl
RXF1YWw6IGxvb3NlRXF1YWwsCglsb29zZUluZGV4T2Y6IGxvb3NlSW5kZXhPZiwKCWlzUmVzZXJ2
ZWQ6IGlzUmVzZXJ2ZWQsCglkZWY6IGRlZiwKCXBhcnNlUGF0aDogcGFyc2VQYXRoLAoJaGFzUHJv
dG86IGhhc1Byb3RvLAoJaW5Ccm93c2VyOiBpbkJyb3dzZXIsCglVQTogVUEsCglpc0lFOiBpc0lF
LAoJaXNJRTk6IGlzSUU5LAoJaXNFZGdlOiBpc0VkZ2UsCglpc0FuZHJvaWQ6IGlzQW5kcm9pZCwK
CWlzSU9TOiBpc0lPUywKCWlzU2VydmVyUmVuZGVyaW5nOiBpc1NlcnZlclJlbmRlcmluZywKCWRl
dnRvb2xzOiBkZXZ0b29scywKCW5leHRUaWNrOiBuZXh0VGljaywKCWdldCBfU2V0ICgpIHsgcmV0
dXJuIF9TZXQ7IH0sCgltZXJnZU9wdGlvbnM6IG1lcmdlT3B0aW9ucywKCXJlc29sdmVBc3NldDog
cmVzb2x2ZUFzc2V0LAoJZ2V0IHdhcm4gKCkgeyByZXR1cm4gd2FybjsgfSwKCWdldCBmb3JtYXRD
b21wb25lbnROYW1lICgpIHsgcmV0dXJuIGZvcm1hdENvbXBvbmVudE5hbWU7IH0sCgl2YWxpZGF0
ZVByb3A6IHZhbGlkYXRlUHJvcAp9KTsKCi8qIG5vdCB0eXBlIGNoZWNraW5nIHRoaXMgZmlsZSBi
ZWNhdXNlIGZsb3cgZG9lc24ndCBwbGF5IHdlbGwgd2l0aCBQcm94eSAqLwoKdmFyIGluaXRQcm94
eTsKCnsKICB2YXIgYWxsb3dlZEdsb2JhbHMgPSBtYWtlTWFwKAogICAgJ0luZmluaXR5LHVuZGVm
aW5lZCxOYU4saXNGaW5pdGUsaXNOYU4sJyArCiAgICAncGFyc2VGbG9hdCxwYXJzZUludCxkZWNv
ZGVVUkksZGVjb2RlVVJJQ29tcG9uZW50LGVuY29kZVVSSSxlbmNvZGVVUklDb21wb25lbnQsJyAr
CiAgICAnTWF0aCxOdW1iZXIsRGF0ZSxBcnJheSxPYmplY3QsQm9vbGVhbixTdHJpbmcsUmVnRXhw
LE1hcCxTZXQsSlNPTixJbnRsLCcgKwogICAgJ3JlcXVpcmUnIC8vIGZvciBXZWJwYWNrL0Jyb3dz
ZXJpZnkKICApOwoKICB2YXIgd2Fybk5vblByZXNlbnQgPSBmdW5jdGlvbiAodGFyZ2V0LCBrZXkp
IHsKICAgIHdhcm4oCiAgICAgICJQcm9wZXJ0eSBvciBtZXRob2QgXCIiICsga2V5ICsgIlwiIGlz
IG5vdCBkZWZpbmVkIG9uIHRoZSBpbnN0YW5jZSBidXQgIiArCiAgICAgICJyZWZlcmVuY2VkIGR1
cmluZyByZW5kZXIuIE1ha2Ugc3VyZSB0byBkZWNsYXJlIHJlYWN0aXZlIGRhdGEgIiArCiAgICAg
ICJwcm9wZXJ0aWVzIGluIHRoZSBkYXRhIG9wdGlvbi4iLAogICAgICB0YXJnZXQKICAgICk7CiAg
fTsKCiAgdmFyIGhhc1Byb3h5ID0KICAgIHR5cGVvZiBQcm94eSAhPT0gJ3VuZGVmaW5lZCcgJiYK
ICAgIFByb3h5LnRvU3RyaW5nKCkubWF0Y2goL25hdGl2ZSBjb2RlLyk7CgogIGlmIChoYXNQcm94
eSkgewogICAgdmFyIGlzQnVpbHRJbk1vZGlmaWVyID0gbWFrZU1hcCgnc3RvcCxwcmV2ZW50LHNl
bGYsY3RybCxzaGlmdCxhbHQsbWV0YScpOwogICAgY29uZmlnLmtleUNvZGVzID0gbmV3IFByb3h5
KGNvbmZpZy5rZXlDb2RlcywgewogICAgICBzZXQ6IGZ1bmN0aW9uIHNldCAodGFyZ2V0LCBrZXks
IHZhbHVlKSB7CiAgICAgICAgaWYgKGlzQnVpbHRJbk1vZGlmaWVyKGtleSkpIHsKICAgICAgICAg
IHdhcm4oKCJBdm9pZCBvdmVyd3JpdGluZyBidWlsdC1pbiBtb2RpZmllciBpbiBjb25maWcua2V5
Q29kZXM6IC4iICsga2V5KSk7CiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9IGVsc2Ug
ewogICAgICAgICAgdGFyZ2V0W2tleV0gPSB2YWx1ZTsKICAgICAgICAgIHJldHVybiB0cnVlCiAg
ICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CgogIHZhciBoYXNIYW5kbGVyID0gewogICAgaGFz
OiBmdW5jdGlvbiBoYXMgKHRhcmdldCwga2V5KSB7CiAgICAgIHZhciBoYXMgPSBrZXkgaW4gdGFy
Z2V0OwogICAgICB2YXIgaXNBbGxvd2VkID0gYWxsb3dlZEdsb2JhbHMoa2V5KSB8fCBrZXkuY2hh
ckF0KDApID09PSAnXyc7CiAgICAgIGlmICghaGFzICYmICFpc0FsbG93ZWQpIHsKICAgICAgICB3
YXJuTm9uUHJlc2VudCh0YXJnZXQsIGtleSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGhhcyB8fCAh
aXNBbGxvd2VkCiAgICB9CiAgfTsKCiAgdmFyIGdldEhhbmRsZXIgPSB7CiAgICBnZXQ6IGZ1bmN0
aW9uIGdldCAodGFyZ2V0LCBrZXkpIHsKICAgICAgaWYgKHR5cGVvZiBrZXkgPT09ICdzdHJpbmcn
ICYmICEoa2V5IGluIHRhcmdldCkpIHsKICAgICAgICB3YXJuTm9uUHJlc2VudCh0YXJnZXQsIGtl
eSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRhcmdldFtrZXldCiAgICB9CiAgfTsKCiAgaW5pdFBy
b3h5ID0gZnVuY3Rpb24gaW5pdFByb3h5ICh2bSkgewogICAgaWYgKGhhc1Byb3h5KSB7CiAgICAg
IC8vIGRldGVybWluZSB3aGljaCBwcm94eSBoYW5kbGVyIHRvIHVzZQogICAgICB2YXIgb3B0aW9u
cyA9IHZtLiRvcHRpb25zOwogICAgICB2YXIgaGFuZGxlcnMgPSBvcHRpb25zLnJlbmRlciAmJiBv
cHRpb25zLnJlbmRlci5fd2l0aFN0cmlwcGVkCiAgICAgICAgPyBnZXRIYW5kbGVyCiAgICAgICAg
OiBoYXNIYW5kbGVyOwogICAgICB2bS5fcmVuZGVyUHJveHkgPSBuZXcgUHJveHkodm0sIGhhbmRs
ZXJzKTsKICAgIH0gZWxzZSB7CiAgICAgIHZtLl9yZW5kZXJQcm94eSA9IHZtOwogICAgfQogIH07
Cn0KCi8qICAqLwoKCnZhciBxdWV1ZSA9IFtdOwp2YXIgaGFzJDEgPSB7fTsKdmFyIGNpcmN1bGFy
ID0ge307CnZhciB3YWl0aW5nID0gZmFsc2U7CnZhciBmbHVzaGluZyA9IGZhbHNlOwp2YXIgaW5k
ZXggPSAwOwoKLyoqCiAqIFJlc2V0IHRoZSBzY2hlZHVsZXIncyBzdGF0ZS4KICovCmZ1bmN0aW9u
IHJlc2V0U2NoZWR1bGVyU3RhdGUgKCkgewogIHF1ZXVlLmxlbmd0aCA9IDA7CiAgaGFzJDEgPSB7
fTsKICB7CiAgICBjaXJjdWxhciA9IHt9OwogIH0KICB3YWl0aW5nID0gZmx1c2hpbmcgPSBmYWxz
ZTsKfQoKLyoqCiAqIEZsdXNoIGJvdGggcXVldWVzIGFuZCBydW4gdGhlIHdhdGNoZXJzLgogKi8K
ZnVuY3Rpb24gZmx1c2hTY2hlZHVsZXJRdWV1ZSAoKSB7CiAgZmx1c2hpbmcgPSB0cnVlOwoKICAv
LyBTb3J0IHF1ZXVlIGJlZm9yZSBmbHVzaC4KICAvLyBUaGlzIGVuc3VyZXMgdGhhdDoKICAvLyAx
LiBDb21wb25lbnRzIGFyZSB1cGRhdGVkIGZyb20gcGFyZW50IHRvIGNoaWxkLiAoYmVjYXVzZSBw
YXJlbnQgaXMgYWx3YXlzCiAgLy8gICAgY3JlYXRlZCBiZWZvcmUgdGhlIGNoaWxkKQogIC8vIDIu
IEEgY29tcG9uZW50J3MgdXNlciB3YXRjaGVycyBhcmUgcnVuIGJlZm9yZSBpdHMgcmVuZGVyIHdh
dGNoZXIgKGJlY2F1c2UKICAvLyAgICB1c2VyIHdhdGNoZXJzIGFyZSBjcmVhdGVkIGJlZm9yZSB0
aGUgcmVuZGVyIHdhdGNoZXIpCiAgLy8gMy4gSWYgYSBjb21wb25lbnQgaXMgZGVzdHJveWVkIGR1
cmluZyBhIHBhcmVudCBjb21wb25lbnQncyB3YXRjaGVyIHJ1biwKICAvLyAgICBpdHMgd2F0Y2hl
cnMgY2FuIGJlIHNraXBwZWQuCiAgcXVldWUuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4g
YS5pZCAtIGIuaWQ7IH0pOwoKICAvLyBkbyBub3QgY2FjaGUgbGVuZ3RoIGJlY2F1c2UgbW9yZSB3
YXRjaGVycyBtaWdodCBiZSBwdXNoZWQKICAvLyBhcyB3ZSBydW4gZXhpc3Rpbmcgd2F0Y2hlcnMK
ICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBxdWV1ZS5sZW5ndGg7IGluZGV4KyspIHsKICAgIHZh
ciB3YXRjaGVyID0gcXVldWVbaW5kZXhdOwogICAgdmFyIGlkID0gd2F0Y2hlci5pZDsKICAgIGhh
cyQxW2lkXSA9IG51bGw7CiAgICB3YXRjaGVyLnJ1bigpOwogICAgLy8gaW4gZGV2IGJ1aWxkLCBj
aGVjayBhbmQgc3RvcCBjaXJjdWxhciB1cGRhdGVzLgogICAgaWYgKCJkZXZlbG9wbWVudCIgIT09
ICdwcm9kdWN0aW9uJyAmJiBoYXMkMVtpZF0gIT0gbnVsbCkgewogICAgICBjaXJjdWxhcltpZF0g
PSAoY2lyY3VsYXJbaWRdIHx8IDApICsgMTsKICAgICAgaWYgKGNpcmN1bGFyW2lkXSA+IGNvbmZp
Zy5fbWF4VXBkYXRlQ291bnQpIHsKICAgICAgICB3YXJuKAogICAgICAgICAgJ1lvdSBtYXkgaGF2
ZSBhbiBpbmZpbml0ZSB1cGRhdGUgbG9vcCAnICsgKAogICAgICAgICAgICB3YXRjaGVyLnVzZXIK
ICAgICAgICAgICAgICA/ICgiaW4gd2F0Y2hlciB3aXRoIGV4cHJlc3Npb24gXCIiICsgKHdhdGNo
ZXIuZXhwcmVzc2lvbikgKyAiXCIiKQogICAgICAgICAgICAgIDogImluIGEgY29tcG9uZW50IHJl
bmRlciBmdW5jdGlvbi4iCiAgICAgICAgICApLAogICAgICAgICAgd2F0Y2hlci52bQogICAgICAg
ICk7CiAgICAgICAgYnJlYWsKICAgICAgfQogICAgfQogIH0KCiAgLy8gZGV2dG9vbCBob29rCiAg
LyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGRldnRvb2xzICYmIGNvbmZpZy5kZXZ0b29s
cykgewogICAgZGV2dG9vbHMuZW1pdCgnZmx1c2gnKTsKICB9CgogIHJlc2V0U2NoZWR1bGVyU3Rh
dGUoKTsKfQoKLyoqCiAqIFB1c2ggYSB3YXRjaGVyIGludG8gdGhlIHdhdGNoZXIgcXVldWUuCiAq
IEpvYnMgd2l0aCBkdXBsaWNhdGUgSURzIHdpbGwgYmUgc2tpcHBlZCB1bmxlc3MgaXQncwogKiBw
dXNoZWQgd2hlbiB0aGUgcXVldWUgaXMgYmVpbmcgZmx1c2hlZC4KICovCmZ1bmN0aW9uIHF1ZXVl
V2F0Y2hlciAod2F0Y2hlcikgewogIHZhciBpZCA9IHdhdGNoZXIuaWQ7CiAgaWYgKGhhcyQxW2lk
XSA9PSBudWxsKSB7CiAgICBoYXMkMVtpZF0gPSB0cnVlOwogICAgaWYgKCFmbHVzaGluZykgewog
ICAgICBxdWV1ZS5wdXNoKHdhdGNoZXIpOwogICAgfSBlbHNlIHsKICAgICAgLy8gaWYgYWxyZWFk
eSBmbHVzaGluZywgc3BsaWNlIHRoZSB3YXRjaGVyIGJhc2VkIG9uIGl0cyBpZAogICAgICAvLyBp
ZiBhbHJlYWR5IHBhc3QgaXRzIGlkLCBpdCB3aWxsIGJlIHJ1biBuZXh0IGltbWVkaWF0ZWx5Lgog
ICAgICB2YXIgaSA9IHF1ZXVlLmxlbmd0aCAtIDE7CiAgICAgIHdoaWxlIChpID49IDAgJiYgcXVl
dWVbaV0uaWQgPiB3YXRjaGVyLmlkKSB7CiAgICAgICAgaS0tOwogICAgICB9CiAgICAgIHF1ZXVl
LnNwbGljZShNYXRoLm1heChpLCBpbmRleCkgKyAxLCAwLCB3YXRjaGVyKTsKICAgIH0KICAgIC8v
IHF1ZXVlIHRoZSBmbHVzaAogICAgaWYgKCF3YWl0aW5nKSB7CiAgICAgIHdhaXRpbmcgPSB0cnVl
OwogICAgICBuZXh0VGljayhmbHVzaFNjaGVkdWxlclF1ZXVlKTsKICAgIH0KICB9Cn0KCi8qICAq
LwoKdmFyIHVpZCQyID0gMDsKCi8qKgogKiBBIHdhdGNoZXIgcGFyc2VzIGFuIGV4cHJlc3Npb24s
IGNvbGxlY3RzIGRlcGVuZGVuY2llcywKICogYW5kIGZpcmVzIGNhbGxiYWNrIHdoZW4gdGhlIGV4
cHJlc3Npb24gdmFsdWUgY2hhbmdlcy4KICogVGhpcyBpcyB1c2VkIGZvciBib3RoIHRoZSAkd2F0
Y2goKSBhcGkgYW5kIGRpcmVjdGl2ZXMuCiAqLwp2YXIgV2F0Y2hlciA9IGZ1bmN0aW9uIFdhdGNo
ZXIgKAogIHZtLAogIGV4cE9yRm4sCiAgY2IsCiAgb3B0aW9ucwopIHsKICBpZiAoIG9wdGlvbnMg
PT09IHZvaWQgMCApIG9wdGlvbnMgPSB7fTsKCiAgdGhpcy52bSA9IHZtOwogIHZtLl93YXRjaGVy
cy5wdXNoKHRoaXMpOwogIC8vIG9wdGlvbnMKICB0aGlzLmRlZXAgPSAhIW9wdGlvbnMuZGVlcDsK
ICB0aGlzLnVzZXIgPSAhIW9wdGlvbnMudXNlcjsKICB0aGlzLmxhenkgPSAhIW9wdGlvbnMubGF6
eTsKICB0aGlzLnN5bmMgPSAhIW9wdGlvbnMuc3luYzsKICB0aGlzLmV4cHJlc3Npb24gPSBleHBP
ckZuLnRvU3RyaW5nKCk7CiAgdGhpcy5jYiA9IGNiOwogIHRoaXMuaWQgPSArK3VpZCQyOyAvLyB1
aWQgZm9yIGJhdGNoaW5nCiAgdGhpcy5hY3RpdmUgPSB0cnVlOwogIHRoaXMuZGlydHkgPSB0aGlz
Lmxhenk7IC8vIGZvciBsYXp5IHdhdGNoZXJzCiAgdGhpcy5kZXBzID0gW107CiAgdGhpcy5uZXdE
ZXBzID0gW107CiAgdGhpcy5kZXBJZHMgPSBuZXcgX1NldCgpOwogIHRoaXMubmV3RGVwSWRzID0g
bmV3IF9TZXQoKTsKICAvLyBwYXJzZSBleHByZXNzaW9uIGZvciBnZXR0ZXIKICBpZiAodHlwZW9m
IGV4cE9yRm4gPT09ICdmdW5jdGlvbicpIHsKICAgIHRoaXMuZ2V0dGVyID0gZXhwT3JGbjsKICB9
IGVsc2UgewogICAgdGhpcy5nZXR0ZXIgPSBwYXJzZVBhdGgoZXhwT3JGbik7CiAgICBpZiAoIXRo
aXMuZ2V0dGVyKSB7CiAgICAgIHRoaXMuZ2V0dGVyID0gZnVuY3Rpb24gKCkge307CiAgICAgICJk
ZXZlbG9wbWVudCIgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKAogICAgICAgICJGYWlsZWQgd2F0
Y2hpbmcgcGF0aDogXCIiICsgZXhwT3JGbiArICJcIiAiICsKICAgICAgICAnV2F0Y2hlciBvbmx5
IGFjY2VwdHMgc2ltcGxlIGRvdC1kZWxpbWl0ZWQgcGF0aHMuICcgKwogICAgICAgICdGb3IgZnVs
bCBjb250cm9sLCB1c2UgYSBmdW5jdGlvbiBpbnN0ZWFkLicsCiAgICAgICAgdm0KICAgICAgKTsK
ICAgIH0KICB9CiAgdGhpcy52YWx1ZSA9IHRoaXMubGF6eQogICAgPyB1bmRlZmluZWQKICAgIDog
dGhpcy5nZXQoKTsKfTsKCi8qKgogKiBFdmFsdWF0ZSB0aGUgZ2V0dGVyLCBhbmQgcmUtY29sbGVj
dCBkZXBlbmRlbmNpZXMuCiAqLwpXYXRjaGVyLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiBnZXQg
KCkgewogIHB1c2hUYXJnZXQodGhpcyk7CiAgdmFyIHZhbHVlID0gdGhpcy5nZXR0ZXIuY2FsbCh0
aGlzLnZtLCB0aGlzLnZtKTsKICAvLyAidG91Y2giIGV2ZXJ5IHByb3BlcnR5IHNvIHRoZXkgYXJl
IGFsbCB0cmFja2VkIGFzCiAgLy8gZGVwZW5kZW5jaWVzIGZvciBkZWVwIHdhdGNoaW5nCiAgaWYg
KHRoaXMuZGVlcCkgewogICAgdHJhdmVyc2UodmFsdWUpOwogIH0KICBwb3BUYXJnZXQoKTsKICB0
aGlzLmNsZWFudXBEZXBzKCk7CiAgcmV0dXJuIHZhbHVlCn07CgovKioKICogQWRkIGEgZGVwZW5k
ZW5jeSB0byB0aGlzIGRpcmVjdGl2ZS4KICovCldhdGNoZXIucHJvdG90eXBlLmFkZERlcCA9IGZ1
bmN0aW9uIGFkZERlcCAoZGVwKSB7CiAgdmFyIGlkID0gZGVwLmlkOwogIGlmICghdGhpcy5uZXdE
ZXBJZHMuaGFzKGlkKSkgewogICAgdGhpcy5uZXdEZXBJZHMuYWRkKGlkKTsKICAgIHRoaXMubmV3
RGVwcy5wdXNoKGRlcCk7CiAgICBpZiAoIXRoaXMuZGVwSWRzLmhhcyhpZCkpIHsKICAgICAgZGVw
LmFkZFN1Yih0aGlzKTsKICAgIH0KICB9Cn07CgovKioKICogQ2xlYW4gdXAgZm9yIGRlcGVuZGVu
Y3kgY29sbGVjdGlvbi4KICovCldhdGNoZXIucHJvdG90eXBlLmNsZWFudXBEZXBzID0gZnVuY3Rp
b24gY2xlYW51cERlcHMgKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogIHZhciBpID0gdGhp
cy5kZXBzLmxlbmd0aDsKICB3aGlsZSAoaS0tKSB7CiAgICB2YXIgZGVwID0gdGhpcyQxLmRlcHNb
aV07CiAgICBpZiAoIXRoaXMkMS5uZXdEZXBJZHMuaGFzKGRlcC5pZCkpIHsKICAgICAgZGVwLnJl
bW92ZVN1Yih0aGlzJDEpOwogICAgfQogIH0KICB2YXIgdG1wID0gdGhpcy5kZXBJZHM7CiAgdGhp
cy5kZXBJZHMgPSB0aGlzLm5ld0RlcElkczsKICB0aGlzLm5ld0RlcElkcyA9IHRtcDsKICB0aGlz
Lm5ld0RlcElkcy5jbGVhcigpOwogIHRtcCA9IHRoaXMuZGVwczsKICB0aGlzLmRlcHMgPSB0aGlz
Lm5ld0RlcHM7CiAgdGhpcy5uZXdEZXBzID0gdG1wOwogIHRoaXMubmV3RGVwcy5sZW5ndGggPSAw
Owp9OwoKLyoqCiAqIFN1YnNjcmliZXIgaW50ZXJmYWNlLgogKiBXaWxsIGJlIGNhbGxlZCB3aGVu
IGEgZGVwZW5kZW5jeSBjaGFuZ2VzLgogKi8KV2F0Y2hlci5wcm90b3R5cGUudXBkYXRlID0gZnVu
Y3Rpb24gdXBkYXRlICgpIHsKICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwogIGlmICh0aGlz
LmxhenkpIHsKICAgIHRoaXMuZGlydHkgPSB0cnVlOwogIH0gZWxzZSBpZiAodGhpcy5zeW5jKSB7
CiAgICB0aGlzLnJ1bigpOwogIH0gZWxzZSB7CiAgICBxdWV1ZVdhdGNoZXIodGhpcyk7CiAgfQp9
OwoKLyoqCiAqIFNjaGVkdWxlciBqb2IgaW50ZXJmYWNlLgogKiBXaWxsIGJlIGNhbGxlZCBieSB0
aGUgc2NoZWR1bGVyLgogKi8KV2F0Y2hlci5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gcnVuICgp
IHsKICBpZiAodGhpcy5hY3RpdmUpIHsKICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0KCk7CiAgICAg
IGlmICgKICAgICAgICB2YWx1ZSAhPT0gdGhpcy52YWx1ZSB8fAogICAgICAvLyBEZWVwIHdhdGNo
ZXJzIGFuZCB3YXRjaGVycyBvbiBPYmplY3QvQXJyYXlzIHNob3VsZCBmaXJlIGV2ZW4KICAgICAg
Ly8gd2hlbiB0aGUgdmFsdWUgaXMgdGhlIHNhbWUsIGJlY2F1c2UgdGhlIHZhbHVlIG1heQogICAg
ICAvLyBoYXZlIG11dGF0ZWQuCiAgICAgIGlzT2JqZWN0KHZhbHVlKSB8fAogICAgICB0aGlzLmRl
ZXAKICAgICkgewogICAgICAvLyBzZXQgbmV3IHZhbHVlCiAgICAgIHZhciBvbGRWYWx1ZSA9IHRo
aXMudmFsdWU7CiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKICAgICAgaWYgKHRoaXMudXNlcikg
ewogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGlzLmNiLmNhbGwodGhpcy52bSwgdmFsdWUsIG9s
ZFZhbHVlKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25v
cmUgZWxzZSAqLwogICAgICAgICAgaWYgKGNvbmZpZy5lcnJvckhhbmRsZXIpIHsKICAgICAgICAg
ICAgY29uZmlnLmVycm9ySGFuZGxlci5jYWxsKG51bGwsIGUsIHRoaXMudm0pOwogICAgICAgICAg
fSBlbHNlIHsKICAgICAgICAgICAgImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdh
cm4oCiAgICAgICAgICAgICAgKCJFcnJvciBpbiB3YXRjaGVyIFwiIiArICh0aGlzLmV4cHJlc3Np
b24pICsgIlwiIiksCiAgICAgICAgICAgICAgdGhpcy52bQogICAgICAgICAgICApOwogICAgICAg
ICAgICB0aHJvdyBlCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAg
IHRoaXMuY2IuY2FsbCh0aGlzLnZtLCB2YWx1ZSwgb2xkVmFsdWUpOwogICAgICB9CiAgICB9CiAg
fQp9OwoKLyoqCiAqIEV2YWx1YXRlIHRoZSB2YWx1ZSBvZiB0aGUgd2F0Y2hlci4KICogVGhpcyBv
bmx5IGdldHMgY2FsbGVkIGZvciBsYXp5IHdhdGNoZXJzLgogKi8KV2F0Y2hlci5wcm90b3R5cGUu
ZXZhbHVhdGUgPSBmdW5jdGlvbiBldmFsdWF0ZSAoKSB7CiAgdGhpcy52YWx1ZSA9IHRoaXMuZ2V0
KCk7CiAgdGhpcy5kaXJ0eSA9IGZhbHNlOwp9OwoKLyoqCiAqIERlcGVuZCBvbiBhbGwgZGVwcyBj
b2xsZWN0ZWQgYnkgdGhpcyB3YXRjaGVyLgogKi8KV2F0Y2hlci5wcm90b3R5cGUuZGVwZW5kID0g
ZnVuY3Rpb24gZGVwZW5kICgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICB2YXIgaSA9IHRo
aXMuZGVwcy5sZW5ndGg7CiAgd2hpbGUgKGktLSkgewogICAgdGhpcyQxLmRlcHNbaV0uZGVwZW5k
KCk7CiAgfQp9OwoKLyoqCiAqIFJlbW92ZSBzZWxmIGZyb20gYWxsIGRlcGVuZGVuY2llcycgc3Vi
c2NyaWJlciBsaXN0LgogKi8KV2F0Y2hlci5wcm90b3R5cGUudGVhcmRvd24gPSBmdW5jdGlvbiB0
ZWFyZG93biAoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgaWYgKHRoaXMuYWN0aXZlKSB7
CiAgICAvLyByZW1vdmUgc2VsZiBmcm9tIHZtJ3Mgd2F0Y2hlciBsaXN0CiAgICAvLyB0aGlzIGlz
IGEgc29tZXdoYXQgZXhwZW5zaXZlIG9wZXJhdGlvbiBzbyB3ZSBza2lwIGl0CiAgICAvLyBpZiB0
aGUgdm0gaXMgYmVpbmcgZGVzdHJveWVkIG9yIGlzIHBlcmZvcm1pbmcgYSB2LWZvcgogICAgLy8g
cmUtcmVuZGVyICh0aGUgd2F0Y2hlciBsaXN0IGlzIHRoZW4gZmlsdGVyZWQgYnkgdi1mb3IpLgog
ICAgaWYgKCF0aGlzLnZtLl9pc0JlaW5nRGVzdHJveWVkICYmICF0aGlzLnZtLl92Rm9yUmVtb3Zp
bmcpIHsKICAgICAgcmVtb3ZlJDEodGhpcy52bS5fd2F0Y2hlcnMsIHRoaXMpOwogICAgfQogICAg
dmFyIGkgPSB0aGlzLmRlcHMubGVuZ3RoOwogICAgd2hpbGUgKGktLSkgewogICAgICB0aGlzJDEu
ZGVwc1tpXS5yZW1vdmVTdWIodGhpcyQxKTsKICAgIH0KICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7
CiAgfQp9OwoKLyoqCiAqIFJlY3Vyc2l2ZWx5IHRyYXZlcnNlIGFuIG9iamVjdCB0byBldm9rZSBh
bGwgY29udmVydGVkCiAqIGdldHRlcnMsIHNvIHRoYXQgZXZlcnkgbmVzdGVkIHByb3BlcnR5IGlu
c2lkZSB0aGUgb2JqZWN0CiAqIGlzIGNvbGxlY3RlZCBhcyBhICJkZWVwIiBkZXBlbmRlbmN5Lgog
Ki8KdmFyIHNlZW5PYmplY3RzID0gbmV3IF9TZXQoKTsKZnVuY3Rpb24gdHJhdmVyc2UgKHZhbCkg
ewogIHNlZW5PYmplY3RzLmNsZWFyKCk7CiAgX3RyYXZlcnNlKHZhbCwgc2Vlbk9iamVjdHMpOwp9
CgpmdW5jdGlvbiBfdHJhdmVyc2UgKHZhbCwgc2VlbikgewogIHZhciBpLCBrZXlzOwogIHZhciBp
c0EgPSBBcnJheS5pc0FycmF5KHZhbCk7CiAgaWYgKCghaXNBICYmICFpc09iamVjdCh2YWwpKSB8
fCAhT2JqZWN0LmlzRXh0ZW5zaWJsZSh2YWwpKSB7CiAgICByZXR1cm4KICB9CiAgaWYgKHZhbC5f
X29iX18pIHsKICAgIHZhciBkZXBJZCA9IHZhbC5fX29iX18uZGVwLmlkOwogICAgaWYgKHNlZW4u
aGFzKGRlcElkKSkgewogICAgICByZXR1cm4KICAgIH0KICAgIHNlZW4uYWRkKGRlcElkKTsKICB9
CiAgaWYgKGlzQSkgewogICAgaSA9IHZhbC5sZW5ndGg7CiAgICB3aGlsZSAoaS0tKSB7IF90cmF2
ZXJzZSh2YWxbaV0sIHNlZW4pOyB9CiAgfSBlbHNlIHsKICAgIGtleXMgPSBPYmplY3Qua2V5cyh2
YWwpOwogICAgaSA9IGtleXMubGVuZ3RoOwogICAgd2hpbGUgKGktLSkgeyBfdHJhdmVyc2UodmFs
W2tleXNbaV1dLCBzZWVuKTsgfQogIH0KfQoKLyogICovCgpmdW5jdGlvbiBpbml0U3RhdGUgKHZt
KSB7CiAgdm0uX3dhdGNoZXJzID0gW107CiAgaW5pdFByb3BzKHZtKTsKICBpbml0TWV0aG9kcyh2
bSk7CiAgaW5pdERhdGEodm0pOwogIGluaXRDb21wdXRlZCh2bSk7CiAgaW5pdFdhdGNoKHZtKTsK
fQoKdmFyIGlzUmVzZXJ2ZWRQcm9wID0geyBrZXk6IDEsIHJlZjogMSwgc2xvdDogMSB9OwoKZnVu
Y3Rpb24gaW5pdFByb3BzICh2bSkgewogIHZhciBwcm9wcyA9IHZtLiRvcHRpb25zLnByb3BzOwog
IGlmIChwcm9wcykgewogICAgdmFyIHByb3BzRGF0YSA9IHZtLiRvcHRpb25zLnByb3BzRGF0YSB8
fCB7fTsKICAgIHZhciBrZXlzID0gdm0uJG9wdGlvbnMuX3Byb3BLZXlzID0gT2JqZWN0LmtleXMo
cHJvcHMpOwogICAgdmFyIGlzUm9vdCA9ICF2bS4kcGFyZW50OwogICAgLy8gcm9vdCBpbnN0YW5j
ZSBwcm9wcyBzaG91bGQgYmUgY29udmVydGVkCiAgICBvYnNlcnZlclN0YXRlLnNob3VsZENvbnZl
cnQgPSBpc1Jvb3Q7CiAgICB2YXIgbG9vcCA9IGZ1bmN0aW9uICggaSApIHsKICAgICAgdmFyIGtl
eSA9IGtleXNbaV07CiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovCiAgICAgIHsKICAg
ICAgICBpZiAoaXNSZXNlcnZlZFByb3Bba2V5XSkgewogICAgICAgICAgd2FybigKICAgICAgICAg
ICAgKCJcIiIgKyBrZXkgKyAiXCIgaXMgYSByZXNlcnZlZCBhdHRyaWJ1dGUgYW5kIGNhbm5vdCBi
ZSB1c2VkIGFzIGNvbXBvbmVudCBwcm9wLiIpLAogICAgICAgICAgICB2bQogICAgICAgICAgKTsK
ICAgICAgICB9CiAgICAgICAgZGVmaW5lUmVhY3RpdmUkJDEodm0sIGtleSwgdmFsaWRhdGVQcm9w
KGtleSwgcHJvcHMsIHByb3BzRGF0YSwgdm0pLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAo
dm0uJHBhcmVudCAmJiAhb2JzZXJ2ZXJTdGF0ZS5pc1NldHRpbmdQcm9wcykgewogICAgICAgICAg
ICB3YXJuKAogICAgICAgICAgICAgICJBdm9pZCBtdXRhdGluZyBhIHByb3AgZGlyZWN0bHkgc2lu
Y2UgdGhlIHZhbHVlIHdpbGwgYmUgIiArCiAgICAgICAgICAgICAgIm92ZXJ3cml0dGVuIHdoZW5l
dmVyIHRoZSBwYXJlbnQgY29tcG9uZW50IHJlLXJlbmRlcnMuICIgKwogICAgICAgICAgICAgICJJ
bnN0ZWFkLCB1c2UgYSBkYXRhIG9yIGNvbXB1dGVkIHByb3BlcnR5IGJhc2VkIG9uIHRoZSBwcm9w
J3MgIiArCiAgICAgICAgICAgICAgInZhbHVlLiBQcm9wIGJlaW5nIG11dGF0ZWQ6IFwiIiArIGtl
eSArICJcIiIsCiAgICAgICAgICAgICAgdm0KICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAg
ICAgICB9KTsKICAgICAgfQogICAgfTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVu
Z3RoOyBpKyspIGxvb3AoIGkgKTsKICAgIG9ic2VydmVyU3RhdGUuc2hvdWxkQ29udmVydCA9IHRy
dWU7CiAgfQp9CgpmdW5jdGlvbiBpbml0RGF0YSAodm0pIHsKICB2YXIgZGF0YSA9IHZtLiRvcHRp
b25zLmRhdGE7CiAgZGF0YSA9IHZtLl9kYXRhID0gdHlwZW9mIGRhdGEgPT09ICdmdW5jdGlvbicK
ICAgID8gZGF0YS5jYWxsKHZtKQogICAgOiBkYXRhIHx8IHt9OwogIGlmICghaXNQbGFpbk9iamVj
dChkYXRhKSkgewogICAgZGF0YSA9IHt9OwogICAgImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rp
b24nICYmIHdhcm4oCiAgICAgICdkYXRhIGZ1bmN0aW9ucyBzaG91bGQgcmV0dXJuIGFuIG9iamVj
dDpcbicgKwogICAgICAnaHR0cHM6Ly92dWVqcy5vcmcvdjIvZ3VpZGUvY29tcG9uZW50cy5odG1s
I2RhdGEtTXVzdC1CZS1hLUZ1bmN0aW9uJywKICAgICAgdm0KICAgICk7CiAgfQogIC8vIHByb3h5
IGRhdGEgb24gaW5zdGFuY2UKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRhdGEpOwogIHZhciBw
cm9wcyA9IHZtLiRvcHRpb25zLnByb3BzOwogIHZhciBpID0ga2V5cy5sZW5ndGg7CiAgd2hpbGUg
KGktLSkgewogICAgaWYgKHByb3BzICYmIGhhc093bihwcm9wcywga2V5c1tpXSkpIHsKICAgICAg
ImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oCiAgICAgICAgIlRoZSBkYXRh
IHByb3BlcnR5IFwiIiArIChrZXlzW2ldKSArICJcIiBpcyBhbHJlYWR5IGRlY2xhcmVkIGFzIGEg
cHJvcC4gIiArCiAgICAgICAgIlVzZSBwcm9wIGRlZmF1bHQgdmFsdWUgaW5zdGVhZC4iLAogICAg
ICAgIHZtCiAgICAgICk7CiAgICB9IGVsc2UgewogICAgICBwcm94eSh2bSwga2V5c1tpXSk7CiAg
ICB9CiAgfQogIC8vIG9ic2VydmUgZGF0YQogIG9ic2VydmUoZGF0YSk7CiAgZGF0YS5fX29iX18g
JiYgZGF0YS5fX29iX18udm1Db3VudCsrOwp9Cgp2YXIgY29tcHV0ZWRTaGFyZWREZWZpbml0aW9u
ID0gewogIGVudW1lcmFibGU6IHRydWUsCiAgY29uZmlndXJhYmxlOiB0cnVlLAogIGdldDogbm9v
cCwKICBzZXQ6IG5vb3AKfTsKCmZ1bmN0aW9uIGluaXRDb21wdXRlZCAodm0pIHsKICB2YXIgY29t
cHV0ZWQgPSB2bS4kb3B0aW9ucy5jb21wdXRlZDsKICBpZiAoY29tcHV0ZWQpIHsKICAgIGZvciAo
dmFyIGtleSBpbiBjb21wdXRlZCkgewogICAgICB2YXIgdXNlckRlZiA9IGNvbXB1dGVkW2tleV07
CiAgICAgIGlmICh0eXBlb2YgdXNlckRlZiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGNvbXB1
dGVkU2hhcmVkRGVmaW5pdGlvbi5nZXQgPSBtYWtlQ29tcHV0ZWRHZXR0ZXIodXNlckRlZiwgdm0p
OwogICAgICAgIGNvbXB1dGVkU2hhcmVkRGVmaW5pdGlvbi5zZXQgPSBub29wOwogICAgICB9IGVs
c2UgewogICAgICAgIGNvbXB1dGVkU2hhcmVkRGVmaW5pdGlvbi5nZXQgPSB1c2VyRGVmLmdldAog
ICAgICAgICAgPyB1c2VyRGVmLmNhY2hlICE9PSBmYWxzZQogICAgICAgICAgICA/IG1ha2VDb21w
dXRlZEdldHRlcih1c2VyRGVmLmdldCwgdm0pCiAgICAgICAgICAgIDogYmluZCQxKHVzZXJEZWYu
Z2V0LCB2bSkKICAgICAgICAgIDogbm9vcDsKICAgICAgICBjb21wdXRlZFNoYXJlZERlZmluaXRp
b24uc2V0ID0gdXNlckRlZi5zZXQKICAgICAgICAgID8gYmluZCQxKHVzZXJEZWYuc2V0LCB2bSkK
ICAgICAgICAgIDogbm9vcDsKICAgICAgfQogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodm0s
IGtleSwgY29tcHV0ZWRTaGFyZWREZWZpbml0aW9uKTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIG1h
a2VDb21wdXRlZEdldHRlciAoZ2V0dGVyLCBvd25lcikgewogIHZhciB3YXRjaGVyID0gbmV3IFdh
dGNoZXIob3duZXIsIGdldHRlciwgbm9vcCwgewogICAgbGF6eTogdHJ1ZQogIH0pOwogIHJldHVy
biBmdW5jdGlvbiBjb21wdXRlZEdldHRlciAoKSB7CiAgICBpZiAod2F0Y2hlci5kaXJ0eSkgewog
ICAgICB3YXRjaGVyLmV2YWx1YXRlKCk7CiAgICB9CiAgICBpZiAoRGVwLnRhcmdldCkgewogICAg
ICB3YXRjaGVyLmRlcGVuZCgpOwogICAgfQogICAgcmV0dXJuIHdhdGNoZXIudmFsdWUKICB9Cn0K
CmZ1bmN0aW9uIGluaXRNZXRob2RzICh2bSkgewogIHZhciBtZXRob2RzID0gdm0uJG9wdGlvbnMu
bWV0aG9kczsKICBpZiAobWV0aG9kcykgewogICAgZm9yICh2YXIga2V5IGluIG1ldGhvZHMpIHsK
ICAgICAgdm1ba2V5XSA9IG1ldGhvZHNba2V5XSA9PSBudWxsID8gbm9vcCA6IGJpbmQkMShtZXRo
b2RzW2tleV0sIHZtKTsKICAgICAgaWYgKCJkZXZlbG9wbWVudCIgIT09ICdwcm9kdWN0aW9uJyAm
JiBtZXRob2RzW2tleV0gPT0gbnVsbCkgewogICAgICAgIHdhcm4oCiAgICAgICAgICAibWV0aG9k
IFwiIiArIGtleSArICJcIiBoYXMgYW4gdW5kZWZpbmVkIHZhbHVlIGluIHRoZSBjb21wb25lbnQg
ZGVmaW5pdGlvbi4gIiArCiAgICAgICAgICAiRGlkIHlvdSByZWZlcmVuY2UgdGhlIGZ1bmN0aW9u
IGNvcnJlY3RseT8iLAogICAgICAgICAgdm0KICAgICAgICApOwogICAgICB9CiAgICB9CiAgfQp9
CgpmdW5jdGlvbiBpbml0V2F0Y2ggKHZtKSB7CiAgdmFyIHdhdGNoID0gdm0uJG9wdGlvbnMud2F0
Y2g7CiAgaWYgKHdhdGNoKSB7CiAgICBmb3IgKHZhciBrZXkgaW4gd2F0Y2gpIHsKICAgICAgdmFy
IGhhbmRsZXIgPSB3YXRjaFtrZXldOwogICAgICBpZiAoQXJyYXkuaXNBcnJheShoYW5kbGVyKSkg
ewogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGFuZGxlci5sZW5ndGg7IGkrKykgewogICAg
ICAgICAgY3JlYXRlV2F0Y2hlcih2bSwga2V5LCBoYW5kbGVyW2ldKTsKICAgICAgICB9CiAgICAg
IH0gZWxzZSB7CiAgICAgICAgY3JlYXRlV2F0Y2hlcih2bSwga2V5LCBoYW5kbGVyKTsKICAgICAg
fQogICAgfQogIH0KfQoKZnVuY3Rpb24gY3JlYXRlV2F0Y2hlciAodm0sIGtleSwgaGFuZGxlcikg
ewogIHZhciBvcHRpb25zOwogIGlmIChpc1BsYWluT2JqZWN0KGhhbmRsZXIpKSB7CiAgICBvcHRp
b25zID0gaGFuZGxlcjsKICAgIGhhbmRsZXIgPSBoYW5kbGVyLmhhbmRsZXI7CiAgfQogIGlmICh0
eXBlb2YgaGFuZGxlciA9PT0gJ3N0cmluZycpIHsKICAgIGhhbmRsZXIgPSB2bVtoYW5kbGVyXTsK
ICB9CiAgdm0uJHdhdGNoKGtleSwgaGFuZGxlciwgb3B0aW9ucyk7Cn0KCmZ1bmN0aW9uIHN0YXRl
TWl4aW4gKFZ1ZSkgewogIC8vIGZsb3cgc29tZWhvdyBoYXMgcHJvYmxlbXMgd2l0aCBkaXJlY3Rs
eSBkZWNsYXJlZCBkZWZpbml0aW9uIG9iamVjdAogIC8vIHdoZW4gdXNpbmcgT2JqZWN0LmRlZmlu
ZVByb3BlcnR5LCBzbyB3ZSBoYXZlIHRvIHByb2NlZHVyYWxseSBidWlsZCB1cAogIC8vIHRoZSBv
YmplY3QgaGVyZS4KICB2YXIgZGF0YURlZiA9IHt9OwogIGRhdGFEZWYuZ2V0ID0gZnVuY3Rpb24g
KCkgewogICAgcmV0dXJuIHRoaXMuX2RhdGEKICB9OwogIHsKICAgIGRhdGFEZWYuc2V0ID0gZnVu
Y3Rpb24gKG5ld0RhdGEpIHsKICAgICAgd2FybigKICAgICAgICAnQXZvaWQgcmVwbGFjaW5nIGlu
c3RhbmNlIHJvb3QgJGRhdGEuICcgKwogICAgICAgICdVc2UgbmVzdGVkIGRhdGEgcHJvcGVydGll
cyBpbnN0ZWFkLicsCiAgICAgICAgdGhpcwogICAgICApOwogICAgfTsKICB9CiAgT2JqZWN0LmRl
ZmluZVByb3BlcnR5KFZ1ZS5wcm90b3R5cGUsICckZGF0YScsIGRhdGFEZWYpOwoKICBWdWUucHJv
dG90eXBlLiRzZXQgPSBzZXQkMTsKICBWdWUucHJvdG90eXBlLiRkZWxldGUgPSBkZWw7CgogIFZ1
ZS5wcm90b3R5cGUuJHdhdGNoID0gZnVuY3Rpb24gKAogICAgZXhwT3JGbiwKICAgIGNiLAogICAg
b3B0aW9ucwogICkgewogICAgdmFyIHZtID0gdGhpczsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8
IHt9OwogICAgb3B0aW9ucy51c2VyID0gdHJ1ZTsKICAgIHZhciB3YXRjaGVyID0gbmV3IFdhdGNo
ZXIodm0sIGV4cE9yRm4sIGNiLCBvcHRpb25zKTsKICAgIGlmIChvcHRpb25zLmltbWVkaWF0ZSkg
ewogICAgICBjYi5jYWxsKHZtLCB3YXRjaGVyLnZhbHVlKTsKICAgIH0KICAgIHJldHVybiBmdW5j
dGlvbiB1bndhdGNoRm4gKCkgewogICAgICB3YXRjaGVyLnRlYXJkb3duKCk7CiAgICB9CiAgfTsK
fQoKZnVuY3Rpb24gcHJveHkgKHZtLCBrZXkpIHsKICBpZiAoIWlzUmVzZXJ2ZWQoa2V5KSkgewog
ICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHZtLCBrZXksIHsKICAgICAgY29uZmlndXJhYmxlOiB0
cnVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBnZXQ6IGZ1bmN0aW9uIHByb3h5R2V0
dGVyICgpIHsKICAgICAgICByZXR1cm4gdm0uX2RhdGFba2V5XQogICAgICB9LAogICAgICBzZXQ6
IGZ1bmN0aW9uIHByb3h5U2V0dGVyICh2YWwpIHsKICAgICAgICB2bS5fZGF0YVtrZXldID0gdmFs
OwogICAgICB9CiAgICB9KTsKICB9Cn0KCi8qICAqLwoKdmFyIFZOb2RlID0gZnVuY3Rpb24gVk5v
ZGUgKAogIHRhZywKICBkYXRhLAogIGNoaWxkcmVuLAogIHRleHQsCiAgZWxtLAogIGNvbnRleHQs
CiAgY29tcG9uZW50T3B0aW9ucwopIHsKICB0aGlzLnRhZyA9IHRhZzsKICB0aGlzLmRhdGEgPSBk
YXRhOwogIHRoaXMuY2hpbGRyZW4gPSBjaGlsZHJlbjsKICB0aGlzLnRleHQgPSB0ZXh0OwogIHRo
aXMuZWxtID0gZWxtOwogIHRoaXMubnMgPSB1bmRlZmluZWQ7CiAgdGhpcy5jb250ZXh0ID0gY29u
dGV4dDsKICB0aGlzLmZ1bmN0aW9uYWxDb250ZXh0ID0gdW5kZWZpbmVkOwogIHRoaXMua2V5ID0g
ZGF0YSAmJiBkYXRhLmtleTsKICB0aGlzLmNvbXBvbmVudE9wdGlvbnMgPSBjb21wb25lbnRPcHRp
b25zOwogIHRoaXMuY2hpbGQgPSB1bmRlZmluZWQ7CiAgdGhpcy5wYXJlbnQgPSB1bmRlZmluZWQ7
CiAgdGhpcy5yYXcgPSBmYWxzZTsKICB0aGlzLmlzU3RhdGljID0gZmFsc2U7CiAgdGhpcy5pc1Jv
b3RJbnNlcnQgPSB0cnVlOwogIHRoaXMuaXNDb21tZW50ID0gZmFsc2U7CiAgdGhpcy5pc0Nsb25l
ZCA9IGZhbHNlOwogIHRoaXMuaXNPbmNlID0gZmFsc2U7Cn07Cgp2YXIgY3JlYXRlRW1wdHlWTm9k
ZSA9IGZ1bmN0aW9uICgpIHsKICB2YXIgbm9kZSA9IG5ldyBWTm9kZSgpOwogIG5vZGUudGV4dCA9
ICcnOwogIG5vZGUuaXNDb21tZW50ID0gdHJ1ZTsKICByZXR1cm4gbm9kZQp9OwoKZnVuY3Rpb24g
Y3JlYXRlVGV4dFZOb2RlICh2YWwpIHsKICByZXR1cm4gbmV3IFZOb2RlKHVuZGVmaW5lZCwgdW5k
ZWZpbmVkLCB1bmRlZmluZWQsIFN0cmluZyh2YWwpKQp9CgovLyBvcHRpbWl6ZWQgc2hhbGxvdyBj
bG9uZQovLyB1c2VkIGZvciBzdGF0aWMgbm9kZXMgYW5kIHNsb3Qgbm9kZXMgYmVjYXVzZSB0aGV5
IG1heSBiZSByZXVzZWQgYWNyb3NzCi8vIG11bHRpcGxlIHJlbmRlcnMsIGNsb25pbmcgdGhlbSBh
dm9pZHMgZXJyb3JzIHdoZW4gRE9NIG1hbmlwdWxhdGlvbnMgcmVseQovLyBvbiB0aGVpciBlbG0g
cmVmZXJlbmNlLgpmdW5jdGlvbiBjbG9uZVZOb2RlICh2bm9kZSkgewogIHZhciBjbG9uZWQgPSBu
ZXcgVk5vZGUoCiAgICB2bm9kZS50YWcsCiAgICB2bm9kZS5kYXRhLAogICAgdm5vZGUuY2hpbGRy
ZW4sCiAgICB2bm9kZS50ZXh0LAogICAgdm5vZGUuZWxtLAogICAgdm5vZGUuY29udGV4dCwKICAg
IHZub2RlLmNvbXBvbmVudE9wdGlvbnMKICApOwogIGNsb25lZC5ucyA9IHZub2RlLm5zOwogIGNs
b25lZC5pc1N0YXRpYyA9IHZub2RlLmlzU3RhdGljOwogIGNsb25lZC5rZXkgPSB2bm9kZS5rZXk7
CiAgY2xvbmVkLmlzQ2xvbmVkID0gdHJ1ZTsKICByZXR1cm4gY2xvbmVkCn0KCmZ1bmN0aW9uIGNs
b25lVk5vZGVzICh2bm9kZXMpIHsKICB2YXIgcmVzID0gbmV3IEFycmF5KHZub2Rlcy5sZW5ndGgp
OwogIGZvciAodmFyIGkgPSAwOyBpIDwgdm5vZGVzLmxlbmd0aDsgaSsrKSB7CiAgICByZXNbaV0g
PSBjbG9uZVZOb2RlKHZub2Rlc1tpXSk7CiAgfQogIHJldHVybiByZXMKfQoKLyogICovCgp2YXIg
YWN0aXZlSW5zdGFuY2UgPSBudWxsOwoKZnVuY3Rpb24gaW5pdExpZmVjeWNsZSAodm0pIHsKICB2
YXIgb3B0aW9ucyA9IHZtLiRvcHRpb25zOwoKICAvLyBsb2NhdGUgZmlyc3Qgbm9uLWFic3RyYWN0
IHBhcmVudAogIHZhciBwYXJlbnQgPSBvcHRpb25zLnBhcmVudDsKICBpZiAocGFyZW50ICYmICFv
cHRpb25zLmFic3RyYWN0KSB7CiAgICB3aGlsZSAocGFyZW50LiRvcHRpb25zLmFic3RyYWN0ICYm
IHBhcmVudC4kcGFyZW50KSB7CiAgICAgIHBhcmVudCA9IHBhcmVudC4kcGFyZW50OwogICAgfQog
ICAgcGFyZW50LiRjaGlsZHJlbi5wdXNoKHZtKTsKICB9CgogIHZtLiRwYXJlbnQgPSBwYXJlbnQ7
CiAgdm0uJHJvb3QgPSBwYXJlbnQgPyBwYXJlbnQuJHJvb3QgOiB2bTsKCiAgdm0uJGNoaWxkcmVu
ID0gW107CiAgdm0uJHJlZnMgPSB7fTsKCiAgdm0uX3dhdGNoZXIgPSBudWxsOwogIHZtLl9pbmFj
dGl2ZSA9IGZhbHNlOwogIHZtLl9pc01vdW50ZWQgPSBmYWxzZTsKICB2bS5faXNEZXN0cm95ZWQg
PSBmYWxzZTsKICB2bS5faXNCZWluZ0Rlc3Ryb3llZCA9IGZhbHNlOwp9CgpmdW5jdGlvbiBsaWZl
Y3ljbGVNaXhpbiAoVnVlKSB7CiAgVnVlLnByb3RvdHlwZS5fbW91bnQgPSBmdW5jdGlvbiAoCiAg
ICBlbCwKICAgIGh5ZHJhdGluZwogICkgewogICAgdmFyIHZtID0gdGhpczsKICAgIHZtLiRlbCA9
IGVsOwogICAgaWYgKCF2bS4kb3B0aW9ucy5yZW5kZXIpIHsKICAgICAgdm0uJG9wdGlvbnMucmVu
ZGVyID0gY3JlYXRlRW1wdHlWTm9kZTsKICAgICAgewogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9y
ZSBpZiAqLwogICAgICAgIGlmICh2bS4kb3B0aW9ucy50ZW1wbGF0ZSAmJiB2bS4kb3B0aW9ucy50
ZW1wbGF0ZS5jaGFyQXQoMCkgIT09ICcjJykgewogICAgICAgICAgd2FybigKICAgICAgICAgICAg
J1lvdSBhcmUgdXNpbmcgdGhlIHJ1bnRpbWUtb25seSBidWlsZCBvZiBWdWUgd2hlcmUgdGhlIHRl
bXBsYXRlICcgKwogICAgICAgICAgICAnb3B0aW9uIGlzIG5vdCBhdmFpbGFibGUuIEVpdGhlciBw
cmUtY29tcGlsZSB0aGUgdGVtcGxhdGVzIGludG8gJyArCiAgICAgICAgICAgICdyZW5kZXIgZnVu
Y3Rpb25zLCBvciB1c2UgdGhlIGNvbXBpbGVyLWluY2x1ZGVkIGJ1aWxkLicsCiAgICAgICAgICAg
IHZtCiAgICAgICAgICApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3YXJuKAogICAgICAg
ICAgICAnRmFpbGVkIHRvIG1vdW50IGNvbXBvbmVudDogdGVtcGxhdGUgb3IgcmVuZGVyIGZ1bmN0
aW9uIG5vdCBkZWZpbmVkLicsCiAgICAgICAgICAgIHZtCiAgICAgICAgICApOwogICAgICAgIH0K
ICAgICAgfQogICAgfQogICAgY2FsbEhvb2sodm0sICdiZWZvcmVNb3VudCcpOwogICAgdm0uX3dh
dGNoZXIgPSBuZXcgV2F0Y2hlcih2bSwgZnVuY3Rpb24gKCkgewogICAgICB2bS5fdXBkYXRlKHZt
Ll9yZW5kZXIoKSwgaHlkcmF0aW5nKTsKICAgIH0sIG5vb3ApOwogICAgaHlkcmF0aW5nID0gZmFs
c2U7CiAgICAvLyBtYW51YWxseSBtb3VudGVkIGluc3RhbmNlLCBjYWxsIG1vdW50ZWQgb24gc2Vs
ZgogICAgLy8gbW91bnRlZCBpcyBjYWxsZWQgZm9yIHJlbmRlci1jcmVhdGVkIGNoaWxkIGNvbXBv
bmVudHMgaW4gaXRzIGluc2VydGVkIGhvb2sKICAgIGlmICh2bS4kdm5vZGUgPT0gbnVsbCkgewog
ICAgICB2bS5faXNNb3VudGVkID0gdHJ1ZTsKICAgICAgY2FsbEhvb2sodm0sICdtb3VudGVkJyk7
CiAgICB9CiAgICByZXR1cm4gdm0KICB9OwoKICBWdWUucHJvdG90eXBlLl91cGRhdGUgPSBmdW5j
dGlvbiAodm5vZGUsIGh5ZHJhdGluZykgewogICAgdmFyIHZtID0gdGhpczsKICAgIGlmICh2bS5f
aXNNb3VudGVkKSB7CiAgICAgIGNhbGxIb29rKHZtLCAnYmVmb3JlVXBkYXRlJyk7CiAgICB9CiAg
ICB2YXIgcHJldkVsID0gdm0uJGVsOwogICAgdmFyIHByZXZWbm9kZSA9IHZtLl92bm9kZTsKICAg
IHZhciBwcmV2QWN0aXZlSW5zdGFuY2UgPSBhY3RpdmVJbnN0YW5jZTsKICAgIGFjdGl2ZUluc3Rh
bmNlID0gdm07CiAgICB2bS5fdm5vZGUgPSB2bm9kZTsKICAgIC8vIFZ1ZS5wcm90b3R5cGUuX19w
YXRjaF9fIGlzIGluamVjdGVkIGluIGVudHJ5IHBvaW50cwogICAgLy8gYmFzZWQgb24gdGhlIHJl
bmRlcmluZyBiYWNrZW5kIHVzZWQuCiAgICBpZiAoIXByZXZWbm9kZSkgewogICAgICAvLyBpbml0
aWFsIHJlbmRlcgogICAgICB2bS4kZWwgPSB2bS5fX3BhdGNoX18oCiAgICAgICAgdm0uJGVsLCB2
bm9kZSwgaHlkcmF0aW5nLCBmYWxzZSAvKiByZW1vdmVPbmx5ICovLAogICAgICAgIHZtLiRvcHRp
b25zLl9wYXJlbnRFbG0sCiAgICAgICAgdm0uJG9wdGlvbnMuX3JlZkVsbQogICAgICApOwogICAg
fSBlbHNlIHsKICAgICAgLy8gdXBkYXRlcwogICAgICB2bS4kZWwgPSB2bS5fX3BhdGNoX18ocHJl
dlZub2RlLCB2bm9kZSk7CiAgICB9CiAgICBhY3RpdmVJbnN0YW5jZSA9IHByZXZBY3RpdmVJbnN0
YW5jZTsKICAgIC8vIHVwZGF0ZSBfX3Z1ZV9fIHJlZmVyZW5jZQogICAgaWYgKHByZXZFbCkgewog
ICAgICBwcmV2RWwuX192dWVfXyA9IG51bGw7CiAgICB9CiAgICBpZiAodm0uJGVsKSB7CiAgICAg
IHZtLiRlbC5fX3Z1ZV9fID0gdm07CiAgICB9CiAgICAvLyBpZiBwYXJlbnQgaXMgYW4gSE9DLCB1
cGRhdGUgaXRzICRlbCBhcyB3ZWxsCiAgICBpZiAodm0uJHZub2RlICYmIHZtLiRwYXJlbnQgJiYg
dm0uJHZub2RlID09PSB2bS4kcGFyZW50Ll92bm9kZSkgewogICAgICB2bS4kcGFyZW50LiRlbCA9
IHZtLiRlbDsKICAgIH0KICAgIGlmICh2bS5faXNNb3VudGVkKSB7CiAgICAgIGNhbGxIb29rKHZt
LCAndXBkYXRlZCcpOwogICAgfQogIH07CgogIFZ1ZS5wcm90b3R5cGUuX3VwZGF0ZUZyb21QYXJl
bnQgPSBmdW5jdGlvbiAoCiAgICBwcm9wc0RhdGEsCiAgICBsaXN0ZW5lcnMsCiAgICBwYXJlbnRW
bm9kZSwKICAgIHJlbmRlckNoaWxkcmVuCiAgKSB7CiAgICB2YXIgdm0gPSB0aGlzOwogICAgdmFy
IGhhc0NoaWxkcmVuID0gISEodm0uJG9wdGlvbnMuX3JlbmRlckNoaWxkcmVuIHx8IHJlbmRlckNo
aWxkcmVuKTsKICAgIHZtLiRvcHRpb25zLl9wYXJlbnRWbm9kZSA9IHBhcmVudFZub2RlOwogICAg
dm0uJHZub2RlID0gcGFyZW50Vm5vZGU7IC8vIHVwZGF0ZSB2bSdzIHBsYWNlaG9sZGVyIG5vZGUg
d2l0aG91dCByZS1yZW5kZXIKICAgIGlmICh2bS5fdm5vZGUpIHsgLy8gdXBkYXRlIGNoaWxkIHRy
ZWUncyBwYXJlbnQKICAgICAgdm0uX3Zub2RlLnBhcmVudCA9IHBhcmVudFZub2RlOwogICAgfQog
ICAgdm0uJG9wdGlvbnMuX3JlbmRlckNoaWxkcmVuID0gcmVuZGVyQ2hpbGRyZW47CiAgICAvLyB1
cGRhdGUgcHJvcHMKICAgIGlmIChwcm9wc0RhdGEgJiYgdm0uJG9wdGlvbnMucHJvcHMpIHsKICAg
ICAgb2JzZXJ2ZXJTdGF0ZS5zaG91bGRDb252ZXJ0ID0gZmFsc2U7CiAgICAgIHsKICAgICAgICBv
YnNlcnZlclN0YXRlLmlzU2V0dGluZ1Byb3BzID0gdHJ1ZTsKICAgICAgfQogICAgICB2YXIgcHJv
cEtleXMgPSB2bS4kb3B0aW9ucy5fcHJvcEtleXMgfHwgW107CiAgICAgIGZvciAodmFyIGkgPSAw
OyBpIDwgcHJvcEtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIga2V5ID0gcHJvcEtleXNb
aV07CiAgICAgICAgdm1ba2V5XSA9IHZhbGlkYXRlUHJvcChrZXksIHZtLiRvcHRpb25zLnByb3Bz
LCBwcm9wc0RhdGEsIHZtKTsKICAgICAgfQogICAgICBvYnNlcnZlclN0YXRlLnNob3VsZENvbnZl
cnQgPSB0cnVlOwogICAgICB7CiAgICAgICAgb2JzZXJ2ZXJTdGF0ZS5pc1NldHRpbmdQcm9wcyA9
IGZhbHNlOwogICAgICB9CiAgICAgIHZtLiRvcHRpb25zLnByb3BzRGF0YSA9IHByb3BzRGF0YTsK
ICAgIH0KICAgIC8vIHVwZGF0ZSBsaXN0ZW5lcnMKICAgIGlmIChsaXN0ZW5lcnMpIHsKICAgICAg
dmFyIG9sZExpc3RlbmVycyA9IHZtLiRvcHRpb25zLl9wYXJlbnRMaXN0ZW5lcnM7CiAgICAgIHZt
LiRvcHRpb25zLl9wYXJlbnRMaXN0ZW5lcnMgPSBsaXN0ZW5lcnM7CiAgICAgIHZtLl91cGRhdGVM
aXN0ZW5lcnMobGlzdGVuZXJzLCBvbGRMaXN0ZW5lcnMpOwogICAgfQogICAgLy8gcmVzb2x2ZSBz
bG90cyArIGZvcmNlIHVwZGF0ZSBpZiBoYXMgY2hpbGRyZW4KICAgIGlmIChoYXNDaGlsZHJlbikg
ewogICAgICB2bS4kc2xvdHMgPSByZXNvbHZlU2xvdHMocmVuZGVyQ2hpbGRyZW4sIHBhcmVudFZu
b2RlLmNvbnRleHQpOwogICAgICB2bS4kZm9yY2VVcGRhdGUoKTsKICAgIH0KICB9OwoKICBWdWUu
cHJvdG90eXBlLiRmb3JjZVVwZGF0ZSA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB2bSA9IHRoaXM7
CiAgICBpZiAodm0uX3dhdGNoZXIpIHsKICAgICAgdm0uX3dhdGNoZXIudXBkYXRlKCk7CiAgICB9
CiAgfTsKCiAgVnVlLnByb3RvdHlwZS4kZGVzdHJveSA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB2
bSA9IHRoaXM7CiAgICBpZiAodm0uX2lzQmVpbmdEZXN0cm95ZWQpIHsKICAgICAgcmV0dXJuCiAg
ICB9CiAgICBjYWxsSG9vayh2bSwgJ2JlZm9yZURlc3Ryb3knKTsKICAgIHZtLl9pc0JlaW5nRGVz
dHJveWVkID0gdHJ1ZTsKICAgIC8vIHJlbW92ZSBzZWxmIGZyb20gcGFyZW50CiAgICB2YXIgcGFy
ZW50ID0gdm0uJHBhcmVudDsKICAgIGlmIChwYXJlbnQgJiYgIXBhcmVudC5faXNCZWluZ0Rlc3Ry
b3llZCAmJiAhdm0uJG9wdGlvbnMuYWJzdHJhY3QpIHsKICAgICAgcmVtb3ZlJDEocGFyZW50LiRj
aGlsZHJlbiwgdm0pOwogICAgfQogICAgLy8gdGVhcmRvd24gd2F0Y2hlcnMKICAgIGlmICh2bS5f
d2F0Y2hlcikgewogICAgICB2bS5fd2F0Y2hlci50ZWFyZG93bigpOwogICAgfQogICAgdmFyIGkg
PSB2bS5fd2F0Y2hlcnMubGVuZ3RoOwogICAgd2hpbGUgKGktLSkgewogICAgICB2bS5fd2F0Y2hl
cnNbaV0udGVhcmRvd24oKTsKICAgIH0KICAgIC8vIHJlbW92ZSByZWZlcmVuY2UgZnJvbSBkYXRh
IG9iCiAgICAvLyBmcm96ZW4gb2JqZWN0IG1heSBub3QgaGF2ZSBvYnNlcnZlci4KICAgIGlmICh2
bS5fZGF0YS5fX29iX18pIHsKICAgICAgdm0uX2RhdGEuX19vYl9fLnZtQ291bnQtLTsKICAgIH0K
ICAgIC8vIGNhbGwgdGhlIGxhc3QgaG9vay4uLgogICAgdm0uX2lzRGVzdHJveWVkID0gdHJ1ZTsK
ICAgIGNhbGxIb29rKHZtLCAnZGVzdHJveWVkJyk7CiAgICAvLyB0dXJuIG9mZiBhbGwgaW5zdGFu
Y2UgbGlzdGVuZXJzLgogICAgdm0uJG9mZigpOwogICAgLy8gcmVtb3ZlIF9fdnVlX18gcmVmZXJl
bmNlCiAgICBpZiAodm0uJGVsKSB7CiAgICAgIHZtLiRlbC5fX3Z1ZV9fID0gbnVsbDsKICAgIH0K
ICAgIC8vIGludm9rZSBkZXN0cm95IGhvb2tzIG9uIGN1cnJlbnQgcmVuZGVyZWQgdHJlZQogICAg
dm0uX19wYXRjaF9fKHZtLl92bm9kZSwgbnVsbCk7CiAgfTsKfQoKZnVuY3Rpb24gY2FsbEhvb2sg
KHZtLCBob29rKSB7CiAgdmFyIGhhbmRsZXJzID0gdm0uJG9wdGlvbnNbaG9va107CiAgaWYgKGhh
bmRsZXJzKSB7CiAgICBmb3IgKHZhciBpID0gMCwgaiA9IGhhbmRsZXJzLmxlbmd0aDsgaSA8IGo7
IGkrKykgewogICAgICBoYW5kbGVyc1tpXS5jYWxsKHZtKTsKICAgIH0KICB9CiAgdm0uJGVtaXQo
J2hvb2s6JyArIGhvb2spOwp9CgovKiAgKi8KCnZhciBob29rcyA9IHsgaW5pdDogaW5pdCwgcHJl
cGF0Y2g6IHByZXBhdGNoLCBpbnNlcnQ6IGluc2VydCwgZGVzdHJveTogZGVzdHJveSQxIH07CnZh
ciBob29rc1RvTWVyZ2UgPSBPYmplY3Qua2V5cyhob29rcyk7CgpmdW5jdGlvbiBjcmVhdGVDb21w
b25lbnQgKAogIEN0b3IsCiAgZGF0YSwKICBjb250ZXh0LAogIGNoaWxkcmVuLAogIHRhZwopIHsK
ICBpZiAoIUN0b3IpIHsKICAgIHJldHVybgogIH0KCiAgdmFyIGJhc2VDdG9yID0gY29udGV4dC4k
b3B0aW9ucy5fYmFzZTsKICBpZiAoaXNPYmplY3QoQ3RvcikpIHsKICAgIEN0b3IgPSBiYXNlQ3Rv
ci5leHRlbmQoQ3Rvcik7CiAgfQoKICBpZiAodHlwZW9mIEN0b3IgIT09ICdmdW5jdGlvbicpIHsK
ICAgIHsKICAgICAgd2FybigoIkludmFsaWQgQ29tcG9uZW50IGRlZmluaXRpb246ICIgKyAoU3Ry
aW5nKEN0b3IpKSksIGNvbnRleHQpOwogICAgfQogICAgcmV0dXJuCiAgfQoKICAvLyBhc3luYyBj
b21wb25lbnQKICBpZiAoIUN0b3IuY2lkKSB7CiAgICBpZiAoQ3Rvci5yZXNvbHZlZCkgewogICAg
ICBDdG9yID0gQ3Rvci5yZXNvbHZlZDsKICAgIH0gZWxzZSB7CiAgICAgIEN0b3IgPSByZXNvbHZl
QXN5bmNDb21wb25lbnQoQ3RvciwgYmFzZUN0b3IsIGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBp
dCdzIG9rIHRvIHF1ZXVlIHRoaXMgb24gZXZlcnkgcmVuZGVyIGJlY2F1c2UKICAgICAgICAvLyAk
Zm9yY2VVcGRhdGUgaXMgYnVmZmVyZWQgYnkgdGhlIHNjaGVkdWxlci4KICAgICAgICBjb250ZXh0
LiRmb3JjZVVwZGF0ZSgpOwogICAgICB9KTsKICAgICAgaWYgKCFDdG9yKSB7CiAgICAgICAgLy8g
cmV0dXJuIG5vdGhpbmcgaWYgdGhpcyBpcyBpbmRlZWQgYW4gYXN5bmMgY29tcG9uZW50CiAgICAg
ICAgLy8gd2FpdCBmb3IgdGhlIGNhbGxiYWNrIHRvIHRyaWdnZXIgcGFyZW50IHVwZGF0ZS4KICAg
ICAgICByZXR1cm4KICAgICAgfQogICAgfQogIH0KCiAgLy8gcmVzb2x2ZSBjb25zdHJ1Y3RvciBv
cHRpb25zIGluIGNhc2UgZ2xvYmFsIG1peGlucyBhcmUgYXBwbGllZCBhZnRlcgogIC8vIGNvbXBv
bmVudCBjb25zdHJ1Y3RvciBjcmVhdGlvbgogIHJlc29sdmVDb25zdHJ1Y3Rvck9wdGlvbnMoQ3Rv
cik7CgogIGRhdGEgPSBkYXRhIHx8IHt9OwoKICAvLyBleHRyYWN0IHByb3BzCiAgdmFyIHByb3Bz
RGF0YSA9IGV4dHJhY3RQcm9wcyhkYXRhLCBDdG9yKTsKCiAgLy8gZnVuY3Rpb25hbCBjb21wb25l
bnQKICBpZiAoQ3Rvci5vcHRpb25zLmZ1bmN0aW9uYWwpIHsKICAgIHJldHVybiBjcmVhdGVGdW5j
dGlvbmFsQ29tcG9uZW50KEN0b3IsIHByb3BzRGF0YSwgZGF0YSwgY29udGV4dCwgY2hpbGRyZW4p
CiAgfQoKICAvLyBleHRyYWN0IGxpc3RlbmVycywgc2luY2UgdGhlc2UgbmVlZHMgdG8gYmUgdHJl
YXRlZCBhcwogIC8vIGNoaWxkIGNvbXBvbmVudCBsaXN0ZW5lcnMgaW5zdGVhZCBvZiBET00gbGlz
dGVuZXJzCiAgdmFyIGxpc3RlbmVycyA9IGRhdGEub247CiAgLy8gcmVwbGFjZSB3aXRoIGxpc3Rl
bmVycyB3aXRoIC5uYXRpdmUgbW9kaWZpZXIKICBkYXRhLm9uID0gZGF0YS5uYXRpdmVPbjsKCiAg
aWYgKEN0b3Iub3B0aW9ucy5hYnN0cmFjdCkgewogICAgLy8gYWJzdHJhY3QgY29tcG9uZW50cyBk
byBub3Qga2VlcCBhbnl0aGluZwogICAgLy8gb3RoZXIgdGhhbiBwcm9wcyAmIGxpc3RlbmVycwog
ICAgZGF0YSA9IHt9OwogIH0KCiAgLy8gbWVyZ2UgY29tcG9uZW50IG1hbmFnZW1lbnQgaG9va3Mg
b250byB0aGUgcGxhY2Vob2xkZXIgbm9kZQogIG1lcmdlSG9va3MoZGF0YSk7CgogIC8vIHJldHVy
biBhIHBsYWNlaG9sZGVyIHZub2RlCiAgdmFyIG5hbWUgPSBDdG9yLm9wdGlvbnMubmFtZSB8fCB0
YWc7CiAgdmFyIHZub2RlID0gbmV3IFZOb2RlKAogICAgKCJ2dWUtY29tcG9uZW50LSIgKyAoQ3Rv
ci5jaWQpICsgKG5hbWUgPyAoIi0iICsgbmFtZSkgOiAnJykpLAogICAgZGF0YSwgdW5kZWZpbmVk
LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29udGV4dCwKICAgIHsgQ3RvcjogQ3RvciwgcHJvcHNE
YXRhOiBwcm9wc0RhdGEsIGxpc3RlbmVyczogbGlzdGVuZXJzLCB0YWc6IHRhZywgY2hpbGRyZW46
IGNoaWxkcmVuIH0KICApOwogIHJldHVybiB2bm9kZQp9CgpmdW5jdGlvbiBjcmVhdGVGdW5jdGlv
bmFsQ29tcG9uZW50ICgKICBDdG9yLAogIHByb3BzRGF0YSwKICBkYXRhLAogIGNvbnRleHQsCiAg
Y2hpbGRyZW4KKSB7CiAgdmFyIHByb3BzID0ge307CiAgdmFyIHByb3BPcHRpb25zID0gQ3Rvci5v
cHRpb25zLnByb3BzOwogIGlmIChwcm9wT3B0aW9ucykgewogICAgZm9yICh2YXIga2V5IGluIHBy
b3BPcHRpb25zKSB7CiAgICAgIHByb3BzW2tleV0gPSB2YWxpZGF0ZVByb3Aoa2V5LCBwcm9wT3B0
aW9ucywgcHJvcHNEYXRhKTsKICAgIH0KICB9CiAgLy8gZW5zdXJlIHRoZSBjcmVhdGVFbGVtZW50
IGZ1bmN0aW9uIGluIGZ1bmN0aW9uYWwgY29tcG9uZW50cwogIC8vIGdldHMgYSB1bmlxdWUgY29u
dGV4dCAtIHRoaXMgaXMgbmVjZXNzYXJ5IGZvciBjb3JyZWN0IG5hbWVkIHNsb3QgY2hlY2sKICB2
YXIgX2NvbnRleHQgPSBPYmplY3QuY3JlYXRlKGNvbnRleHQpOwogIHZhciBoID0gZnVuY3Rpb24g
KGEsIGIsIGMsIGQpIHsgcmV0dXJuIGNyZWF0ZUVsZW1lbnQoX2NvbnRleHQsIGEsIGIsIGMsIGQs
IHRydWUpOyB9OwogIHZhciB2bm9kZSA9IEN0b3Iub3B0aW9ucy5yZW5kZXIuY2FsbChudWxsLCBo
LCB7CiAgICBwcm9wczogcHJvcHMsCiAgICBkYXRhOiBkYXRhLAogICAgcGFyZW50OiBjb250ZXh0
LAogICAgY2hpbGRyZW46IGNoaWxkcmVuLAogICAgc2xvdHM6IGZ1bmN0aW9uICgpIHsgcmV0dXJu
IHJlc29sdmVTbG90cyhjaGlsZHJlbiwgY29udGV4dCk7IH0KICB9KTsKICBpZiAodm5vZGUgaW5z
dGFuY2VvZiBWTm9kZSkgewogICAgdm5vZGUuZnVuY3Rpb25hbENvbnRleHQgPSBjb250ZXh0Owog
ICAgaWYgKGRhdGEuc2xvdCkgewogICAgICAodm5vZGUuZGF0YSB8fCAodm5vZGUuZGF0YSA9IHt9
KSkuc2xvdCA9IGRhdGEuc2xvdDsKICAgIH0KICB9CiAgcmV0dXJuIHZub2RlCn0KCmZ1bmN0aW9u
IGNyZWF0ZUNvbXBvbmVudEluc3RhbmNlRm9yVm5vZGUgKAogIHZub2RlLCAvLyB3ZSBrbm93IGl0
J3MgTW91bnRlZENvbXBvbmVudFZOb2RlIGJ1dCBmbG93IGRvZXNuJ3QKICBwYXJlbnQsIC8vIGFj
dGl2ZUluc3RhbmNlIGluIGxpZmVjeWNsZSBzdGF0ZQogIHBhcmVudEVsbSwKICByZWZFbG0KKSB7
CiAgdmFyIHZub2RlQ29tcG9uZW50T3B0aW9ucyA9IHZub2RlLmNvbXBvbmVudE9wdGlvbnM7CiAg
dmFyIG9wdGlvbnMgPSB7CiAgICBfaXNDb21wb25lbnQ6IHRydWUsCiAgICBwYXJlbnQ6IHBhcmVu
dCwKICAgIHByb3BzRGF0YTogdm5vZGVDb21wb25lbnRPcHRpb25zLnByb3BzRGF0YSwKICAgIF9j
b21wb25lbnRUYWc6IHZub2RlQ29tcG9uZW50T3B0aW9ucy50YWcsCiAgICBfcGFyZW50Vm5vZGU6
IHZub2RlLAogICAgX3BhcmVudExpc3RlbmVyczogdm5vZGVDb21wb25lbnRPcHRpb25zLmxpc3Rl
bmVycywKICAgIF9yZW5kZXJDaGlsZHJlbjogdm5vZGVDb21wb25lbnRPcHRpb25zLmNoaWxkcmVu
LAogICAgX3BhcmVudEVsbTogcGFyZW50RWxtIHx8IG51bGwsCiAgICBfcmVmRWxtOiByZWZFbG0g
fHwgbnVsbAogIH07CiAgLy8gY2hlY2sgaW5saW5lLXRlbXBsYXRlIHJlbmRlciBmdW5jdGlvbnMK
ICB2YXIgaW5saW5lVGVtcGxhdGUgPSB2bm9kZS5kYXRhLmlubGluZVRlbXBsYXRlOwogIGlmIChp
bmxpbmVUZW1wbGF0ZSkgewogICAgb3B0aW9ucy5yZW5kZXIgPSBpbmxpbmVUZW1wbGF0ZS5yZW5k
ZXI7CiAgICBvcHRpb25zLnN0YXRpY1JlbmRlckZucyA9IGlubGluZVRlbXBsYXRlLnN0YXRpY1Jl
bmRlckZuczsKICB9CiAgcmV0dXJuIG5ldyB2bm9kZUNvbXBvbmVudE9wdGlvbnMuQ3RvcihvcHRp
b25zKQp9CgpmdW5jdGlvbiBpbml0ICgKICB2bm9kZSwKICBoeWRyYXRpbmcsCiAgcGFyZW50RWxt
LAogIHJlZkVsbQopIHsKICBpZiAoIXZub2RlLmNoaWxkIHx8IHZub2RlLmNoaWxkLl9pc0Rlc3Ry
b3llZCkgewogICAgdmFyIGNoaWxkID0gdm5vZGUuY2hpbGQgPSBjcmVhdGVDb21wb25lbnRJbnN0
YW5jZUZvclZub2RlKAogICAgICB2bm9kZSwKICAgICAgYWN0aXZlSW5zdGFuY2UsCiAgICAgIHBh
cmVudEVsbSwKICAgICAgcmVmRWxtCiAgICApOwogICAgY2hpbGQuJG1vdW50KGh5ZHJhdGluZyA/
IHZub2RlLmVsbSA6IHVuZGVmaW5lZCwgaHlkcmF0aW5nKTsKICB9IGVsc2UgaWYgKHZub2RlLmRh
dGEua2VlcEFsaXZlKSB7CiAgICAvLyBrZXB0LWFsaXZlIGNvbXBvbmVudHMsIHRyZWF0IGFzIGEg
cGF0Y2gKICAgIHZhciBtb3VudGVkTm9kZSA9IHZub2RlOyAvLyB3b3JrIGFyb3VuZCBmbG93CiAg
ICBwcmVwYXRjaChtb3VudGVkTm9kZSwgbW91bnRlZE5vZGUpOwogIH0KfQoKZnVuY3Rpb24gcHJl
cGF0Y2ggKAogIG9sZFZub2RlLAogIHZub2RlCikgewogIHZhciBvcHRpb25zID0gdm5vZGUuY29t
cG9uZW50T3B0aW9uczsKICB2YXIgY2hpbGQgPSB2bm9kZS5jaGlsZCA9IG9sZFZub2RlLmNoaWxk
OwogIGNoaWxkLl91cGRhdGVGcm9tUGFyZW50KAogICAgb3B0aW9ucy5wcm9wc0RhdGEsIC8vIHVw
ZGF0ZWQgcHJvcHMKICAgIG9wdGlvbnMubGlzdGVuZXJzLCAvLyB1cGRhdGVkIGxpc3RlbmVycwog
ICAgdm5vZGUsIC8vIG5ldyBwYXJlbnQgdm5vZGUKICAgIG9wdGlvbnMuY2hpbGRyZW4gLy8gbmV3
IGNoaWxkcmVuCiAgKTsKfQoKZnVuY3Rpb24gaW5zZXJ0ICh2bm9kZSkgewogIGlmICghdm5vZGUu
Y2hpbGQuX2lzTW91bnRlZCkgewogICAgdm5vZGUuY2hpbGQuX2lzTW91bnRlZCA9IHRydWU7CiAg
ICBjYWxsSG9vayh2bm9kZS5jaGlsZCwgJ21vdW50ZWQnKTsKICB9CiAgaWYgKHZub2RlLmRhdGEu
a2VlcEFsaXZlKSB7CiAgICB2bm9kZS5jaGlsZC5faW5hY3RpdmUgPSBmYWxzZTsKICAgIGNhbGxI
b29rKHZub2RlLmNoaWxkLCAnYWN0aXZhdGVkJyk7CiAgfQp9CgpmdW5jdGlvbiBkZXN0cm95JDEg
KHZub2RlKSB7CiAgaWYgKCF2bm9kZS5jaGlsZC5faXNEZXN0cm95ZWQpIHsKICAgIGlmICghdm5v
ZGUuZGF0YS5rZWVwQWxpdmUpIHsKICAgICAgdm5vZGUuY2hpbGQuJGRlc3Ryb3koKTsKICAgIH0g
ZWxzZSB7CiAgICAgIHZub2RlLmNoaWxkLl9pbmFjdGl2ZSA9IHRydWU7CiAgICAgIGNhbGxIb29r
KHZub2RlLmNoaWxkLCAnZGVhY3RpdmF0ZWQnKTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHJlc29s
dmVBc3luY0NvbXBvbmVudCAoCiAgZmFjdG9yeSwKICBiYXNlQ3RvciwKICBjYgopIHsKICBpZiAo
ZmFjdG9yeS5yZXF1ZXN0ZWQpIHsKICAgIC8vIHBvb2wgY2FsbGJhY2tzCiAgICBmYWN0b3J5LnBl
bmRpbmdDYWxsYmFja3MucHVzaChjYik7CiAgfSBlbHNlIHsKICAgIGZhY3RvcnkucmVxdWVzdGVk
ID0gdHJ1ZTsKICAgIHZhciBjYnMgPSBmYWN0b3J5LnBlbmRpbmdDYWxsYmFja3MgPSBbY2JdOwog
ICAgdmFyIHN5bmMgPSB0cnVlOwoKICAgIHZhciByZXNvbHZlID0gZnVuY3Rpb24gKHJlcykgewog
ICAgICBpZiAoaXNPYmplY3QocmVzKSkgewogICAgICAgIHJlcyA9IGJhc2VDdG9yLmV4dGVuZChy
ZXMpOwogICAgICB9CiAgICAgIC8vIGNhY2hlIHJlc29sdmVkCiAgICAgIGZhY3RvcnkucmVzb2x2
ZWQgPSByZXM7CiAgICAgIC8vIGludm9rZSBjYWxsYmFja3Mgb25seSBpZiB0aGlzIGlzIG5vdCBh
IHN5bmNocm9ub3VzIHJlc29sdmUKICAgICAgLy8gKGFzeW5jIHJlc29sdmVzIGFyZSBzaGltbWVk
IGFzIHN5bmNocm9ub3VzIGR1cmluZyBTU1IpCiAgICAgIGlmICghc3luYykgewogICAgICAgIGZv
ciAodmFyIGkgPSAwLCBsID0gY2JzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgY2Jz
W2ldKHJlcyk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHZhciByZWplY3QgPSBmdW5j
dGlvbiAocmVhc29uKSB7CiAgICAgICJkZXZlbG9wbWVudCIgIT09ICdwcm9kdWN0aW9uJyAmJiB3
YXJuKAogICAgICAgICJGYWlsZWQgdG8gcmVzb2x2ZSBhc3luYyBjb21wb25lbnQ6ICIgKyAoU3Ry
aW5nKGZhY3RvcnkpKSArCiAgICAgICAgKHJlYXNvbiA/ICgiXG5SZWFzb246ICIgKyByZWFzb24p
IDogJycpCiAgICAgICk7CiAgICB9OwoKICAgIHZhciByZXMgPSBmYWN0b3J5KHJlc29sdmUsIHJl
amVjdCk7CgogICAgLy8gaGFuZGxlIHByb21pc2UKICAgIGlmIChyZXMgJiYgdHlwZW9mIHJlcy50
aGVuID09PSAnZnVuY3Rpb24nICYmICFmYWN0b3J5LnJlc29sdmVkKSB7CiAgICAgIHJlcy50aGVu
KHJlc29sdmUsIHJlamVjdCk7CiAgICB9CgogICAgc3luYyA9IGZhbHNlOwogICAgLy8gcmV0dXJu
IGluIGNhc2UgcmVzb2x2ZWQgc3luY2hyb25vdXNseQogICAgcmV0dXJuIGZhY3RvcnkucmVzb2x2
ZWQKICB9Cn0KCmZ1bmN0aW9uIGV4dHJhY3RQcm9wcyAoZGF0YSwgQ3RvcikgewogIC8vIHdlIGFy
ZSBvbmx5IGV4dHJhY3RpbmcgcmF3IHZhbHVlcyBoZXJlLgogIC8vIHZhbGlkYXRpb24gYW5kIGRl
ZmF1bHQgdmFsdWVzIGFyZSBoYW5kbGVkIGluIHRoZSBjaGlsZAogIC8vIGNvbXBvbmVudCBpdHNl
bGYuCiAgdmFyIHByb3BPcHRpb25zID0gQ3Rvci5vcHRpb25zLnByb3BzOwogIGlmICghcHJvcE9w
dGlvbnMpIHsKICAgIHJldHVybgogIH0KICB2YXIgcmVzID0ge307CiAgdmFyIGF0dHJzID0gZGF0
YS5hdHRyczsKICB2YXIgcHJvcHMgPSBkYXRhLnByb3BzOwogIHZhciBkb21Qcm9wcyA9IGRhdGEu
ZG9tUHJvcHM7CiAgaWYgKGF0dHJzIHx8IHByb3BzIHx8IGRvbVByb3BzKSB7CiAgICBmb3IgKHZh
ciBrZXkgaW4gcHJvcE9wdGlvbnMpIHsKICAgICAgdmFyIGFsdEtleSA9IGh5cGhlbmF0ZShrZXkp
OwogICAgICBjaGVja1Byb3AocmVzLCBwcm9wcywga2V5LCBhbHRLZXksIHRydWUpIHx8CiAgICAg
IGNoZWNrUHJvcChyZXMsIGF0dHJzLCBrZXksIGFsdEtleSkgfHwKICAgICAgY2hlY2tQcm9wKHJl
cywgZG9tUHJvcHMsIGtleSwgYWx0S2V5KTsKICAgIH0KICB9CiAgcmV0dXJuIHJlcwp9CgpmdW5j
dGlvbiBjaGVja1Byb3AgKAogIHJlcywKICBoYXNoLAogIGtleSwKICBhbHRLZXksCiAgcHJlc2Vy
dmUKKSB7CiAgaWYgKGhhc2gpIHsKICAgIGlmIChoYXNPd24oaGFzaCwga2V5KSkgewogICAgICBy
ZXNba2V5XSA9IGhhc2hba2V5XTsKICAgICAgaWYgKCFwcmVzZXJ2ZSkgewogICAgICAgIGRlbGV0
ZSBoYXNoW2tleV07CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWUKICAgIH0gZWxzZSBpZiAoaGFz
T3duKGhhc2gsIGFsdEtleSkpIHsKICAgICAgcmVzW2tleV0gPSBoYXNoW2FsdEtleV07CiAgICAg
IGlmICghcHJlc2VydmUpIHsKICAgICAgICBkZWxldGUgaGFzaFthbHRLZXldOwogICAgICB9CiAg
ICAgIHJldHVybiB0cnVlCiAgICB9CiAgfQogIHJldHVybiBmYWxzZQp9CgpmdW5jdGlvbiBtZXJn
ZUhvb2tzIChkYXRhKSB7CiAgaWYgKCFkYXRhLmhvb2spIHsKICAgIGRhdGEuaG9vayA9IHt9Owog
IH0KICBmb3IgKHZhciBpID0gMDsgaSA8IGhvb2tzVG9NZXJnZS5sZW5ndGg7IGkrKykgewogICAg
dmFyIGtleSA9IGhvb2tzVG9NZXJnZVtpXTsKICAgIHZhciBmcm9tUGFyZW50ID0gZGF0YS5ob29r
W2tleV07CiAgICB2YXIgb3VycyA9IGhvb2tzW2tleV07CiAgICBkYXRhLmhvb2tba2V5XSA9IGZy
b21QYXJlbnQgPyBtZXJnZUhvb2skMShvdXJzLCBmcm9tUGFyZW50KSA6IG91cnM7CiAgfQp9Cgpm
dW5jdGlvbiBtZXJnZUhvb2skMSAob25lLCB0d28pIHsKICByZXR1cm4gZnVuY3Rpb24gKGEsIGIs
IGMsIGQpIHsKICAgIG9uZShhLCBiLCBjLCBkKTsKICAgIHR3byhhLCBiLCBjLCBkKTsKICB9Cn0K
Ci8qICAqLwoKZnVuY3Rpb24gbWVyZ2VWTm9kZUhvb2sgKGRlZiwgaG9va0tleSwgaG9vaywga2V5
KSB7CiAga2V5ID0ga2V5ICsgaG9va0tleTsKICB2YXIgaW5qZWN0ZWRIYXNoID0gZGVmLl9faW5q
ZWN0ZWQgfHwgKGRlZi5fX2luamVjdGVkID0ge30pOwogIGlmICghaW5qZWN0ZWRIYXNoW2tleV0p
IHsKICAgIGluamVjdGVkSGFzaFtrZXldID0gdHJ1ZTsKICAgIHZhciBvbGRIb29rID0gZGVmW2hv
b2tLZXldOwogICAgaWYgKG9sZEhvb2spIHsKICAgICAgZGVmW2hvb2tLZXldID0gZnVuY3Rpb24g
KCkgewogICAgICAgIG9sZEhvb2suYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICBob29r
LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICBkZWZb
aG9va0tleV0gPSBob29rOwogICAgfQogIH0KfQoKLyogICovCgpmdW5jdGlvbiB1cGRhdGVMaXN0
ZW5lcnMgKAogIG9uLAogIG9sZE9uLAogIGFkZCwKICByZW1vdmUkJDEsCiAgdm0KKSB7CiAgdmFy
IG5hbWUsIGN1ciwgb2xkLCBmbiwgZXZlbnQsIGNhcHR1cmUsIG9uY2U7CiAgZm9yIChuYW1lIGlu
IG9uKSB7CiAgICBjdXIgPSBvbltuYW1lXTsKICAgIG9sZCA9IG9sZE9uW25hbWVdOwogICAgaWYg
KCFjdXIpIHsKICAgICAgImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oCiAg
ICAgICAgIkludmFsaWQgaGFuZGxlciBmb3IgZXZlbnQgXCIiICsgbmFtZSArICJcIjogZ290ICIg
KyBTdHJpbmcoY3VyKSwKICAgICAgICA=</Default>
</Parameter>

<Parameter name="Frag916644214336259390010677">
<Default>IHsKICByZXR1cm4gKAogICAgdm5vZGUxLmtleSA9PT0gdm5vZGUyLmtleSAmJgogICAgdm5vZGUx
LnRhZyA9PT0gdm5vZGUyLnRhZyAmJgogICAgdm5vZGUxLmlzQ29tbWVudCA9PT0gdm5vZGUyLmlz
Q29tbWVudCAmJgogICAgIXZub2RlMS5kYXRhID09PSAhdm5vZGUyLmRhdGEKICApCn0KCmZ1bmN0
aW9uIGNyZWF0ZUtleVRvT2xkSWR4IChjaGlsZHJlbiwgYmVnaW5JZHgsIGVuZElkeCkgewogIHZh
ciBpLCBrZXk7CiAgdmFyIG1hcCA9IHt9OwogIGZvciAoaSA9IGJlZ2luSWR4OyBpIDw9IGVuZElk
eDsgKytpKSB7CiAgICBrZXkgPSBjaGlsZHJlbltpXS5rZXk7CiAgICBpZiAoaXNEZWYoa2V5KSkg
eyBtYXBba2V5XSA9IGk7IH0KICB9CiAgcmV0dXJuIG1hcAp9CgpmdW5jdGlvbiBjcmVhdGVQYXRj
aEZ1bmN0aW9uIChiYWNrZW5kKSB7CiAgdmFyIGksIGo7CiAgdmFyIGNicyA9IHt9OwoKICB2YXIg
bW9kdWxlcyA9IGJhY2tlbmQubW9kdWxlczsKICB2YXIgbm9kZU9wcyA9IGJhY2tlbmQubm9kZU9w
czsKCiAgZm9yIChpID0gMDsgaSA8IGhvb2tzJDEubGVuZ3RoOyArK2kpIHsKICAgIGNic1tob29r
cyQxW2ldXSA9IFtdOwogICAgZm9yIChqID0gMDsgaiA8IG1vZHVsZXMubGVuZ3RoOyArK2opIHsK
ICAgICAgaWYgKG1vZHVsZXNbal1baG9va3MkMVtpXV0gIT09IHVuZGVmaW5lZCkgeyBjYnNbaG9v
a3MkMVtpXV0ucHVzaChtb2R1bGVzW2pdW2hvb2tzJDFbaV1dKTsgfQogICAgfQogIH0KCiAgZnVu
Y3Rpb24gZW1wdHlOb2RlQXQgKGVsbSkgewogICAgcmV0dXJuIG5ldyBWTm9kZShub2RlT3BzLnRh
Z05hbWUoZWxtKS50b0xvd2VyQ2FzZSgpLCB7fSwgW10sIHVuZGVmaW5lZCwgZWxtKQogIH0KCiAg
ZnVuY3Rpb24gY3JlYXRlUm1DYiAoY2hpbGRFbG0sIGxpc3RlbmVycykgewogICAgZnVuY3Rpb24g
cmVtb3ZlJCQxICgpIHsKICAgICAgaWYgKC0tcmVtb3ZlJCQxLmxpc3RlbmVycyA9PT0gMCkgewog
ICAgICAgIHJlbW92ZUVsZW1lbnQoY2hpbGRFbG0pOwogICAgICB9CiAgICB9CiAgICByZW1vdmUk
JDEubGlzdGVuZXJzID0gbGlzdGVuZXJzOwogICAgcmV0dXJuIHJlbW92ZSQkMQogIH0KCiAgZnVu
Y3Rpb24gcmVtb3ZlRWxlbWVudCAoZWwpIHsKICAgIHZhciBwYXJlbnQgPSBub2RlT3BzLnBhcmVu
dE5vZGUoZWwpOwogICAgLy8gZWxlbWVudCBtYXkgaGF2ZSBhbHJlYWR5IGJlZW4gcmVtb3ZlZCBk
dWUgdG8gdi1odG1sCiAgICBpZiAocGFyZW50KSB7CiAgICAgIG5vZGVPcHMucmVtb3ZlQ2hpbGQo
cGFyZW50LCBlbCk7CiAgICB9CiAgfQoKICB2YXIgaW5QcmUgPSAwOwogIGZ1bmN0aW9uIGNyZWF0
ZUVsbSAodm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgcGFyZW50RWxtLCByZWZFbG0sIG5lc3Rl
ZCkgewogICAgdm5vZGUuaXNSb290SW5zZXJ0ID0gIW5lc3RlZDsgLy8gZm9yIHRyYW5zaXRpb24g
ZW50ZXIgY2hlY2sKICAgIGlmIChjcmVhdGVDb21wb25lbnQodm5vZGUsIGluc2VydGVkVm5vZGVR
dWV1ZSwgcGFyZW50RWxtLCByZWZFbG0pKSB7CiAgICAgIHJldHVybgogICAgfQoKICAgIHZhciBk
YXRhID0gdm5vZGUuZGF0YTsKICAgIHZhciBjaGlsZHJlbiA9IHZub2RlLmNoaWxkcmVuOwogICAg
dmFyIHRhZyA9IHZub2RlLnRhZzsKICAgIGlmIChpc0RlZih0YWcpKSB7CiAgICAgIHsKICAgICAg
ICBpZiAoZGF0YSAmJiBkYXRhLnByZSkgewogICAgICAgICAgaW5QcmUrKzsKICAgICAgICB9CiAg
ICAgICAgaWYgKAogICAgICAgICAgIWluUHJlICYmCiAgICAgICAgICAhdm5vZGUubnMgJiYKICAg
ICAgICAgICEoY29uZmlnLmlnbm9yZWRFbGVtZW50cyAmJiBjb25maWcuaWdub3JlZEVsZW1lbnRz
LmluZGV4T2YodGFnKSA+IC0xKSAmJgogICAgICAgICAgY29uZmlnLmlzVW5rbm93bkVsZW1lbnQo
dGFnKQogICAgICAgICkgewogICAgICAgICAgd2FybigKICAgICAgICAgICAgJ1Vua25vd24gY3Vz
dG9tIGVsZW1lbnQ6IDwnICsgdGFnICsgJz4gLSBkaWQgeW91ICcgKwogICAgICAgICAgICAncmVn
aXN0ZXIgdGhlIGNvbXBvbmVudCBjb3JyZWN0bHk/IEZvciByZWN1cnNpdmUgY29tcG9uZW50cywg
JyArCiAgICAgICAgICAgICdtYWtlIHN1cmUgdG8gcHJvdmlkZSB0aGUgIm5hbWUiIG9wdGlvbi4n
LAogICAgICAgICAgICB2bm9kZS5jb250ZXh0CiAgICAgICAgICApOwogICAgICAgIH0KICAgICAg
fQogICAgICB2bm9kZS5lbG0gPSB2bm9kZS5ucwogICAgICAgID8gbm9kZU9wcy5jcmVhdGVFbGVt
ZW50TlModm5vZGUubnMsIHRhZykKICAgICAgICA6IG5vZGVPcHMuY3JlYXRlRWxlbWVudCh0YWcs
IHZub2RlKTsKICAgICAgc2V0U2NvcGUodm5vZGUpOwoKICAgICAgLyogaXN0YW5idWwgaWdub3Jl
IGlmICovCiAgICAgIHsKICAgICAgICBjcmVhdGVDaGlsZHJlbih2bm9kZSwgY2hpbGRyZW4sIGlu
c2VydGVkVm5vZGVRdWV1ZSk7CiAgICAgICAgaWYgKGlzRGVmKGRhdGEpKSB7CiAgICAgICAgICBp
bnZva2VDcmVhdGVIb29rcyh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgICB9CiAg
ICAgICAgaW5zZXJ0KHBhcmVudEVsbSwgdm5vZGUuZWxtLCByZWZFbG0pOwogICAgICB9CgogICAg
ICBpZiAoImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIGRhdGEgJiYgZGF0YS5wcmUp
IHsKICAgICAgICBpblByZS0tOwogICAgICB9CiAgICB9IGVsc2UgaWYgKHZub2RlLmlzQ29tbWVu
dCkgewogICAgICB2bm9kZS5lbG0gPSBub2RlT3BzLmNyZWF0ZUNvbW1lbnQodm5vZGUudGV4dCk7
CiAgICAgIGluc2VydChwYXJlbnRFbG0sIHZub2RlLmVsbSwgcmVmRWxtKTsKICAgIH0gZWxzZSB7
CiAgICAgIHZub2RlLmVsbSA9IG5vZGVPcHMuY3JlYXRlVGV4dE5vZGUodm5vZGUudGV4dCk7CiAg
ICAgIGluc2VydChwYXJlbnRFbG0sIHZub2RlLmVsbSwgcmVmRWxtKTsKICAgIH0KICB9CgogIGZ1
bmN0aW9uIGNyZWF0ZUNvbXBvbmVudCAodm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgcGFyZW50
RWxtLCByZWZFbG0pIHsKICAgIHZhciBpID0gdm5vZGUuZGF0YTsKICAgIGlmIChpc0RlZihpKSkg
ewogICAgICB2YXIgaXNSZWFjdGl2YXRlZCA9IGlzRGVmKHZub2RlLmNoaWxkKSAmJiBpLmtlZXBB
bGl2ZTsKICAgICAgaWYgKGlzRGVmKGkgPSBpLmhvb2spICYmIGlzRGVmKGkgPSBpLmluaXQpKSB7
CiAgICAgICAgaSh2bm9kZSwgZmFsc2UgLyogaHlkcmF0aW5nICovLCBwYXJlbnRFbG0sIHJlZkVs
bSk7CiAgICAgIH0KICAgICAgLy8gYWZ0ZXIgY2FsbGluZyB0aGUgaW5pdCBob29rLCBpZiB0aGUg
dm5vZGUgaXMgYSBjaGlsZCBjb21wb25lbnQKICAgICAgLy8gaXQgc2hvdWxkJ3ZlIGNyZWF0ZWQg
YSBjaGlsZCBpbnN0YW5jZSBhbmQgbW91bnRlZCBpdC4gdGhlIGNoaWxkCiAgICAgIC8vIGNvbXBv
bmVudCBhbHNvIGhhcyBzZXQgdGhlIHBsYWNlaG9sZGVyIHZub2RlJ3MgZWxtLgogICAgICAvLyBp
biB0aGF0IGNhc2Ugd2UgY2FuIGp1c3QgcmV0dXJuIHRoZSBlbGVtZW50IGFuZCBiZSBkb25lLgog
ICAgICBpZiAoaXNEZWYodm5vZGUuY2hpbGQpKSB7CiAgICAgICAgaW5pdENvbXBvbmVudCh2bm9k
ZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgICBpZiAoaXNSZWFjdGl2YXRlZCkgewogICAg
ICAgICAgcmVhY3RpdmF0ZUNvbXBvbmVudCh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBwYXJl
bnRFbG0sIHJlZkVsbSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0KICAg
IH0KICB9CgogIGZ1bmN0aW9uIHJlYWN0aXZhdGVDb21wb25lbnQgKHZub2RlLCBpbnNlcnRlZFZu
b2RlUXVldWUsIHBhcmVudEVsbSwgcmVmRWxtKSB7CiAgICB2YXIgaTsKICAgIC8vIGhhY2sgZm9y
ICM0MzM5OiBhIHJlYWN0aXZhdGVkIGNvbXBvbmVudCB3aXRoIGlubmVyIHRyYW5zaXRpb24KICAg
IC8vIGRvZXMgbm90IHRyaWdnZXIgYmVjYXVzZSB0aGUgaW5uZXIgbm9kZSdzIGNyZWF0ZWQgaG9v
a3MgYXJlIG5vdCBjYWxsZWQKICAgIC8vIGFnYWluLiBJdCdzIG5vdCBpZGVhbCB0byBpbnZvbHZl
IG1vZHVsZS1zcGVjaWZpYyBsb2dpYyBpbiBoZXJlIGJ1dAogICAgLy8gdGhlcmUgZG9lc24ndCBz
ZWVtIHRvIGJlIGEgYmV0dGVyIHdheSB0byBkbyBpdC4KICAgIHZhciBpbm5lck5vZGUgPSB2bm9k
ZTsKICAgIHdoaWxlIChpbm5lck5vZGUuY2hpbGQpIHsKICAgICAgaW5uZXJOb2RlID0gaW5uZXJO
b2RlLmNoaWxkLl92bm9kZTsKICAgICAgaWYgKGlzRGVmKGkgPSBpbm5lck5vZGUuZGF0YSkgJiYg
aXNEZWYoaSA9IGkudHJhbnNpdGlvbikpIHsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLmFj
dGl2YXRlLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICBjYnMuYWN0aXZhdGVbaV0oZW1wdHlOb2Rl
LCBpbm5lck5vZGUpOwogICAgICAgIH0KICAgICAgICBpbnNlcnRlZFZub2RlUXVldWUucHVzaChp
bm5lck5vZGUpOwogICAgICAgIGJyZWFrCiAgICAgIH0KICAgIH0KICAgIC8vIHVubGlrZSBhIG5l
d2x5IGNyZWF0ZWQgY29tcG9uZW50LAogICAgLy8gYSByZWFjdGl2YXRlZCBrZWVwLWFsaXZlIGNv
bXBvbmVudCBkb2Vzbid0IGluc2VydCBpdHNlbGYKICAgIGluc2VydChwYXJlbnRFbG0sIHZub2Rl
LmVsbSwgcmVmRWxtKTsKICB9CgogIGZ1bmN0aW9uIGluc2VydCAocGFyZW50LCBlbG0sIHJlZikg
ewogICAgaWYgKHBhcmVudCkgewogICAgICBpZiAocmVmKSB7CiAgICAgICAgbm9kZU9wcy5pbnNl
cnRCZWZvcmUocGFyZW50LCBlbG0sIHJlZik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbm9kZU9w
cy5hcHBlbmRDaGlsZChwYXJlbnQsIGVsbSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9u
IGNyZWF0ZUNoaWxkcmVuICh2bm9kZSwgY2hpbGRyZW4sIGluc2VydGVkVm5vZGVRdWV1ZSkgewog
ICAgaWYgKEFycmF5LmlzQXJyYXkoY2hpbGRyZW4pKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBp
IDwgY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHsKICAgICAgICBjcmVhdGVFbG0oY2hpbGRyZW5baV0s
IGluc2VydGVkVm5vZGVRdWV1ZSwgdm5vZGUuZWxtLCBudWxsLCB0cnVlKTsKICAgICAgfQogICAg
fSBlbHNlIGlmIChpc1ByaW1pdGl2ZSh2bm9kZS50ZXh0KSkgewogICAgICBub2RlT3BzLmFwcGVu
ZENoaWxkKHZub2RlLmVsbSwgbm9kZU9wcy5jcmVhdGVUZXh0Tm9kZSh2bm9kZS50ZXh0KSk7CiAg
ICB9CiAgfQoKICBmdW5jdGlvbiBpc1BhdGNoYWJsZSAodm5vZGUpIHsKICAgIHdoaWxlICh2bm9k
ZS5jaGlsZCkgewogICAgICB2bm9kZSA9IHZub2RlLmNoaWxkLl92bm9kZTsKICAgIH0KICAgIHJl
dHVybiBpc0RlZih2bm9kZS50YWcpCiAgfQoKICBmdW5jdGlvbiBpbnZva2VDcmVhdGVIb29rcyAo
dm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSkgewogICAgZm9yICh2YXIgaSQxID0gMDsgaSQxIDwg
Y2JzLmNyZWF0ZS5sZW5ndGg7ICsraSQxKSB7CiAgICAgIGNicy5jcmVhdGVbaSQxXShlbXB0eU5v
ZGUsIHZub2RlKTsKICAgIH0KICAgIGkgPSB2bm9kZS5kYXRhLmhvb2s7IC8vIFJldXNlIHZhcmlh
YmxlCiAgICBpZiAoaXNEZWYoaSkpIHsKICAgICAgaWYgKGkuY3JlYXRlKSB7IGkuY3JlYXRlKGVt
cHR5Tm9kZSwgdm5vZGUpOyB9CiAgICAgIGlmIChpLmluc2VydCkgeyBpbnNlcnRlZFZub2RlUXVl
dWUucHVzaCh2bm9kZSk7IH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGluaXRDb21wb25lbnQgKHZu
b2RlLCBpbnNlcnRlZFZub2RlUXVldWUpIHsKICAgIGlmICh2bm9kZS5kYXRhLnBlbmRpbmdJbnNl
cnQpIHsKICAgICAgaW5zZXJ0ZWRWbm9kZVF1ZXVlLnB1c2guYXBwbHkoaW5zZXJ0ZWRWbm9kZVF1
ZXVlLCB2bm9kZS5kYXRhLnBlbmRpbmdJbnNlcnQpOwogICAgfQogICAgdm5vZGUuZWxtID0gdm5v
ZGUuY2hpbGQuJGVsOwogICAgaWYgKGlzUGF0Y2hhYmxlKHZub2RlKSkgewogICAgICBpbnZva2VD
cmVhdGVIb29rcyh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgc2V0U2NvcGUodm5v
ZGUpOwogICAgfSBlbHNlIHsKICAgICAgLy8gZW1wdHkgY29tcG9uZW50IHJvb3QuCiAgICAgIC8v
IHNraXAgYWxsIGVsZW1lbnQtcmVsYXRlZCBtb2R1bGVzIGV4Y2VwdCBmb3IgcmVmICgjMzQ1NSkK
ICAgICAgcmVnaXN0ZXJSZWYodm5vZGUpOwogICAgICAvLyBtYWtlIHN1cmUgdG8gaW52b2tlIHRo
ZSBpbnNlcnQgaG9vawogICAgICBpbnNlcnRlZFZub2RlUXVldWUucHVzaCh2bm9kZSk7CiAgICB9
CiAgfQoKICAvLyBzZXQgc2NvcGUgaWQgYXR0cmlidXRlIGZvciBzY29wZWQgQ1NTLgogIC8vIHRo
aXMgaXMgaW1wbGVtZW50ZWQgYXMgYSBzcGVjaWFsIGNhc2UgdG8gYXZvaWQgdGhlIG92ZXJoZWFk
CiAgLy8gb2YgZ29pbmcgdGhyb3VnaCB0aGUgbm9ybWFsIGF0dHJpYnV0ZSBwYXRjaGluZyBwcm9j
ZXNzLgogIGZ1bmN0aW9uIHNldFNjb3BlICh2bm9kZSkgewogICAgdmFyIGk7CiAgICBpZiAoaXNE
ZWYoaSA9IHZub2RlLmNvbnRleHQpICYmIGlzRGVmKGkgPSBpLiRvcHRpb25zLl9zY29wZUlkKSkg
ewogICAgICBub2RlT3BzLnNldEF0dHJpYnV0ZSh2bm9kZS5lbG0sIGksICcnKTsKICAgIH0KICAg
IGlmIChpc0RlZihpID0gYWN0aXZlSW5zdGFuY2UpICYmCiAgICAgICAgaSAhPT0gdm5vZGUuY29u
dGV4dCAmJgogICAgICAgIGlzRGVmKGkgPSBpLiRvcHRpb25zLl9zY29wZUlkKSkgewogICAgICBu
b2RlT3BzLnNldEF0dHJpYnV0ZSh2bm9kZS5lbG0sIGksICcnKTsKICAgIH0KICB9CgogIGZ1bmN0
aW9uIGFkZFZub2RlcyAocGFyZW50RWxtLCByZWZFbG0sIHZub2Rlcywgc3RhcnRJZHgsIGVuZElk
eCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSB7CiAgICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyAr
K3N0YXJ0SWR4KSB7CiAgICAgIGNyZWF0ZUVsbSh2bm9kZXNbc3RhcnRJZHhdLCBpbnNlcnRlZFZu
b2RlUXVldWUsIHBhcmVudEVsbSwgcmVmRWxtKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGludm9r
ZURlc3Ryb3lIb29rICh2bm9kZSkgewogICAgdmFyIGksIGo7CiAgICB2YXIgZGF0YSA9IHZub2Rl
LmRhdGE7CiAgICBpZiAoaXNEZWYoZGF0YSkpIHsKICAgICAgaWYgKGlzRGVmKGkgPSBkYXRhLmhv
b2spICYmIGlzRGVmKGkgPSBpLmRlc3Ryb3kpKSB7IGkodm5vZGUpOyB9CiAgICAgIGZvciAoaSA9
IDA7IGkgPCBjYnMuZGVzdHJveS5sZW5ndGg7ICsraSkgeyBjYnMuZGVzdHJveVtpXSh2bm9kZSk7
IH0KICAgIH0KICAgIGlmIChpc0RlZihpID0gdm5vZGUuY2hpbGRyZW4pKSB7CiAgICAgIGZvciAo
aiA9IDA7IGogPCB2bm9kZS5jaGlsZHJlbi5sZW5ndGg7ICsraikgewogICAgICAgIGludm9rZURl
c3Ryb3lIb29rKHZub2RlLmNoaWxkcmVuW2pdKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rp
b24gcmVtb3ZlVm5vZGVzIChwYXJlbnRFbG0sIHZub2Rlcywgc3RhcnRJZHgsIGVuZElkeCkgewog
ICAgZm9yICg7IHN0YXJ0SWR4IDw9IGVuZElkeDsgKytzdGFydElkeCkgewogICAgICB2YXIgY2gg
PSB2bm9kZXNbc3RhcnRJZHhdOwogICAgICBpZiAoaXNEZWYoY2gpKSB7CiAgICAgICAgaWYgKGlz
RGVmKGNoLnRhZykpIHsKICAgICAgICAgIHJlbW92ZUFuZEludm9rZVJlbW92ZUhvb2soY2gpOwog
ICAgICAgICAgaW52b2tlRGVzdHJveUhvb2soY2gpOwogICAgICAgIH0gZWxzZSB7IC8vIFRleHQg
bm9kZQogICAgICAgICAgbm9kZU9wcy5yZW1vdmVDaGlsZChwYXJlbnRFbG0sIGNoLmVsbSk7CiAg
ICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZW1vdmVBbmRJbnZva2VSZW1v
dmVIb29rICh2bm9kZSwgcm0pIHsKICAgIGlmIChybSB8fCBpc0RlZih2bm9kZS5kYXRhKSkgewog
ICAgICB2YXIgbGlzdGVuZXJzID0gY2JzLnJlbW92ZS5sZW5ndGggKyAxOwogICAgICBpZiAoIXJt
KSB7CiAgICAgICAgLy8gZGlyZWN0bHkgcmVtb3ZpbmcKICAgICAgICBybSA9IGNyZWF0ZVJtQ2Io
dm5vZGUuZWxtLCBsaXN0ZW5lcnMpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIHdlIGhhdmUg
YSByZWN1cnNpdmVseSBwYXNzZWQgZG93biBybSBjYWxsYmFjawogICAgICAgIC8vIGluY3JlYXNl
IHRoZSBsaXN0ZW5lcnMgY291bnQKICAgICAgICBybS5saXN0ZW5lcnMgKz0gbGlzdGVuZXJzOwog
ICAgICB9CiAgICAgIC8vIHJlY3Vyc2l2ZWx5IGludm9rZSBob29rcyBvbiBjaGlsZCBjb21wb25l
bnQgcm9vdCBub2RlCiAgICAgIGlmIChpc0RlZihpID0gdm5vZGUuY2hpbGQpICYmIGlzRGVmKGkg
PSBpLl92bm9kZSkgJiYgaXNEZWYoaS5kYXRhKSkgewogICAgICAgIHJlbW92ZUFuZEludm9rZVJl
bW92ZUhvb2soaSwgcm0pOwogICAgICB9CiAgICAgIGZvciAoaSA9IDA7IGkgPCBjYnMucmVtb3Zl
Lmxlbmd0aDsgKytpKSB7CiAgICAgICAgY2JzLnJlbW92ZVtpXSh2bm9kZSwgcm0pOwogICAgICB9
CiAgICAgIGlmIChpc0RlZihpID0gdm5vZGUuZGF0YS5ob29rKSAmJiBpc0RlZihpID0gaS5yZW1v
dmUpKSB7CiAgICAgICAgaSh2bm9kZSwgcm0pOwogICAgICB9IGVsc2UgewogICAgICAgIHJtKCk7
CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJlbW92ZUVsZW1lbnQodm5vZGUuZWxtKTsKICAg
IH0KICB9CgogIGZ1bmN0aW9uIHVwZGF0ZUNoaWxkcmVuIChwYXJlbnRFbG0sIG9sZENoLCBuZXdD
aCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCByZW1vdmVPbmx5KSB7CiAgICB2YXIgb2xkU3RhcnRJZHgg
PSAwOwogICAgdmFyIG5ld1N0YXJ0SWR4ID0gMDsKICAgIHZhciBvbGRFbmRJZHggPSBvbGRDaC5s
ZW5ndGggLSAxOwogICAgdmFyIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFswXTsKICAgIHZhciBvbGRF
bmRWbm9kZSA9IG9sZENoW29sZEVuZElkeF07CiAgICB2YXIgbmV3RW5kSWR4ID0gbmV3Q2gubGVu
Z3RoIC0gMTsKICAgIHZhciBuZXdTdGFydFZub2RlID0gbmV3Q2hbMF07CiAgICB2YXIgbmV3RW5k
Vm5vZGUgPSBuZXdDaFtuZXdFbmRJZHhdOwogICAgdmFyIG9sZEtleVRvSWR4LCBpZHhJbk9sZCwg
ZWxtVG9Nb3ZlLCByZWZFbG07CgogICAgLy8gcmVtb3ZlT25seSBpcyBhIHNwZWNpYWwgZmxhZyB1
c2VkIG9ubHkgYnkgPHRyYW5zaXRpb24tZ3JvdXA+CiAgICAvLyB0byBlbnN1cmUgcmVtb3ZlZCBl
bGVtZW50cyBzdGF5IGluIGNvcnJlY3QgcmVsYXRpdmUgcG9zaXRpb25zCiAgICAvLyBkdXJpbmcg
bGVhdmluZyB0cmFuc2l0aW9ucwogICAgdmFyIGNhbk1vdmUgPSAhcmVtb3ZlT25seTsKCiAgICB3
aGlsZSAob2xkU3RhcnRJZHggPD0gb2xkRW5kSWR4ICYmIG5ld1N0YXJ0SWR4IDw9IG5ld0VuZElk
eCkgewogICAgICBpZiAoaXNVbmRlZihvbGRTdGFydFZub2RlKSkgewogICAgICAgIG9sZFN0YXJ0
Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTsgLy8gVm5vZGUgaGFzIGJlZW4gbW92ZWQgbGVm
dAogICAgICB9IGVsc2UgaWYgKGlzVW5kZWYob2xkRW5kVm5vZGUpKSB7CiAgICAgICAgb2xkRW5k
Vm5vZGUgPSBvbGRDaFstLW9sZEVuZElkeF07CiAgICAgIH0gZWxzZSBpZiAoc2FtZVZub2RlKG9s
ZFN0YXJ0Vm5vZGUsIG5ld1N0YXJ0Vm5vZGUpKSB7CiAgICAgICAgcGF0Y2hWbm9kZShvbGRTdGFy
dFZub2RlLCBuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpOwogICAgICAgIG9sZFN0
YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTsKICAgICAgICBuZXdTdGFydFZub2RlID0g
bmV3Q2hbKytuZXdTdGFydElkeF07CiAgICAgIH0gZWxzZSBpZiAoc2FtZVZub2RlKG9sZEVuZFZu
b2RlLCBuZXdFbmRWbm9kZSkpIHsKICAgICAgICBwYXRjaFZub2RlKG9sZEVuZFZub2RlLCBuZXdF
bmRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENo
Wy0tb2xkRW5kSWR4XTsKICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTsK
ICAgICAgfSBlbHNlIGlmIChzYW1lVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3RW5kVm5vZGUpKSB7
IC8vIFZub2RlIG1vdmVkIHJpZ2h0CiAgICAgICAgcGF0Y2hWbm9kZShvbGRTdGFydFZub2RlLCBu
ZXdFbmRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgICBjYW5Nb3ZlICYmIG5vZGVP
cHMuaW5zZXJ0QmVmb3JlKHBhcmVudEVsbSwgb2xkU3RhcnRWbm9kZS5lbG0sIG5vZGVPcHMubmV4
dFNpYmxpbmcob2xkRW5kVm5vZGUuZWxtKSk7CiAgICAgICAgb2xkU3RhcnRWbm9kZSA9IG9sZENo
Wysrb2xkU3RhcnRJZHhdOwogICAgICAgIG5ld0VuZFZub2RlID0gbmV3Q2hbLS1uZXdFbmRJZHhd
OwogICAgICB9IGVsc2UgaWYgKHNhbWVWbm9kZShvbGRFbmRWbm9kZSwgbmV3U3RhcnRWbm9kZSkp
IHsgLy8gVm5vZGUgbW92ZWQgbGVmdAogICAgICAgIHBhdGNoVm5vZGUob2xkRW5kVm5vZGUsIG5l
d1N0YXJ0Vm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7CiAgICAgICAgY2FuTW92ZSAmJiBub2Rl
T3BzLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIG9sZEVuZFZub2RlLmVsbSwgb2xkU3RhcnRWbm9k
ZS5lbG0pOwogICAgICAgIG9sZEVuZFZub2RlID0gb2xkQ2hbLS1vbGRFbmRJZHhdOwogICAgICAg
IG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTsKICAgICAgfSBlbHNlIHsKICAg
ICAgICBpZiAoaXNVbmRlZihvbGRLZXlUb0lkeCkpIHsgb2xkS2V5VG9JZHggPSBjcmVhdGVLZXlU
b09sZElkeChvbGRDaCwgb2xkU3RhcnRJZHgsIG9sZEVuZElkeCk7IH0KICAgICAgICBpZHhJbk9s
ZCA9IGlzRGVmKG5ld1N0YXJ0Vm5vZGUua2V5KSA/IG9sZEtleVRvSWR4W25ld1N0YXJ0Vm5vZGUu
a2V5XSA6IG51bGw7CiAgICAgICAgaWYgKGlzVW5kZWYoaWR4SW5PbGQpKSB7IC8vIE5ldyBlbGVt
ZW50CiAgICAgICAgICBjcmVhdGVFbG0obmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVl
LCBwYXJlbnRFbG0sIG9sZFN0YXJ0Vm5vZGUuZWxtKTsKICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUg
PSBuZXdDaFsrK25ld1N0YXJ0SWR4XTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZWxtVG9N
b3ZlID0gb2xkQ2hbaWR4SW5PbGRdOwogICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICov
CiAgICAgICAgICBpZiAoImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmICFlbG1Ub01v
dmUpIHsKICAgICAgICAgICAgd2FybigKICAgICAgICAgICAgICAnSXQgc2VlbXMgdGhlcmUgYXJl
IGR1cGxpY2F0ZSBrZXlzIHRoYXQgaXMgY2F1c2luZyBhbiB1cGRhdGUgZXJyb3IuICcgKwogICAg
ICAgICAgICAgICdNYWtlIHN1cmUgZWFjaCB2LWZvciBpdGVtIGhhcyBhIHVuaXF1ZSBrZXkuJwog
ICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHNhbWVWbm9kZShlbG1Ub01v
dmUsIG5ld1N0YXJ0Vm5vZGUpKSB7CiAgICAgICAgICAgIHBhdGNoVm5vZGUoZWxtVG9Nb3ZlLCBu
ZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpOwogICAgICAgICAgICBvbGRDaFtpZHhJ
bk9sZF0gPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIGNhbk1vdmUgJiYgbm9kZU9wcy5pbnNlcnRC
ZWZvcmUocGFyZW50RWxtLCBuZXdTdGFydFZub2RlLmVsbSwgb2xkU3RhcnRWbm9kZS5lbG0pOwog
ICAgICAgICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07CiAgICAgICAg
ICB9IGVsc2UgewogICAgICAgICAgICAvLyBzYW1lIGtleSBidXQgZGlmZmVyZW50IGVsZW1lbnQu
IHRyZWF0IGFzIG5ldyBlbGVtZW50CiAgICAgICAgICAgIGNyZWF0ZUVsbShuZXdTdGFydFZub2Rl
LCBpbnNlcnRlZFZub2RlUXVldWUsIHBhcmVudEVsbSwgb2xkU3RhcnRWbm9kZS5lbG0pOwogICAg
ICAgICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07CiAgICAgICAgICB9
CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAob2xkU3RhcnRJZHggPiBvbGRFbmRJZHgp
IHsKICAgICAgcmVmRWxtID0gaXNVbmRlZihuZXdDaFtuZXdFbmRJZHggKyAxXSkgPyBudWxsIDog
bmV3Q2hbbmV3RW5kSWR4ICsgMV0uZWxtOwogICAgICBhZGRWbm9kZXMocGFyZW50RWxtLCByZWZF
bG0sIG5ld0NoLCBuZXdTdGFydElkeCwgbmV3RW5kSWR4LCBpbnNlcnRlZFZub2RlUXVldWUpOwog
ICAgfSBlbHNlIGlmIChuZXdTdGFydElkeCA+IG5ld0VuZElkeCkgewogICAgICByZW1vdmVWbm9k
ZXMocGFyZW50RWxtLCBvbGRDaCwgb2xkU3RhcnRJZHgsIG9sZEVuZElkeCk7CiAgICB9CiAgfQoK
ICBmdW5jdGlvbiBwYXRjaFZub2RlIChvbGRWbm9kZSwgdm5vZGUsIGluc2VydGVkVm5vZGVRdWV1
ZSwgcmVtb3ZlT25seSkgewogICAgaWYgKG9sZFZub2RlID09PSB2bm9kZSkgewogICAgICByZXR1
cm4KICAgIH0KICAgIC8vIHJldXNlIGVsZW1lbnQgZm9yIHN0YXRpYyB0cmVlcy4KICAgIC8vIG5v
dGUgd2Ugb25seSBkbyB0aGlzIGlmIHRoZSB2bm9kZSBpcyBjbG9uZWQgLQogICAgLy8gaWYgdGhl
IG5ldyBub2RlIGlzIG5vdCBjbG9uZWQgaXQgbWVhbnMgdGhlIHJlbmRlciBmdW5jdGlvbnMgaGF2
ZSBiZWVuCiAgICAvLyByZXNldCBieSB0aGUgaG90LXJlbG9hZC1hcGkgYW5kIHdlIG5lZWQgdG8g
ZG8gYSBwcm9wZXIgcmUtcmVuZGVyLgogICAgaWYgKHZub2RlLmlzU3RhdGljICYmCiAgICAgICAg
b2xkVm5vZGUuaXNTdGF0aWMgJiYKICAgICAgICB2bm9kZS5rZXkgPT09IG9sZFZub2RlLmtleSAm
JgogICAgICAgICh2bm9kZS5pc0Nsb25lZCB8fCB2bm9kZS5pc09uY2UpKSB7CiAgICAgIHZub2Rl
LmVsbSA9IG9sZFZub2RlLmVsbTsKICAgICAgdm5vZGUuY2hpbGQgPSBvbGRWbm9kZS5jaGlsZDsK
ICAgICAgcmV0dXJuCiAgICB9CiAgICB2YXIgaTsKICAgIHZhciBkYXRhID0gdm5vZGUuZGF0YTsK
ICAgIHZhciBoYXNEYXRhID0gaXNEZWYoZGF0YSk7CiAgICBpZiAoaGFzRGF0YSAmJiBpc0RlZihp
ID0gZGF0YS5ob29rKSAmJiBpc0RlZihpID0gaS5wcmVwYXRjaCkpIHsKICAgICAgaShvbGRWbm9k
ZSwgdm5vZGUpOwogICAgfQogICAgdmFyIGVsbSA9IHZub2RlLmVsbSA9IG9sZFZub2RlLmVsbTsK
ICAgIHZhciBvbGRDaCA9IG9sZFZub2RlLmNoaWxkcmVuOwogICAgdmFyIGNoID0gdm5vZGUuY2hp
bGRyZW47CiAgICBpZiAoaGFzRGF0YSAmJiBpc1BhdGNoYWJsZSh2bm9kZSkpIHsKICAgICAgZm9y
IChpID0gMDsgaSA8IGNicy51cGRhdGUubGVuZ3RoOyArK2kpIHsgY2JzLnVwZGF0ZVtpXShvbGRW
bm9kZSwgdm5vZGUpOyB9CiAgICAgIGlmIChpc0RlZihpID0gZGF0YS5ob29rKSAmJiBpc0RlZihp
ID0gaS51cGRhdGUpKSB7IGkob2xkVm5vZGUsIHZub2RlKTsgfQogICAgfQogICAgaWYgKGlzVW5k
ZWYodm5vZGUudGV4dCkpIHsKICAgICAgaWYgKGlzRGVmKG9sZENoKSAmJiBpc0RlZihjaCkpIHsK
ICAgICAgICBpZiAob2xkQ2ggIT09IGNoKSB7IHVwZGF0ZUNoaWxkcmVuKGVsbSwgb2xkQ2gsIGNo
LCBpbnNlcnRlZFZub2RlUXVldWUsIHJlbW92ZU9ubHkpOyB9CiAgICAgIH0gZWxzZSBpZiAoaXNE
ZWYoY2gpKSB7CiAgICAgICAgaWYgKGlzRGVmKG9sZFZub2RlLnRleHQpKSB7IG5vZGVPcHMuc2V0
VGV4dENvbnRlbnQoZWxtLCAnJyk7IH0KICAgICAgICBhZGRWbm9kZXMoZWxtLCBudWxsLCBjaCwg
MCwgY2gubGVuZ3RoIC0gMSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgfSBlbHNlIGlmIChp
c0RlZihvbGRDaCkpIHsKICAgICAgICByZW1vdmVWbm9kZXMoZWxtLCBvbGRDaCwgMCwgb2xkQ2gu
bGVuZ3RoIC0gMSk7CiAgICAgIH0gZWxzZSBpZiAoaXNEZWYob2xkVm5vZGUudGV4dCkpIHsKICAg
ICAgICBub2RlT3BzLnNldFRleHRDb250ZW50KGVsbSwgJycpOwogICAgICB9CiAgICB9IGVsc2Ug
aWYgKG9sZFZub2RlLnRleHQgIT09IHZub2RlLnRleHQpIHsKICAgICAgbm9kZU9wcy5zZXRUZXh0
Q29udGVudChlbG0sIHZub2RlLnRleHQpOwogICAgfQogICAgaWYgKGhhc0RhdGEpIHsKICAgICAg
aWYgKGlzRGVmKGkgPSBkYXRhLmhvb2spICYmIGlzRGVmKGkgPSBpLnBvc3RwYXRjaCkpIHsgaShv
bGRWbm9kZSwgdm5vZGUpOyB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpbnZva2VJbnNlcnRIb29r
ICh2bm9kZSwgcXVldWUsIGluaXRpYWwpIHsKICAgIC8vIGRlbGF5IGluc2VydCBob29rcyBmb3Ig
Y29tcG9uZW50IHJvb3Qgbm9kZXMsIGludm9rZSB0aGVtIGFmdGVyIHRoZQogICAgLy8gZWxlbWVu
dCBpcyByZWFsbHkgaW5zZXJ0ZWQKICAgIGlmIChpbml0aWFsICYmIHZub2RlLnBhcmVudCkgewog
ICAgICB2bm9kZS5wYXJlbnQuZGF0YS5wZW5kaW5nSW5zZXJ0ID0gcXVldWU7CiAgICB9IGVsc2Ug
ewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHF1ZXVlLmxlbmd0aDsgKytpKSB7CiAgICAgICAg
cXVldWVbaV0uZGF0YS5ob29rLmluc2VydChxdWV1ZVtpXSk7CiAgICAgIH0KICAgIH0KICB9Cgog
IHZhciBiYWlsZWQgPSBmYWxzZTsKICAvLyBsaXN0IG9mIG1vZHVsZXMgdGhhdCBjYW4gc2tpcCBj
cmVhdGUgaG9vayBkdXJpbmcgaHlkcmF0aW9uIGJlY2F1c2UgdGhleQogIC8vIGFyZSBhbHJlYWR5
IHJlbmRlcmVkIG9uIHRoZSBjbGllbnQgb3IgaGFzIG5vIG5lZWQgZm9yIGluaXRpYWxpemF0aW9u
CiAgdmFyIGlzUmVuZGVyZWRNb2R1bGUgPSBtYWtlTWFwKCdhdHRycyxzdHlsZSxjbGFzcyxzdGF0
aWNDbGFzcyxzdGF0aWNTdHlsZSxrZXknKTsKCiAgLy8gTm90ZTogdGhpcyBpcyBhIGJyb3dzZXIt
b25seSBmdW5jdGlvbiBzbyB3ZSBjYW4gYXNzdW1lIGVsbXMgYXJlIERPTSBub2Rlcy4KICBmdW5j
dGlvbiBoeWRyYXRlIChlbG0sIHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpIHsKICAgIHsKICAg
ICAgaWYgKCFhc3NlcnROb2RlTWF0Y2goZWxtLCB2bm9kZSkpIHsKICAgICAgICByZXR1cm4gZmFs
c2UKICAgICAgfQogICAgfQogICAgdm5vZGUuZWxtID0gZWxtOwogICAgdmFyIHRhZyA9IHZub2Rl
LnRhZzsKICAgIHZhciBkYXRhID0gdm5vZGUuZGF0YTsKICAgIHZhciBjaGlsZHJlbiA9IHZub2Rl
LmNoaWxkcmVuOwogICAgaWYgKGlzRGVmKGRhdGEpKSB7CiAgICAgIGlmIChpc0RlZihpID0gZGF0
YS5ob29rKSAmJiBpc0RlZihpID0gaS5pbml0KSkgeyBpKHZub2RlLCB0cnVlIC8qIGh5ZHJhdGlu
ZyAqLyk7IH0KICAgICAgaWYgKGlzRGVmKGkgPSB2bm9kZS5jaGlsZCkpIHsKICAgICAgICAvLyBj
aGlsZCBjb21wb25lbnQuIGl0IHNob3VsZCBoYXZlIGh5ZHJhdGVkIGl0cyBvd24gdHJlZS4KICAg
ICAgICBpbml0Q29tcG9uZW50KHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpOwogICAgICAgIHJl
dHVybiB0cnVlCiAgICAgIH0KICAgIH0KICAgIGlmIChpc0RlZih0YWcpKSB7CiAgICAgIGlmIChp
c0RlZihjaGlsZHJlbikpIHsKICAgICAgICAvLyBlbXB0eSBlbGVtZW50LCBhbGxvdyBjbGllbnQg
dG8gcGljayB1cCBhbmQgcG9wdWxhdGUgY2hpbGRyZW4KICAgICAgICBpZiAoIWVsbS5oYXNDaGls
ZE5vZGVzKCkpIHsKICAgICAgICAgIGNyZWF0ZUNoaWxkcmVuKHZub2RlLCBjaGlsZHJlbiwgaW5z
ZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGNoaWxkcmVu
TWF0Y2ggPSB0cnVlOwogICAgICAgICAgdmFyIGNoaWxkTm9kZSA9IGVsbS5maXJzdENoaWxkOwog
ICAgICAgICAgZm9yICh2YXIgaSQxID0gMDsgaSQxIDwgY2hpbGRyZW4ubGVuZ3RoOyBpJDErKykg
ewogICAgICAgICAgICBpZiAoIWNoaWxkTm9kZSB8fCAhaHlkcmF0ZShjaGlsZE5vZGUsIGNoaWxk
cmVuW2kkMV0sIGluc2VydGVkVm5vZGVRdWV1ZSkpIHsKICAgICAgICAgICAgICBjaGlsZHJlbk1h
dGNoID0gZmFsc2U7CiAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfQogICAgICAgICAg
ICBjaGlsZE5vZGUgPSBjaGlsZE5vZGUubmV4dFNpYmxpbmc7CiAgICAgICAgICB9CiAgICAgICAg
ICAvLyBpZiBjaGlsZE5vZGUgaXMgbm90IG51bGwsIGl0IG1lYW5zIHRoZSBhY3R1YWwgY2hpbGRO
b2RlcyBsaXN0IGlzCiAgICAgICAgICAvLyBsb25nZXIgdGhhbiB0aGUgdmlydHVhbCBjaGlsZHJl
biBsaXN0LgogICAgICAgICAgaWYgKCFjaGlsZHJlbk1hdGNoIHx8IGNoaWxkTm9kZSkgewogICAg
ICAgICAgICBpZiAoImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmCiAgICAgICAgICAg
ICAgICB0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYKICAgICAgICAgICAgICAgICFi
YWlsZWQpIHsKICAgICAgICAgICAgICBiYWlsZWQgPSB0cnVlOwogICAgICAgICAgICAgIGNvbnNv
bGUud2FybignUGFyZW50OiAnLCBlbG0pOwogICAgICAgICAgICAgIGNvbnNvbGUud2FybignTWlz
bWF0Y2hpbmcgY2hpbGROb2RlcyB2cy4gVk5vZGVzOiAnLCBlbG0uY2hpbGROb2RlcywgY2hpbGRy
ZW4pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgfQog
ICAgICAgIH0KICAgICAgfQogICAgICBpZiAoaXNEZWYoZGF0YSkpIHsKICAgICAgICBmb3IgKHZh
ciBrZXkgaW4gZGF0YSkgewogICAgICAgICAgaWYgKCFpc1JlbmRlcmVkTW9kdWxlKGtleSkpIHsK
ICAgICAgICAgICAgaW52b2tlQ3JlYXRlSG9va3Modm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7
CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAg
ICByZXR1cm4gdHJ1ZQogIH0KCiAgZnVuY3Rpb24gYXNzZXJ0Tm9kZU1hdGNoIChub2RlLCB2bm9k
ZSkgewogICAgaWYgKHZub2RlLnRhZykgewogICAgICByZXR1cm4gKAogICAgICAgIHZub2RlLnRh
Zy5pbmRleE9mKCd2dWUtY29tcG9uZW50JykgPT09IDAgfHwKICAgICAgICB2bm9kZS50YWcudG9M
b3dlckNhc2UoKSA9PT0gKG5vZGUudGFnTmFtZSAmJiBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2Uo
KSkKICAgICAgKQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIF90b1N0cmluZyh2bm9kZS50ZXh0
KSA9PT0gbm9kZS5kYXRhCiAgICB9CiAgfQoKICByZXR1cm4gZnVuY3Rpb24gcGF0Y2ggKG9sZFZu
b2RlLCB2bm9kZSwgaHlkcmF0aW5nLCByZW1vdmVPbmx5LCBwYXJlbnRFbG0sIHJlZkVsbSkgewog
ICAgaWYgKCF2bm9kZSkgewogICAgICBpZiAob2xkVm5vZGUpIHsgaW52b2tlRGVzdHJveUhvb2so
b2xkVm5vZGUpOyB9CiAgICAgIHJldHVybgogICAgfQoKICAgIHZhciBlbG0sIHBhcmVudDsKICAg
IHZhciBpc0luaXRpYWxQYXRjaCA9IGZhbHNlOwogICAgdmFyIGluc2VydGVkVm5vZGVRdWV1ZSA9
IFtdOwoKICAgIGlmICghb2xkVm5vZGUpIHsKICAgICAgLy8gZW1wdHkgbW91bnQgKGxpa2VseSBh
cyBjb21wb25lbnQpLCBjcmVhdGUgbmV3IHJvb3QgZWxlbWVudAogICAgICBpc0luaXRpYWxQYXRj
aCA9IHRydWU7CiAgICAgIGNyZWF0ZUVsbSh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBwYXJl
bnRFbG0sIHJlZkVsbSk7CiAgICB9IGVsc2UgewogICAgICB2YXIgaXNSZWFsRWxlbWVudCA9IGlz
RGVmKG9sZFZub2RlLm5vZGVUeXBlKTsKICAgICAgaWYgKCFpc1JlYWxFbGVtZW50ICYmIHNhbWVW
bm9kZShvbGRWbm9kZSwgdm5vZGUpKSB7CiAgICAgICAgLy8gcGF0Y2ggZXhpc3Rpbmcgcm9vdCBu
b2RlCiAgICAgICAgcGF0Y2hWbm9kZShvbGRWbm9kZSwgdm5vZGUsIGluc2VydGVkVm5vZGVRdWV1
ZSwgcmVtb3ZlT25seSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGlzUmVhbEVsZW1lbnQp
IHsKICAgICAgICAgIC8vIG1vdW50aW5nIHRvIGEgcmVhbCBlbGVtZW50CiAgICAgICAgICAvLyBj
aGVjayBpZiB0aGlzIGlzIHNlcnZlci1yZW5kZXJlZCBjb250ZW50IGFuZCBpZiB3ZSBjYW4gcGVy
Zm9ybQogICAgICAgICAgLy8gYSBzdWNjZXNzZnVsIGh5ZHJhdGlvbi4KICAgICAgICAgIGlmIChv
bGRWbm9kZS5ub2RlVHlwZSA9PT0gMSAmJiBvbGRWbm9kZS5oYXNBdHRyaWJ1dGUoJ3NlcnZlci1y
ZW5kZXJlZCcpKSB7CiAgICAgICAgICAgIG9sZFZub2RlLnJlbW92ZUF0dHJpYnV0ZSgnc2VydmVy
LXJlbmRlcmVkJyk7CiAgICAgICAgICAgIGh5ZHJhdGluZyA9IHRydWU7CiAgICAgICAgICB9CiAg
ICAgICAgICBpZiAoaHlkcmF0aW5nKSB7CiAgICAgICAgICAgIGlmIChoeWRyYXRlKG9sZFZub2Rl
LCB2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSkgewogICAgICAgICAgICAgIGludm9rZUluc2Vy
dEhvb2sodm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgdHJ1ZSk7CiAgICAgICAgICAgICAgcmV0
dXJuIG9sZFZub2RlCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgd2FybigKICAg
ICAgICAgICAgICAgICdUaGUgY2xpZW50LXNpZGUgcmVuZGVyZWQgdmlydHVhbCBET00gdHJlZSBp
cyBub3QgbWF0Y2hpbmcgJyArCiAgICAgICAgICAgICAgICAnc2VydmVyLXJlbmRlcmVkIGNvbnRl
bnQuIFRoaXMgaXMgbGlrZWx5IGNhdXNlZCBieSBpbmNvcnJlY3QgJyArCiAgICAgICAgICAgICAg
ICAnSFRNTCBtYXJrdXAsIGZvciBleGFtcGxlIG5lc3RpbmcgYmxvY2stbGV2ZWwgZWxlbWVudHMg
aW5zaWRlICcgKwogICAgICAgICAgICAgICAgJzxwPiwgb3IgbWlzc2luZyA8dGJvZHk+LiBCYWls
aW5nIGh5ZHJhdGlvbiBhbmQgcGVyZm9ybWluZyAnICsKICAgICAgICAgICAgICAgICdmdWxsIGNs
aWVudC1zaWRlIHJlbmRlci4nCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAg
ICAgfQogICAgICAgICAgLy8gZWl0aGVyIG5vdCBzZXJ2ZXItcmVuZGVyZWQsIG9yIGh5ZHJhdGlv
biBmYWlsZWQuCiAgICAgICAgICAvLyBjcmVhdGUgYW4gZW1wdHkgbm9kZSBhbmQgcmVwbGFjZSBp
dAogICAgICAgICAgb2xkVm5vZGUgPSBlbXB0eU5vZGVBdChvbGRWbm9kZSk7CiAgICAgICAgfQoK
ICAgICAgICAvLyByZXBsYWNpbmcgZXhpc3RpbmcgZWxlbWVudAogICAgICAgIGVsbSA9IG9sZFZu
b2RlLmVsbTsKICAgICAgICBwYXJlbnQgPSBub2RlT3BzLnBhcmVudE5vZGUoZWxtKTsKICAgICAg
ICBjcmVhdGVFbG0odm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgcGFyZW50LCBub2RlT3BzLm5l
eHRTaWJsaW5nKGVsbSkpOwoKICAgICAgICBpZiAodm5vZGUucGFyZW50KSB7CiAgICAgICAgICAv
LyBjb21wb25lbnQgcm9vdCBlbGVtZW50IHJlcGxhY2VkLgogICAgICAgICAgLy8gdXBkYXRlIHBh
cmVudCBwbGFjZWhvbGRlciBub2RlIGVsZW1lbnQsIHJlY3Vyc2l2ZWx5CiAgICAgICAgICB2YXIg
YW5jZXN0b3IgPSB2bm9kZS5wYXJlbnQ7CiAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IpIHsKICAg
ICAgICAgICAgYW5jZXN0b3IuZWxtID0gdm5vZGUuZWxtOwogICAgICAgICAgICBhbmNlc3RvciA9
IGFuY2VzdG9yLnBhcmVudDsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChpc1BhdGNoYWJsZSh2
bm9kZSkpIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYnMuY3JlYXRlLmxlbmd0
aDsgKytpKSB7CiAgICAgICAgICAgICAgY2JzLmNyZWF0ZVtpXShlbXB0eU5vZGUsIHZub2RlLnBh
cmVudCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChw
YXJlbnQgIT09IG51bGwpIHsKICAgICAgICAgIHJlbW92ZVZub2RlcyhwYXJlbnQsIFtvbGRWbm9k
ZV0sIDAsIDApOwogICAgICAgIH0gZWxzZSBpZiAoaXNEZWYob2xkVm5vZGUudGFnKSkgewogICAg
ICAgICAgaW52b2tlRGVzdHJveUhvb2sob2xkVm5vZGUpOwogICAgICAgIH0KICAgICAgfQogICAg
fQoKICAgIGludm9rZUluc2VydEhvb2sodm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgaXNJbml0
aWFsUGF0Y2gpOwogICAgcmV0dXJuIHZub2RlLmVsbQogIH0KfQoKLyogICovCgp2YXIgZGlyZWN0
aXZlcyA9IHsKICBjcmVhdGU6IHVwZGF0ZURpcmVjdGl2ZXMsCiAgdXBkYXRlOiB1cGRhdGVEaXJl
Y3RpdmVzLAogIGRlc3Ryb3k6IGZ1bmN0aW9uIHVuYmluZERpcmVjdGl2ZXMgKHZub2RlKSB7CiAg
ICB1cGRhdGVEaXJlY3RpdmVzKHZub2RlLCBlbXB0eU5vZGUpOwogIH0KfTsKCmZ1bmN0aW9uIHVw
ZGF0ZURpcmVjdGl2ZXMgKG9sZFZub2RlLCB2bm9kZSkgewogIGlmIChvbGRWbm9kZS5kYXRhLmRp
cmVjdGl2ZXMgfHwgdm5vZGUuZGF0YS5kaXJlY3RpdmVzKSB7CiAgICBfdXBkYXRlKG9sZFZub2Rl
LCB2bm9kZSk7CiAgfQp9CgpmdW5jdGlvbiBfdXBkYXRlIChvbGRWbm9kZSwgdm5vZGUpIHsKICB2
YXIgaXNDcmVhdGUgPSBvbGRWbm9kZSA9PT0gZW1wdHlOb2RlOwogIHZhciBvbGREaXJzID0gbm9y
bWFsaXplRGlyZWN0aXZlcyQxKG9sZFZub2RlLmRhdGEuZGlyZWN0aXZlcywgb2xkVm5vZGUuY29u
dGV4dCk7CiAgdmFyIG5ld0RpcnMgPSBub3JtYWxpemVEaXJlY3RpdmVzJDEodm5vZGUuZGF0YS5k
aXJlY3RpdmVzLCB2bm9kZS5jb250ZXh0KTsKCiAgdmFyIGRpcnNXaXRoSW5zZXJ0ID0gW107CiAg
dmFyIGRpcnNXaXRoUG9zdHBhdGNoID0gW107CgogIHZhciBrZXksIG9sZERpciwgZGlyOwogIGZv
ciAoa2V5IGluIG5ld0RpcnMpIHsKICAgIG9sZERpciA9IG9sZERpcnNba2V5XTsKICAgIGRpciA9
IG5ld0RpcnNba2V5XTsKICAgIGlmICghb2xkRGlyKSB7CiAgICAgIC8vIG5ldyBkaXJlY3RpdmUs
IGJpbmQKICAgICAgY2FsbEhvb2skMShkaXIsICdiaW5kJywgdm5vZGUsIG9sZFZub2RlKTsKICAg
ICAgaWYgKGRpci5kZWYgJiYgZGlyLmRlZi5pbnNlcnRlZCkgewogICAgICAgIGRpcnNXaXRoSW5z
ZXJ0LnB1c2goZGlyKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gZXhpc3RpbmcgZGly
ZWN0aXZlLCB1cGRhdGUKICAgICAgZGlyLm9sZFZhbHVlID0gb2xkRGlyLnZhbHVlOwogICAgICBj
YWxsSG9vayQxKGRpciwgJ3VwZGF0ZScsIHZub2RlLCBvbGRWbm9kZSk7CiAgICAgIGlmIChkaXIu
ZGVmICYmIGRpci5kZWYuY29tcG9uZW50VXBkYXRlZCkgewogICAgICAgIGRpcnNXaXRoUG9zdHBh
dGNoLnB1c2goZGlyKTsKICAgICAgfQogICAgfQogIH0KCiAgaWYgKGRpcnNXaXRoSW5zZXJ0Lmxl
bmd0aCkgewogICAgdmFyIGNhbGxJbnNlcnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFy
IGkgPSAwOyBpIDwgZGlyc1dpdGhJbnNlcnQubGVuZ3RoOyBpKyspIHsKICAgICAgICBjYWxsSG9v
ayQxKGRpcnNXaXRoSW5zZXJ0W2ldLCAnaW5zZXJ0ZWQnLCB2bm9kZSwgb2xkVm5vZGUpOwogICAg
ICB9CiAgICB9OwogICAgaWYgKGlzQ3JlYXRlKSB7CiAgICAgIG1lcmdlVk5vZGVIb29rKHZub2Rl
LmRhdGEuaG9vayB8fCAodm5vZGUuZGF0YS5ob29rID0ge30pLCAnaW5zZXJ0JywgY2FsbEluc2Vy
dCwgJ2Rpci1pbnNlcnQnKTsKICAgIH0gZWxzZSB7CiAgICAgIGNhbGxJbnNlcnQoKTsKICAgIH0K
ICB9CgogIGlmIChkaXJzV2l0aFBvc3RwYXRjaC5sZW5ndGgpIHsKICAgIG1lcmdlVk5vZGVIb29r
KHZub2RlLmRhdGEuaG9vayB8fCAodm5vZGUuZGF0YS5ob29rID0ge30pLCAncG9zdHBhdGNoJywg
ZnVuY3Rpb24gKCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpcnNXaXRoUG9zdHBhdGNo
Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY2FsbEhvb2skMShkaXJzV2l0aFBvc3RwYXRjaFtpXSwg
J2NvbXBvbmVudFVwZGF0ZWQnLCB2bm9kZSwgb2xkVm5vZGUpOwogICAgICB9CiAgICB9LCAnZGly
LXBvc3RwYXRjaCcpOwogIH0KCiAgaWYgKCFpc0NyZWF0ZSkgewogICAgZm9yIChrZXkgaW4gb2xk
RGlycykgewogICAgICBpZiAoIW5ld0RpcnNba2V5XSkgewogICAgICAgIC8vIG5vIGxvbmdlciBw
cmVzZW50LCB1bmJpbmQKICAgICAgICBjYWxsSG9vayQxKG9sZERpcnNba2V5XSwgJ3VuYmluZCcs
IG9sZFZub2RlKTsKICAgICAgfQogICAgfQogIH0KfQoKdmFyIGVtcHR5TW9kaWZpZXJzID0gT2Jq
ZWN0LmNyZWF0ZShudWxsKTsKCmZ1bmN0aW9uIG5vcm1hbGl6ZURpcmVjdGl2ZXMkMSAoCiAgZGly
cywKICB2bQopIHsKICB2YXIgcmVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICBpZiAoIWRpcnMp
IHsKICAgIHJldHVybiByZXMKICB9CiAgdmFyIGksIGRpcjsKICBmb3IgKGkgPSAwOyBpIDwgZGly
cy5sZW5ndGg7IGkrKykgewogICAgZGlyID0gZGlyc1tpXTsKICAgIGlmICghZGlyLm1vZGlmaWVy
cykgewogICAgICBkaXIubW9kaWZpZXJzID0gZW1wdHlNb2RpZmllcnM7CiAgICB9CiAgICByZXNb
Z2V0UmF3RGlyTmFtZShkaXIpXSA9IGRpcjsKICAgIGRpci5kZWYgPSByZXNvbHZlQXNzZXQodm0u
JG9wdGlvbnMsICdkaXJlY3RpdmVzJywgZGlyLm5hbWUsIHRydWUpOwogIH0KICByZXR1cm4gcmVz
Cn0KCmZ1bmN0aW9uIGdldFJhd0Rpck5hbWUgKGRpcikgewogIHJldHVybiBkaXIucmF3TmFtZSB8
fCAoKGRpci5uYW1lKSArICIuIiArIChPYmplY3Qua2V5cyhkaXIubW9kaWZpZXJzIHx8IHt9KS5q
b2luKCcuJykpKQp9CgpmdW5jdGlvbiBjYWxsSG9vayQxIChkaXIsIGhvb2ssIHZub2RlLCBvbGRW
bm9kZSkgewogIHZhciBmbiA9IGRpci5kZWYgJiYgZGlyLmRlZltob29rXTsKICBpZiAoZm4pIHsK
ICAgIGZuKHZub2RlLmVsbSwgZGlyLCB2bm9kZSwgb2xkVm5vZGUpOwogIH0KfQoKdmFyIGJhc2VN
b2R1bGVzID0gWwogIHJlZiwKICBkaXJlY3RpdmVzCl07CgovKiAgKi8KCmZ1bmN0aW9uIHVwZGF0
ZUF0dHJzIChvbGRWbm9kZSwgdm5vZGUpIHsKICBpZiAoIW9sZFZub2RlLmRhdGEuYXR0cnMgJiYg
IXZub2RlLmRhdGEuYXR0cnMpIHsKICAgIHJldHVybgogIH0KICB2YXIga2V5LCBjdXIsIG9sZDsK
ICB2YXIgZWxtID0gdm5vZGUuZWxtOwogIHZhciBvbGRBdHRycyA9IG9sZFZub2RlLmRhdGEuYXR0
cnMgfHwge307CiAgdmFyIGF0dHJzID0gdm5vZGUuZGF0YS5hdHRycyB8fCB7fTsKICAvLyBjbG9u
ZSBvYnNlcnZlZCBvYmplY3RzLCBhcyB0aGUgdXNlciBwcm9iYWJseSB3YW50cyB0byBtdXRhdGUg
aXQKICBpZiAoYXR0cnMuX19vYl9fKSB7CiAgICBhdHRycyA9IHZub2RlLmRhdGEuYXR0cnMgPSBl
eHRlbmQoe30sIGF0dHJzKTsKICB9CgogIGZvciAoa2V5IGluIGF0dHJzKSB7CiAgICBjdXIgPSBh
dHRyc1trZXldOwogICAgb2xkID0gb2xkQXR0cnNba2V5XTsKICAgIGlmIChvbGQgIT09IGN1cikg
ewogICAgICBzZXRBdHRyKGVsbSwga2V5LCBjdXIpOwogICAgfQogIH0KICAvLyAjNDM5MTogaW4g
SUU5LCBzZXR0aW5nIHR5cGUgY2FuIHJlc2V0IHZhbHVlIGZvciBpbnB1dFt0eXBlPXJhZGlvXQog
IC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogIGlmIChpc0lFOSAmJiBhdHRycy52YWx1ZSAhPT0g
b2xkQXR0cnMudmFsdWUpIHsKICAgIHNldEF0dHIoZWxtLCAndmFsdWUnLCBhdHRycy52YWx1ZSk7
CiAgfQogIGZvciAoa2V5IGluIG9sZEF0dHJzKSB7CiAgICBpZiAoYXR0cnNba2V5XSA9PSBudWxs
KSB7CiAgICAgIGlmIChpc1hsaW5rKGtleSkpIHsKICAgICAgICBlbG0ucmVtb3ZlQXR0cmlidXRl
TlMoeGxpbmtOUywgZ2V0WGxpbmtQcm9wKGtleSkpOwogICAgICB9IGVsc2UgaWYgKCFpc0VudW1l
cmF0ZWRBdHRyKGtleSkpIHsKICAgICAgICBlbG0ucmVtb3ZlQXR0cmlidXRlKGtleSk7CiAgICAg
IH0KICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHNldEF0dHIgKGVsLCBrZXksIHZhbHVlKSB7CiAgaWYg
KGlzQm9vbGVhbkF0dHIoa2V5KSkgewogICAgLy8gc2V0IGF0dHJpYnV0ZSBmb3IgYmxhbmsgdmFs
dWUKICAgIC8vIGUuZy4gPG9wdGlvbiBkaXNhYmxlZD5TZWxlY3Qgb25lPC9vcHRpb24+CiAgICBp
ZiAoaXNGYWxzeUF0dHJWYWx1ZSh2YWx1ZSkpIHsKICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKGtl
eSk7CiAgICB9IGVsc2UgewogICAgICBlbC5zZXRBdHRyaWJ1dGUoa2V5LCBrZXkpOwogICAgfQog
IH0gZWxzZSBpZiAoaXNFbnVtZXJhdGVkQXR0cihrZXkpKSB7CiAgICBlbC5zZXRBdHRyaWJ1dGUo
a2V5LCBpc0ZhbHN5QXR0clZhbHVlKHZhbHVlKSB8fCB2YWx1ZSA9PT0gJ2ZhbHNlJyA/ICdmYWxz
ZScgOiAndHJ1ZScpOwogIH0gZWxzZSBpZiAoaXNYbGluayhrZXkpKSB7CiAgICBpZiAoaXNGYWxz
eUF0dHJWYWx1ZSh2YWx1ZSkpIHsKICAgICAgZWwucmVtb3ZlQXR0cmlidXRlTlMoeGxpbmtOUywg
Z2V0WGxpbmtQcm9wKGtleSkpOwogICAgfSBlbHNlIHsKICAgICAgZWwuc2V0QXR0cmlidXRlTlMo
eGxpbmtOUywga2V5LCB2YWx1ZSk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmIChpc0ZhbHN5QXR0
clZhbHVlKHZhbHVlKSkgewogICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoa2V5KTsKICAgIH0gZWxz
ZSB7CiAgICAgIGVsLnNldEF0dHJpYnV0ZShrZXksIHZhbHVlKTsKICAgIH0KICB9Cn0KCnZhciBh
dHRycyA9IHsKICBjcmVhdGU6IHVwZGF0ZUF0dHJzLAogIHVwZGF0ZTogdXBkYXRlQXR0cnMKfTsK
Ci8qICAqLwoKZnVuY3Rpb24gdXBkYXRlQ2xhc3MgKG9sZFZub2RlLCB2bm9kZSkgewogIHZhciBl
bCA9IHZub2RlLmVsbTsKICB2YXIgZGF0YSA9IHZub2RlLmRhdGE7CiAgdmFyIG9sZERhdGEgPSBv
bGRWbm9kZS5kYXRhOwogIGlmICghZGF0YS5zdGF0aWNDbGFzcyAmJiAhZGF0YS5jbGFzcyAmJgog
ICAgICAoIW9sZERhdGEgfHwgKCFvbGREYXRhLnN0YXRpY0NsYXNzICYmICFvbGREYXRhLmNsYXNz
KSkpIHsKICAgIHJldHVybgogIH0KCiAgdmFyIGNscyA9IGdlbkNsYXNzRm9yVm5vZGUodm5vZGUp
OwoKICAvLyBoYW5kbGUgdHJhbnNpdGlvbiBjbGFzc2VzCiAgdmFyIHRyYW5zaXRpb25DbGFzcyA9
IGVsLl90cmFuc2l0aW9uQ2xhc3NlczsKICBpZiAodHJhbnNpdGlvbkNsYXNzKSB7CiAgICBjbHMg
PSBjb25jYXQoY2xzLCBzdHJpbmdpZnlDbGFzcyh0cmFuc2l0aW9uQ2xhc3MpKTsKICB9CgogIC8v
IHNldCB0aGUgY2xhc3MKICBpZiAoY2xzICE9PSBlbC5fcHJldkNsYXNzKSB7CiAgICBlbC5zZXRB
dHRyaWJ1dGUoJ2NsYXNzJywgY2xzKTsKICAgIGVsLl9wcmV2Q2xhc3MgPSBjbHM7CiAgfQp9Cgp2
YXIga2xhc3MgPSB7CiAgY3JlYXRlOiB1cGRhdGVDbGFzcywKICB1cGRhdGU6IHVwZGF0ZUNsYXNz
Cn07CgovKiAgKi8KCnZhciB0YXJnZXQ7CgpmdW5jdGlvbiBhZGQkMSAoZXZlbnQsIGhhbmRsZXIs
IG9uY2UsIGNhcHR1cmUpIHsKICBpZiAob25jZSkgewogICAgdmFyIG9sZEhhbmRsZXIgPSBoYW5k
bGVyOwogICAgaGFuZGxlciA9IGZ1bmN0aW9uIChldikgewogICAgICByZW1vdmUkMihldmVudCwg
aGFuZGxlciwgY2FwdHVyZSk7CiAgICAgIGFyZ3VtZW50cy5sZW5ndGggPT09IDEKICAgICAgICA/
IG9sZEhhbmRsZXIoZXYpCiAgICAgICAgOiBvbGRIYW5kbGVyLmFwcGx5KG51bGwsIGFyZ3VtZW50
cyk7CiAgICB9OwogIH0KICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwg
Y2FwdHVyZSk7Cn0KCmZ1bmN0aW9uIHJlbW92ZSQyIChldmVudCwgaGFuZGxlciwgY2FwdHVyZSkg
ewogIHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBjYXB0dXJlKTsK
fQoKZnVuY3Rpb24gdXBkYXRlRE9NTGlzdGVuZXJzIChvbGRWbm9kZSwgdm5vZGUpIHsKICBpZiAo
IW9sZFZub2RlLmRhdGEub24gJiYgIXZub2RlLmRhdGEub24pIHsKICAgIHJldHVybgogIH0KICB2
YXIgb24gPSB2bm9kZS5kYXRhLm9uIHx8IHt9OwogIHZhciBvbGRPbiA9IG9sZFZub2RlLmRhdGEu
b24gfHwge307CiAgdGFyZ2V0ID0gdm5vZGUuZWxtOwogIHVwZGF0ZUxpc3RlbmVycyhvbiwgb2xk
T24sIGFkZCQxLCByZW1vdmUkMiwgdm5vZGUuY29udGV4dCk7Cn0KCnZhciBldmVudHMgPSB7CiAg
Y3JlYXRlOiB1cGRhdGVET01MaXN0ZW5lcnMsCiAgdXBkYXRlOiB1cGRhdGVET01MaXN0ZW5lcnMK
fTsKCi8qICAqLwoKZnVuY3Rpb24gdXBkYXRlRE9NUHJvcHMgKG9sZFZub2RlLCB2bm9kZSkgewog
IGlmICghb2xkVm5vZGUuZGF0YS5kb21Qcm9wcyAmJiAhdm5vZGUuZGF0YS5kb21Qcm9wcykgewog
ICAgcmV0dXJuCiAgfQogIHZhciBrZXksIGN1cjsKICB2YXIgZWxtID0gdm5vZGUuZWxtOwogIHZh
ciBvbGRQcm9wcyA9IG9sZFZub2RlLmRhdGEuZG9tUHJvcHMgfHwge307CiAgdmFyIHByb3BzID0g
dm5vZGUuZGF0YS5kb21Qcm9wcyB8fCB7fTsKICAvLyBjbG9uZSBvYnNlcnZlZCBvYmplY3RzLCBh
cyB0aGUgdXNlciBwcm9iYWJseSB3YW50cyB0byBtdXRhdGUgaXQKICBpZiAocHJvcHMuX19vYl9f
KSB7CiAgICBwcm9wcyA9IHZub2RlLmRhdGEuZG9tUHJvcHMgPSBleHRlbmQoe30sIHByb3BzKTsK
ICB9CgogIGZvciAoa2V5IGluIG9sZFByb3BzKSB7CiAgICBpZiAocHJvcHNba2V5XSA9PSBudWxs
KSB7CiAgICAgIGVsbVtrZXldID0gJyc7CiAgICB9CiAgfQogIGZvciAoa2V5IGluIHByb3BzKSB7
CiAgICBjdXIgPSBwcm9wc1trZXldOwogICAgLy8gaWdub3JlIGNoaWxkcmVuIGlmIHRoZSBub2Rl
IGhhcyB0ZXh0Q29udGVudCBvciBpbm5lckhUTUwsCiAgICAvLyBhcyB0aGVzZSB3aWxsIHRocm93
IGF3YXkgZXhpc3RpbmcgRE9NIG5vZGVzIGFuZCBjYXVzZSByZW1vdmFsIGVycm9ycwogICAgLy8g
b24gc3Vic2VxdWVudCBwYXRjaGVzICgjMzM2MCkKICAgIGlmIChrZXkgPT09ICd0ZXh0Q29udGVu
dCcgfHwga2V5ID09PSAnaW5uZXJIVE1MJykgewogICAgICBpZiAodm5vZGUuY2hpbGRyZW4pIHsg
dm5vZGUuY2hpbGRyZW4ubGVuZ3RoID0gMDsgfQogICAgICBpZiAoY3VyID09PSBvbGRQcm9wc1tr
ZXldKSB7IGNvbnRpbnVlIH0KICAgIH0KICAgIGlmIChrZXkgPT09ICd2YWx1ZScpIHsKICAgICAg
Ly8gc3RvcmUgdmFsdWUgYXMgX3ZhbHVlIGFzIHdlbGwgc2luY2UKICAgICAgLy8gbm9uLXN0cmlu
ZyB2YWx1ZXMgd2lsbCBiZSBzdHJpbmdpZmllZAogICAgICBlbG0uX3ZhbHVlID0gY3VyOwogICAg
ICAvLyBhdm9pZCByZXNldHRpbmcgY3Vyc29yIHBvc2l0aW9uIHdoZW4gdmFsdWUgaXMgdGhlIHNh
bWUKICAgICAgdmFyIHN0ckN1ciA9IGN1ciA9PSBudWxsID8gJycgOiBTdHJpbmcoY3VyKTsKICAg
ICAgaWYgKCFlbG0uY29tcG9zaW5nICYmICgKICAgICAgICAoZG9jdW1lbnQuYWN0aXZlRWxlbWVu
dCAhPT0gZWxtICYmIGVsbS52YWx1ZSAhPT0gc3RyQ3VyKSB8fAogICAgICAgIGlzVmFsdWVDaGFu
Z2VkKHZub2RlLCBzdHJDdXIpCiAgICAgICkpIHsKICAgICAgICBlbG0udmFsdWUgPSBzdHJDdXI7
CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGVsbVtrZXldID0gY3VyOwogICAgfQogIH0KfQoK
ZnVuY3Rpb24gaXNWYWx1ZUNoYW5nZWQgKHZub2RlLCBuZXdWYWwpIHsKICB2YXIgdmFsdWUgPSB2
bm9kZS5lbG0udmFsdWU7CiAgdmFyIG1vZGlmaWVycyA9IHZub2RlLmVsbS5fdk1vZGlmaWVyczsg
Ly8gaW5qZWN0ZWQgYnkgdi1tb2RlbCBydW50aW1lCiAgaWYgKChtb2RpZmllcnMgJiYgbW9kaWZp
ZXJzLm51bWJlcikgfHwgdm5vZGUuZWxtLnR5cGUgPT09ICdudW1iZXInKSB7CiAgICByZXR1cm4g
dG9OdW1iZXIodmFsdWUpICE9PSB0b051bWJlcihuZXdWYWwpCiAgfQogIGlmIChtb2RpZmllcnMg
JiYgbW9kaWZpZXJzLnRyaW0pIHsKICAgIHJldHVybiB2YWx1ZS50cmltKCkgIT09IG5ld1ZhbC50
cmltKCkKICB9CiAgcmV0dXJuIHZhbHVlICE9PSBuZXdWYWwKfQoKdmFyIGRvbVByb3BzID0gewog
IGNyZWF0ZTogdXBkYXRlRE9NUHJvcHMsCiAgdXBkYXRlOiB1cGRhdGVET01Qcm9wcwp9OwoKLyog
ICovCgp2YXIgcGFyc2VTdHlsZVRleHQgPSBjYWNoZWQoZnVuY3Rpb24gKGNzc1RleHQpIHsKICB2
YXIgcmVzID0ge307CiAgdmFyIGxpc3REZWxpbWl0ZXIgPSAvOyg/IVteKF0qXCkpL2c7CiAgdmFy
IHByb3BlcnR5RGVsaW1pdGVyID0gLzooLispLzsKICBjc3NUZXh0LnNwbGl0KGxpc3REZWxpbWl0
ZXIpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgIGlmIChpdGVtKSB7CiAgICAgIHZhciB0
bXAgPSBpdGVtLnNwbGl0KHByb3BlcnR5RGVsaW1pdGVyKTsKICAgICAgdG1wLmxlbmd0aCA+IDEg
JiYgKHJlc1t0bXBbMF0udHJpbSgpXSA9IHRtcFsxXS50cmltKCkpOwogICAgfQogIH0pOwogIHJl
dHVybiByZXMKfSk7CgovLyBtZXJnZSBzdGF0aWMgYW5kIGR5bmFtaWMgc3R5bGUgZGF0YSBvbiB0
aGUgc2FtZSB2bm9kZQpmdW5jdGlvbiBub3JtYWxpemVTdHlsZURhdGEgKGRhdGEpIHsKICB2YXIg
c3R5bGUgPSBub3JtYWxpemVTdHlsZUJpbmRpbmcoZGF0YS5zdHlsZSk7CiAgLy8gc3RhdGljIHN0
eWxlIGlzIHByZS1wcm9jZXNzZWQgaW50byBhbiBvYmplY3QgZHVyaW5nIGNvbXBpbGF0aW9uCiAg
Ly8gYW5kIGlzIGFsd2F5cyBhIGZyZXNoIG9iamVjdCwgc28gaXQncyBzYWZlIHRvIG1lcmdlIGlu
dG8gaXQKICByZXR1cm4gZGF0YS5zdGF0aWNTdHlsZQogICAgPyBleHRlbmQoZGF0YS5zdGF0aWNT
dHlsZSwgc3R5bGUpCiAgICA6IHN0eWxlCn0KCi8vIG5vcm1hbGl6ZSBwb3NzaWJsZSBhcnJheSAv
IHN0cmluZyB2YWx1ZXMgaW50byBPYmplY3QKZnVuY3Rpb24gbm9ybWFsaXplU3R5bGVCaW5kaW5n
IChiaW5kaW5nU3R5bGUpIHsKICBpZiAoQXJyYXkuaXNBcnJheShiaW5kaW5nU3R5bGUpKSB7CiAg
ICByZXR1cm4gdG9PYmplY3QoYmluZGluZ1N0eWxlKQogIH0KICBpZiAodHlwZW9mIGJpbmRpbmdT
dHlsZSA9PT0gJ3N0cmluZycpIHsKICAgIHJldHVybiBwYXJzZVN0eWxlVGV4dChiaW5kaW5nU3R5
bGUpCiAgfQogIHJldHVybiBiaW5kaW5nU3R5bGUKfQoKLyoqCiAqIHBhcmVudCBjb21wb25lbnQg
c3R5bGUgc2hvdWxkIGJlIGFmdGVyIGNoaWxkJ3MKICogc28gdGhhdCBwYXJlbnQgY29tcG9uZW50
J3Mgc3R5bGUgY291bGQgb3ZlcnJpZGUgaXQKICovCmZ1bmN0aW9uIGdldFN0eWxlICh2bm9kZSwg
Y2hlY2tDaGlsZCkgewogIHZhciByZXMgPSB7fTsKICB2YXIgc3R5bGVEYXRhOwoKICBpZiAoY2hl
Y2tDaGlsZCkgewogICAgdmFyIGNoaWxkTm9kZSA9IHZub2RlOwogICAgd2hpbGUgKGNoaWxkTm9k
ZS5jaGlsZCkgewogICAgICBjaGlsZE5vZGUgPSBjaGlsZE5vZGUuY2hpbGQuX3Zub2RlOwogICAg
ICBpZiAoY2hpbGROb2RlLmRhdGEgJiYgKHN0eWxlRGF0YSA9IG5vcm1hbGl6ZVN0eWxlRGF0YShj
aGlsZE5vZGUuZGF0YSkpKSB7CiAgICAgICAgZXh0ZW5kKHJlcywgc3R5bGVEYXRhKTsKICAgICAg
fQogICAgfQogIH0KCiAgaWYgKChzdHlsZURhdGEgPSBub3JtYWxpemVTdHlsZURhdGEodm5vZGUu
ZGF0YSkpKSB7CiAgICBleHRlbmQocmVzLCBzdHlsZURhdGEpOwogIH0KCiAgdmFyIHBhcmVudE5v
ZGUgPSB2bm9kZTsKICB3aGlsZSAoKHBhcmVudE5vZGUgPSBwYXJlbnROb2RlLnBhcmVudCkpIHsK
ICAgIGlmIChwYXJlbnROb2RlLmRhdGEgJiYgKHN0eWxlRGF0YSA9IG5vcm1hbGl6ZVN0eWxlRGF0
YShwYXJlbnROb2RlLmRhdGEpKSkgewogICAgICBleHRlbmQocmVzLCBzdHlsZURhdGEpOwogICAg
fQogIH0KICByZXR1cm4gcmVzCn0KCi8qICAqLwoKdmFyIGNzc1ZhclJFID0gL14tLS87CnZhciBp
bXBvcnRhbnRSRSA9IC9ccyohaW1wb3J0YW50JC87CnZhciBzZXRQcm9wID0gZnVuY3Rpb24gKGVs
LCBuYW1lLCB2YWwpIHsKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAoY3NzVmFyUkUu
dGVzdChuYW1lKSkgewogICAgZWwuc3R5bGUuc2V0UHJvcGVydHkobmFtZSwgdmFsKTsKICB9IGVs
c2UgaWYgKGltcG9ydGFudFJFLnRlc3QodmFsKSkgewogICAgZWwuc3R5bGUuc2V0UHJvcGVydHko
bmFtZSwgdmFsLnJlcGxhY2UoaW1wb3J0YW50UkUsICcnKSwgJ2ltcG9ydGFudCcpOwogIH0gZWxz
ZSB7CiAgICBlbC5zdHlsZVtub3JtYWxpemUobmFtZSldID0gdmFsOwogIH0KfTsKCnZhciBwcmVm
aXhlcyA9IFsnV2Via2l0JywgJ01veicsICdtcyddOwoKdmFyIHRlc3RFbDsKdmFyIG5vcm1hbGl6
ZSA9IGNhY2hlZChmdW5jdGlvbiAocHJvcCkgewogIHRlc3RFbCA9IHRlc3RFbCB8fCBkb2N1bWVu
dC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICBwcm9wID0gY2FtZWxpemUocHJvcCk7CiAgaWYgKHBy
b3AgIT09ICdmaWx0ZXInICYmIChwcm9wIGluIHRlc3RFbC5zdHlsZSkpIHsKICAgIHJldHVybiBw
cm9wCiAgfQogIHZhciB1cHBlciA9IHByb3AuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwcm9w
LnNsaWNlKDEpOwogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHsK
ICAgIHZhciBwcmVmaXhlZCA9IHByZWZpeGVzW2ldICsgdXBwZXI7CiAgICBpZiAocHJlZml4ZWQg
aW4gdGVzdEVsLnN0eWxlKSB7CiAgICAgIHJldHVybiBwcmVmaXhlZAogICAgfQogIH0KfSk7Cgpm
dW5jdGlvbiB1cGRhdGVTdHlsZSAob2xkVm5vZGUsIHZub2RlKSB7CiAgdmFyIGRhdGEgPSB2bm9k
ZS5kYXRhOwogIHZhciBvbGREYXRhID0gb2xkVm5vZGUuZGF0YTsKCiAgaWYgKCFkYXRhLnN0YXRp
Y1N0eWxlICYmICFkYXRhLnN0eWxlICYmCiAgICAgICFvbGREYXRhLnN0YXRpY1N0eWxlICYmICFv
bGREYXRhLnN0eWxlKSB7CiAgICByZXR1cm4KICB9CgogIHZhciBjdXIsIG5hbWU7CiAgdmFyIGVs
ID0gdm5vZGUuZWxtOwogIHZhciBvbGRTdGF0aWNTdHlsZSA9IG9sZFZub2RlLmRhdGEuc3RhdGlj
U3R5bGU7CiAgdmFyIG9sZFN0eWxlQmluZGluZyA9IG9sZFZub2RlLmRhdGEuc3R5bGUgfHwge307
CgogIC8vIGlmIHN0YXRpYyBzdHlsZSBleGlzdHMsIHN0eWxlYmluZGluZyBhbHJlYWR5IG1lcmdl
ZCBpbnRvIGl0IHdoZW4gZG9pbmcgbm9ybWFsaXplU3R5bGVEYXRhCiAgdmFyIG9sZFN0eWxlID0g
b2xkU3RhdGljU3R5bGUgfHwgb2xkU3R5bGVCaW5kaW5nOwoKICB2YXIgc3R5bGUgPSBub3JtYWxp
emVTdHlsZUJpbmRpbmcodm5vZGUuZGF0YS5zdHlsZSkgfHwge307CgogIHZub2RlLmRhdGEuc3R5
bGUgPSBzdHlsZS5fX29iX18gPyBleHRlbmQoe30sIHN0eWxlKSA6IHN0eWxlOwoKICB2YXIgbmV3
U3R5bGUgPSBnZXRTdHlsZSh2bm9kZSwgdHJ1ZSk7CgogIGZvciAobmFtZSBpbiBvbGRTdHlsZSkg
ewogICAgaWYgKG5ld1N0eWxlW25hbWVdID09IG51bGwpIHsKICAgICAgc2V0UHJvcChlbCwgbmFt
ZSwgJycpOwogICAgfQogIH0KICBmb3IgKG5hbWUgaW4gbmV3U3R5bGUpIHsKICAgIGN1ciA9IG5l
d1N0eWxlW25hbWVdOwogICAgaWYgKGN1ciAhPT0gb2xkU3R5bGVbbmFtZV0pIHsKICAgICAgLy8g
aWU5IHNldHRpbmcgdG8gbnVsbCBoYXMgbm8gZWZmZWN0LCBtdXN0IHVzZSBlbXB0eSBzdHJpbmcK
ICAgICAgc2V0UHJvcChlbCwgbmFtZSwgY3VyID09IG51bGwgPyAnJyA6IGN1cik7CiAgICB9CiAg
fQp9Cgp2YXIgc3R5bGUgPSB7CiAgY3JlYXRlOiB1cGRhdGVTdHlsZSwKICB1cGRhdGU6IHVwZGF0
ZVN0eWxlCn07CgovKiAgKi8KCi8qKgogKiBBZGQgY2xhc3Mgd2l0aCBjb21wYXRpYmlsaXR5IGZv
ciBTVkcgc2luY2UgY2xhc3NMaXN0IGlzIG5vdCBzdXBwb3J0ZWQgb24KICogU1ZHIGVsZW1lbnRz
IGluIElFCiAqLwpmdW5jdGlvbiBhZGRDbGFzcyAoZWwsIGNscykgewogIC8qIGlzdGFuYnVsIGln
bm9yZSBpZiAqLwogIGlmICghY2xzIHx8ICFjbHMudHJpbSgpKSB7CiAgICByZXR1cm4KICB9Cgog
IC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovCiAgaWYgKGVsLmNsYXNzTGlzdCkgewogICAgaWYg
KGNscy5pbmRleE9mKCcgJykgPiAtMSkgewogICAgICBjbHMuc3BsaXQoL1xzKy8pLmZvckVhY2go
ZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGVsLmNsYXNzTGlzdC5hZGQoYyk7IH0pOwogICAgfSBlbHNl
IHsKICAgICAgZWwuY2xhc3NMaXN0LmFkZChjbHMpOwogICAgfQogIH0gZWxzZSB7CiAgICB2YXIg
Y3VyID0gJyAnICsgZWwuZ2V0QXR0cmlidXRlKCdjbGFzcycpICsgJyAnOwogICAgaWYgKGN1ci5p
bmRleE9mKCcgJyArIGNscyArICcgJykgPCAwKSB7CiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnY2xh
c3MnLCAoY3VyICsgY2xzKS50cmltKCkpOwogICAgfQogIH0KfQoKLyoqCiAqIFJlbW92ZSBjbGFz
cyB3aXRoIGNvbXBhdGliaWxpdHkgZm9yIFNWRyBzaW5jZSBjbGFzc0xpc3QgaXMgbm90IHN1cHBv
cnRlZCBvbgogKiBTVkcgZWxlbWVudHMgaW4gSUUKICovCmZ1bmN0aW9uIHJlbW92ZUNsYXNzIChl
bCwgY2xzKSB7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKCFjbHMgfHwgIWNscy50
cmltKCkpIHsKICAgIHJldHVybgogIH0KCiAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KICBp
ZiAoZWwuY2xhc3NMaXN0KSB7CiAgICBpZiAoY2xzLmluZGV4T2YoJyAnKSA+IC0xKSB7CiAgICAg
IGNscy5zcGxpdCgvXHMrLykuZm9yRWFjaChmdW5jdGlvbiAoYykgeyByZXR1cm4gZWwuY2xhc3NM
aXN0LnJlbW92ZShjKTsgfSk7CiAgICB9IGVsc2UgewogICAgICBlbC5jbGFzc0xpc3QucmVtb3Zl
KGNscyk7CiAgICB9CiAgfSBlbHNlIHsKICAgIHZhciBjdXIgPSAnICcgKyBlbC5nZXRBdHRyaWJ1
dGUoJ2NsYXNzJykgKyAnICc7CiAgICA=</Default>
</Parameter>

<Parameter name="Frag91664421433626082294730">
<Default>dm0KICAgICAgKTsKICAgIH0gZWxzZSBpZiAoIW9sZCkgewogICAgICBvbmNlID0gbmFtZS5jaGFy
QXQoMCkgPT09ICd+JzsgLy8gUHJlZml4ZWQgbGFzdCwgY2hlY2tlZCBmaXJzdAogICAgICBldmVu
dCA9IG9uY2UgPyBuYW1lLnNsaWNlKDEpIDogbmFtZTsKICAgICAgY2FwdHVyZSA9IGV2ZW50LmNo
YXJBdCgwKSA9PT0gJyEnOwogICAgICBldmVudCA9IGNhcHR1cmUgPyBldmVudC5zbGljZSgxKSA6
IGV2ZW50OwogICAgICBpZiAoQXJyYXkuaXNBcnJheShjdXIpKSB7CiAgICAgICAgYWRkKGV2ZW50
LCAoY3VyLmludm9rZXIgPSBhcnJJbnZva2VyKGN1cikpLCBvbmNlLCBjYXB0dXJlKTsKICAgICAg
fSBlbHNlIHsKICAgICAgICBpZiAoIWN1ci5pbnZva2VyKSB7CiAgICAgICAgICBmbiA9IGN1cjsK
ICAgICAgICAgIGN1ciA9IG9uW25hbWVdID0ge307CiAgICAgICAgICBjdXIuZm4gPSBmbjsKICAg
ICAgICAgIGN1ci5pbnZva2VyID0gZm5JbnZva2VyKGN1cik7CiAgICAgICAgfQogICAgICAgIGFk
ZChldmVudCwgY3VyLmludm9rZXIsIG9uY2UsIGNhcHR1cmUpOwogICAgICB9CiAgICB9IGVsc2Ug
aWYgKGN1ciAhPT0gb2xkKSB7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KG9sZCkpIHsKICAgICAg
ICBvbGQubGVuZ3RoID0gY3VyLmxlbmd0aDsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9s
ZC5sZW5ndGg7IGkrKykgeyBvbGRbaV0gPSBjdXJbaV07IH0KICAgICAgICBvbltuYW1lXSA9IG9s
ZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBvbGQuZm4gPSBjdXI7CiAgICAgICAgb25bbmFtZV0g
PSBvbGQ7CiAgICAgIH0KICAgIH0KICB9CiAgZm9yIChuYW1lIGluIG9sZE9uKSB7CiAgICBpZiAo
IW9uW25hbWVdKSB7CiAgICAgIG9uY2UgPSBuYW1lLmNoYXJBdCgwKSA9PT0gJ34nOyAvLyBQcmVm
aXhlZCBsYXN0LCBjaGVja2VkIGZpcnN0CiAgICAgIGV2ZW50ID0gb25jZSA/IG5hbWUuc2xpY2Uo
MSkgOiBuYW1lOwogICAgICBjYXB0dXJlID0gZXZlbnQuY2hhckF0KDApID09PSAnISc7CiAgICAg
IGV2ZW50ID0gY2FwdHVyZSA/IGV2ZW50LnNsaWNlKDEpIDogZXZlbnQ7CiAgICAgIHJlbW92ZSQk
MShldmVudCwgb2xkT25bbmFtZV0uaW52b2tlciwgY2FwdHVyZSk7CiAgICB9CiAgfQp9CgpmdW5j
dGlvbiBhcnJJbnZva2VyIChhcnIpIHsKICByZXR1cm4gZnVuY3Rpb24gKGV2KSB7CiAgICB2YXIg
YXJndW1lbnRzJDEgPSBhcmd1bWVudHM7CgogICAgdmFyIHNpbmdsZSA9IGFyZ3VtZW50cy5sZW5n
dGggPT09IDE7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAg
ICBzaW5nbGUgPyBhcnJbaV0oZXYpIDogYXJyW2ldLmFwcGx5KG51bGwsIGFyZ3VtZW50cyQxKTsK
ICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGZuSW52b2tlciAobykgewogIHJldHVybiBmdW5jdGlvbiAo
ZXYpIHsKICAgIHZhciBzaW5nbGUgPSBhcmd1bWVudHMubGVuZ3RoID09PSAxOwogICAgc2luZ2xl
ID8gby5mbihldikgOiBvLmZuLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7CiAgfQp9CgovKiAgKi8K
CmZ1bmN0aW9uIG5vcm1hbGl6ZUNoaWxkcmVuIChjaGlsZHJlbikgewogIHJldHVybiBpc1ByaW1p
dGl2ZShjaGlsZHJlbikKICAgID8gW2NyZWF0ZVRleHRWTm9kZShjaGlsZHJlbildCiAgICA6IEFy
cmF5LmlzQXJyYXkoY2hpbGRyZW4pCiAgICAgID8gbm9ybWFsaXplQXJyYXlDaGlsZHJlbihjaGls
ZHJlbikKICAgICAgOiB1bmRlZmluZWQKfQoKZnVuY3Rpb24gbm9ybWFsaXplQXJyYXlDaGlsZHJl
biAoY2hpbGRyZW4sIG5lc3RlZEluZGV4KSB7CiAgdmFyIHJlcyA9IFtdOwogIHZhciBpLCBjLCBs
YXN0OwogIGZvciAoaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykgewogICAgYyA9IGNo
aWxkcmVuW2ldOwogICAgaWYgKGMgPT0gbnVsbCB8fCB0eXBlb2YgYyA9PT0gJ2Jvb2xlYW4nKSB7
IGNvbnRpbnVlIH0KICAgIGxhc3QgPSByZXNbcmVzLmxlbmd0aCAtIDFdOwogICAgLy8gIG5lc3Rl
ZAogICAgaWYgKEFycmF5LmlzQXJyYXkoYykpIHsKICAgICAgcmVzLnB1c2guYXBwbHkocmVzLCBu
b3JtYWxpemVBcnJheUNoaWxkcmVuKGMsICgobmVzdGVkSW5kZXggfHwgJycpICsgIl8iICsgaSkp
KTsKICAgIH0gZWxzZSBpZiAoaXNQcmltaXRpdmUoYykpIHsKICAgICAgaWYgKGxhc3QgJiYgbGFz
dC50ZXh0KSB7CiAgICAgICAgbGFzdC50ZXh0ICs9IFN0cmluZyhjKTsKICAgICAgfSBlbHNlIGlm
IChjICE9PSAnJykgewogICAgICAgIC8vIGNvbnZlcnQgcHJpbWl0aXZlIHRvIHZub2RlCiAgICAg
ICAgcmVzLnB1c2goY3JlYXRlVGV4dFZOb2RlKGMpKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAg
ICAgaWYgKGMudGV4dCAmJiBsYXN0ICYmIGxhc3QudGV4dCkgewogICAgICAgIHJlc1tyZXMubGVu
Z3RoIC0gMV0gPSBjcmVhdGVUZXh0Vk5vZGUobGFzdC50ZXh0ICsgYy50ZXh0KTsKICAgICAgfSBl
bHNlIHsKICAgICAgICAvLyBkZWZhdWx0IGtleSBmb3IgbmVzdGVkIGFycmF5IGNoaWxkcmVuIChs
aWtlbHkgZ2VuZXJhdGVkIGJ5IHYtZm9yKQogICAgICAgIGlmIChjLnRhZyAmJiBjLmtleSA9PSBu
dWxsICYmIG5lc3RlZEluZGV4ICE9IG51bGwpIHsKICAgICAgICAgIGMua2V5ID0gIl9fdmxpc3Qi
ICsgbmVzdGVkSW5kZXggKyAiXyIgKyBpICsgIl9fIjsKICAgICAgICB9CiAgICAgICAgcmVzLnB1
c2goYyk7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHJlcwp9CgovKiAgKi8KCmZ1bmN0aW9u
IGdldEZpcnN0Q29tcG9uZW50Q2hpbGQgKGNoaWxkcmVuKSB7CiAgcmV0dXJuIGNoaWxkcmVuICYm
IGNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoYykgeyByZXR1cm4gYyAmJiBjLmNvbXBvbmVudE9w
dGlvbnM7IH0pWzBdCn0KCi8qICAqLwoKLy8gd3JhcHBlciBmdW5jdGlvbiBmb3IgcHJvdmlkaW5n
IGEgbW9yZSBmbGV4aWJsZSBpbnRlcmZhY2UKLy8gd2l0aG91dCBnZXR0aW5nIHllbGxlZCBhdCBi
eSBmbG93CmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQgKAogIGNvbnRleHQsCiAgdGFnLAogIGRhdGEs
CiAgY2hpbGRyZW4sCiAgbmVlZE5vcm1hbGl6YXRpb24sCiAgYWx3YXlzTm9ybWFsaXplCikgewog
IGlmIChBcnJheS5pc0FycmF5KGRhdGEpIHx8IGlzUHJpbWl0aXZlKGRhdGEpKSB7CiAgICBuZWVk
Tm9ybWFsaXphdGlvbiA9IGNoaWxkcmVuOwogICAgY2hpbGRyZW4gPSBkYXRhOwogICAgZGF0YSA9
IHVuZGVmaW5lZDsKICB9CiAgaWYgKGFsd2F5c05vcm1hbGl6ZSkgeyBuZWVkTm9ybWFsaXphdGlv
biA9IHRydWU7IH0KICByZXR1cm4gX2NyZWF0ZUVsZW1lbnQoY29udGV4dCwgdGFnLCBkYXRhLCBj
aGlsZHJlbiwgbmVlZE5vcm1hbGl6YXRpb24pCn0KCmZ1bmN0aW9uIF9jcmVhdGVFbGVtZW50ICgK
ICBjb250ZXh0LAogIHRhZywKICBkYXRhLAogIGNoaWxkcmVuLAogIG5lZWROb3JtYWxpemF0aW9u
CikgewogIGlmIChkYXRhICYmIGRhdGEuX19vYl9fKSB7CiAgICAiZGV2ZWxvcG1lbnQiICE9PSAn
cHJvZHVjdGlvbicgJiYgd2FybigKICAgICAgIkF2b2lkIHVzaW5nIG9ic2VydmVkIGRhdGEgb2Jq
ZWN0IGFzIHZub2RlIGRhdGE6ICIgKyAoSlNPTi5zdHJpbmdpZnkoZGF0YSkpICsgIlxuIiArCiAg
ICAgICdBbHdheXMgY3JlYXRlIGZyZXNoIHZub2RlIGRhdGEgb2JqZWN0cyBpbiBlYWNoIHJlbmRl
ciEnLAogICAgICBjb250ZXh0CiAgICApOwogICAgcmV0dXJuIGNyZWF0ZUVtcHR5Vk5vZGUoKQog
IH0KICBpZiAoIXRhZykgewogICAgLy8gaW4gY2FzZSBvZiBjb21wb25lbnQgOmlzIHNldCB0byBm
YWxzeSB2YWx1ZQogICAgcmV0dXJuIGNyZWF0ZUVtcHR5Vk5vZGUoKQogIH0KICAvLyBzdXBwb3J0
IHNpbmdsZSBmdW5jdGlvbiBjaGlsZHJlbiBhcyBkZWZhdWx0IHNjb3BlZCBzbG90CiAgaWYgKEFy
cmF5LmlzQXJyYXkoY2hpbGRyZW4pICYmCiAgICAgIHR5cGVvZiBjaGlsZHJlblswXSA9PT0gJ2Z1
bmN0aW9uJykgewogICAgZGF0YSA9IGRhdGEgfHwge307CiAgICBkYXRhLnNjb3BlZFNsb3RzID0g
eyBkZWZhdWx0OiBjaGlsZHJlblswXSB9OwogICAgY2hpbGRyZW4ubGVuZ3RoID0gMDsKICB9CiAg
aWYgKG5lZWROb3JtYWxpemF0aW9uKSB7CiAgICBjaGlsZHJlbiA9IG5vcm1hbGl6ZUNoaWxkcmVu
KGNoaWxkcmVuKTsKICB9CiAgdmFyIHZub2RlLCBuczsKICBpZiAodHlwZW9mIHRhZyA9PT0gJ3N0
cmluZycpIHsKICAgIHZhciBDdG9yOwogICAgbnMgPSBjb25maWcuZ2V0VGFnTmFtZXNwYWNlKHRh
Zyk7CiAgICBpZiAoY29uZmlnLmlzUmVzZXJ2ZWRUYWcodGFnKSkgewogICAgICAvLyBwbGF0Zm9y
bSBidWlsdC1pbiBlbGVtZW50cwogICAgICB2bm9kZSA9IG5ldyBWTm9kZSgKICAgICAgICBjb25m
aWcucGFyc2VQbGF0Zm9ybVRhZ05hbWUodGFnKSwgZGF0YSwgY2hpbGRyZW4sCiAgICAgICAgdW5k
ZWZpbmVkLCB1bmRlZmluZWQsIGNvbnRleHQKICAgICAgKTsKICAgIH0gZWxzZSBpZiAoKEN0b3Ig
PSByZXNvbHZlQXNzZXQoY29udGV4dC4kb3B0aW9ucywgJ2NvbXBvbmVudHMnLCB0YWcpKSkgewog
ICAgICAvLyBjb21wb25lbnQKICAgICAgdm5vZGUgPSBjcmVhdGVDb21wb25lbnQoQ3RvciwgZGF0
YSwgY29udGV4dCwgY2hpbGRyZW4sIHRhZyk7CiAgICB9IGVsc2UgewogICAgICAvLyB1bmtub3du
IG9yIHVubGlzdGVkIG5hbWVzcGFjZWQgZWxlbWVudHMKICAgICAgLy8gY2hlY2sgYXQgcnVudGlt
ZSBiZWNhdXNlIGl0IG1heSBnZXQgYXNzaWduZWQgYSBuYW1lc3BhY2Ugd2hlbiBpdHMKICAgICAg
Ly8gcGFyZW50IG5vcm1hbGl6ZXMgY2hpbGRyZW4KICAgICAgbnMgPSB0YWcgPT09ICdmb3JlaWdu
T2JqZWN0JyA/ICd4aHRtbCcgOiBuczsKICAgICAgdm5vZGUgPSBuZXcgVk5vZGUoCiAgICAgICAg
dGFnLCBkYXRhLCBjaGlsZHJlbiwKICAgICAgICB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29udGV4
dAogICAgICApOwogICAgfQogIH0gZWxzZSB7CiAgICAvLyBkaXJlY3QgY29tcG9uZW50IG9wdGlv
bnMgLyBjb25zdHJ1Y3RvcgogICAgdm5vZGUgPSBjcmVhdGVDb21wb25lbnQodGFnLCBkYXRhLCBj
b250ZXh0LCBjaGlsZHJlbik7CiAgfQogIGlmICh2bm9kZSkgewogICAgaWYgKG5zKSB7IGFwcGx5
TlModm5vZGUsIG5zKTsgfQogICAgcmV0dXJuIHZub2RlCiAgfSBlbHNlIHsKICAgIHJldHVybiBj
cmVhdGVFbXB0eVZOb2RlKCkKICB9Cn0KCmZ1bmN0aW9uIGFwcGx5TlMgKHZub2RlLCBucykgewog
IHZub2RlLm5zID0gbnM7CiAgaWYgKHZub2RlLmNoaWxkcmVuKSB7CiAgICBmb3IgKHZhciBpID0g
MCwgbCA9IHZub2RlLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICB2YXIgY2hp
bGQgPSB2bm9kZS5jaGlsZHJlbltpXTsKICAgICAgaWYgKGNoaWxkLnRhZyAmJiAhY2hpbGQubnMp
IHsKICAgICAgICBhcHBseU5TKGNoaWxkLCBucyk7CiAgICAgIH0KICAgIH0KICB9Cn0KCi8qICAq
LwoKZnVuY3Rpb24gaW5pdFJlbmRlciAodm0pIHsKICB2bS4kdm5vZGUgPSBudWxsOyAvLyB0aGUg
cGxhY2Vob2xkZXIgbm9kZSBpbiBwYXJlbnQgdHJlZQogIHZtLl92bm9kZSA9IG51bGw7IC8vIHRo
ZSByb290IG9mIHRoZSBjaGlsZCB0cmVlCiAgdm0uX3N0YXRpY1RyZWVzID0gbnVsbDsKICB2YXIg
cGFyZW50Vm5vZGUgPSB2bS4kb3B0aW9ucy5fcGFyZW50Vm5vZGU7CiAgdmFyIHJlbmRlckNvbnRl
eHQgPSBwYXJlbnRWbm9kZSAmJiBwYXJlbnRWbm9kZS5jb250ZXh0OwogIHZtLiRzbG90cyA9IHJl
c29sdmVTbG90cyh2bS4kb3B0aW9ucy5fcmVuZGVyQ2hpbGRyZW4sIHJlbmRlckNvbnRleHQpOwog
IHZtLiRzY29wZWRTbG90cyA9IHt9OwogIC8vIGJpbmQgdGhlIGNyZWF0ZUVsZW1lbnQgZm4gdG8g
dGhpcyBpbnN0YW5jZQogIC8vIHNvIHRoYXQgd2UgZ2V0IHByb3BlciByZW5kZXIgY29udGV4dCBp
bnNpZGUgaXQuCiAgLy8gYXJncyBvcmRlcjogdGFnLCBkYXRhLCBjaGlsZHJlbiwgbmVlZE5vcm1h
bGl6YXRpb24sIGFsd2F5c05vcm1hbGl6ZQogIC8vIGludGVybmFsIHZlcnNpb24gaXMgdXNlZCBi
eSByZW5kZXIgZnVuY3Rpb25zIGNvbXBpbGVkIGZyb20gdGVtcGxhdGVzCiAgdm0uX2MgPSBmdW5j
dGlvbiAoYSwgYiwgYywgZCkgeyByZXR1cm4gY3JlYXRlRWxlbWVudCh2bSwgYSwgYiwgYywgZCwg
ZmFsc2UpOyB9OwogIC8vIG5vcm1hbGl6YXRpb24gaXMgYWx3YXlzIGFwcGxpZWQgZm9yIHRoZSBw
dWJsaWMgdmVyc2lvbiwgdXNlZCBpbgogIC8vIHVzZXItd3JpdHRlbiByZW5kZXIgZnVuY3Rpb25z
LgogIHZtLiRjcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgcmV0dXJuIGNy
ZWF0ZUVsZW1lbnQodm0sIGEsIGIsIGMsIGQsIHRydWUpOyB9OwogIGlmICh2bS4kb3B0aW9ucy5l
bCkgewogICAgdm0uJG1vdW50KHZtLiRvcHRpb25zLmVsKTsKICB9Cn0KCmZ1bmN0aW9uIHJlbmRl
ck1peGluIChWdWUpIHsKICBWdWUucHJvdG90eXBlLiRuZXh0VGljayA9IGZ1bmN0aW9uIChmbikg
ewogICAgcmV0dXJuIG5leHRUaWNrKGZuLCB0aGlzKQogIH07CgogIFZ1ZS5wcm90b3R5cGUuX3Jl
bmRlciA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB2bSA9IHRoaXM7CiAgICB2YXIgcmVmID0gdm0u
JG9wdGlvbnM7CiAgICB2YXIgcmVuZGVyID0gcmVmLnJlbmRlcjsKICAgIHZhciBzdGF0aWNSZW5k
ZXJGbnMgPSByZWYuc3RhdGljUmVuZGVyRm5zOwogICAgdmFyIF9wYXJlbnRWbm9kZSA9IHJlZi5f
cGFyZW50Vm5vZGU7CgogICAgaWYgKHZtLl9pc01vdW50ZWQpIHsKICAgICAgLy8gY2xvbmUgc2xv
dCBub2RlcyBvbiByZS1yZW5kZXJzCiAgICAgIGZvciAodmFyIGtleSBpbiB2bS4kc2xvdHMpIHsK
ICAgICAgICB2bS4kc2xvdHNba2V5XSA9IGNsb25lVk5vZGVzKHZtLiRzbG90c1trZXldKTsKICAg
ICAgfQogICAgfQoKICAgIGlmIChfcGFyZW50Vm5vZGUgJiYgX3BhcmVudFZub2RlLmRhdGEuc2Nv
cGVkU2xvdHMpIHsKICAgICAgdm0uJHNjb3BlZFNsb3RzID0gX3BhcmVudFZub2RlLmRhdGEuc2Nv
cGVkU2xvdHM7CiAgICB9CgogICAgaWYgKHN0YXRpY1JlbmRlckZucyAmJiAhdm0uX3N0YXRpY1Ry
ZWVzKSB7CiAgICAgIHZtLl9zdGF0aWNUcmVlcyA9IFtdOwogICAgfQogICAgLy8gc2V0IHBhcmVu
dCB2bm9kZS4gdGhpcyBhbGxvd3MgcmVuZGVyIGZ1bmN0aW9ucyB0byBoYXZlIGFjY2VzcwogICAg
Ly8gdG8gdGhlIGRhdGEgb24gdGhlIHBsYWNlaG9sZGVyIG5vZGUuCiAgICB2bS4kdm5vZGUgPSBf
cGFyZW50Vm5vZGU7CiAgICAvLyByZW5kZXIgc2VsZgogICAgdmFyIHZub2RlOwogICAgdHJ5IHsK
ICAgICAgdm5vZGUgPSByZW5kZXIuY2FsbCh2bS5fcmVuZGVyUHJveHksIHZtLiRjcmVhdGVFbGVt
ZW50KTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8K
ICAgICAgaWYgKGNvbmZpZy5lcnJvckhhbmRsZXIpIHsKICAgICAgICBjb25maWcuZXJyb3JIYW5k
bGVyLmNhbGwobnVsbCwgZSwgdm0pOwogICAgICB9IGVsc2UgewogICAgICAgIHsKICAgICAgICAg
IHdhcm4oKCJFcnJvciB3aGVuIHJlbmRlcmluZyAiICsgKGZvcm1hdENvbXBvbmVudE5hbWUodm0p
KSArICI6IikpOwogICAgICAgIH0KICAgICAgICB0aHJvdyBlCiAgICAgIH0KICAgICAgLy8gcmV0
dXJuIHByZXZpb3VzIHZub2RlIHRvIHByZXZlbnQgcmVuZGVyIGVycm9yIGNhdXNpbmcgYmxhbmsg
Y29tcG9uZW50CiAgICAgIHZub2RlID0gdm0uX3Zub2RlOwogICAgfQogICAgLy8gcmV0dXJuIGVt
cHR5IHZub2RlIGluIGNhc2UgdGhlIHJlbmRlciBmdW5jdGlvbiBlcnJvcmVkIG91dAogICAgaWYg
KCEodm5vZGUgaW5zdGFuY2VvZiBWTm9kZSkpIHsKICAgICAgaWYgKCJkZXZlbG9wbWVudCIgIT09
ICdwcm9kdWN0aW9uJyAmJiBBcnJheS5pc0FycmF5KHZub2RlKSkgewogICAgICAgIHdhcm4oCiAg
ICAgICAgICAnTXVsdGlwbGUgcm9vdCBub2RlcyByZXR1cm5lZCBmcm9tIHJlbmRlciBmdW5jdGlv
bi4gUmVuZGVyIGZ1bmN0aW9uICcgKwogICAgICAgICAgJ3Nob3VsZCByZXR1cm4gYSBzaW5nbGUg
cm9vdCBub2RlLicsCiAgICAgICAgICB2bQogICAgICAgICk7CiAgICAgIH0KICAgICAgdm5vZGUg
PSBjcmVhdGVFbXB0eVZOb2RlKCk7CiAgICB9CiAgICAvLyBzZXQgcGFyZW50CiAgICB2bm9kZS5w
YXJlbnQgPSBfcGFyZW50Vm5vZGU7CiAgICByZXR1cm4gdm5vZGUKICB9OwoKICAvLyB0b1N0cmlu
ZyBmb3IgbXVzdGFjaGVzCiAgVnVlLnByb3RvdHlwZS5fcyA9IF90b1N0cmluZzsKICAvLyBjb252
ZXJ0IHRleHQgdG8gdm5vZGUKICBWdWUucHJvdG90eXBlLl92ID0gY3JlYXRlVGV4dFZOb2RlOwog
IC8vIG51bWJlciBjb252ZXJzaW9uCiAgVnVlLnByb3RvdHlwZS5fbiA9IHRvTnVtYmVyOwogIC8v
IGVtcHR5IHZub2RlCiAgVnVlLnByb3RvdHlwZS5fZSA9IGNyZWF0ZUVtcHR5Vk5vZGU7CiAgLy8g
bG9vc2UgZXF1YWwKICBWdWUucHJvdG90eXBlLl9xID0gbG9vc2VFcXVhbDsKICAvLyBsb29zZSBp
bmRleE9mCiAgVnVlLnByb3RvdHlwZS5faSA9IGxvb3NlSW5kZXhPZjsKCiAgLy8gcmVuZGVyIHN0
YXRpYyB0cmVlIGJ5IGluZGV4CiAgVnVlLnByb3RvdHlwZS5fbSA9IGZ1bmN0aW9uIHJlbmRlclN0
YXRpYyAoCiAgICBpbmRleCwKICAgIGlzSW5Gb3IKICApIHsKICAgIHZhciB0cmVlID0gdGhpcy5f
c3RhdGljVHJlZXNbaW5kZXhdOwogICAgLy8gaWYgaGFzIGFscmVhZHktcmVuZGVyZWQgc3RhdGlj
IHRyZWUgYW5kIG5vdCBpbnNpZGUgdi1mb3IsCiAgICAvLyB3ZSBjYW4gcmV1c2UgdGhlIHNhbWUg
dHJlZSBieSBkb2luZyBhIHNoYWxsb3cgY2xvbmUuCiAgICBpZiAodHJlZSAmJiAhaXNJbkZvcikg
ewogICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0cmVlKQogICAgICAgID8gY2xvbmVWTm9kZXMo
dHJlZSkKICAgICAgICA6IGNsb25lVk5vZGUodHJlZSkKICAgIH0KICAgIC8vIG90aGVyd2lzZSwg
cmVuZGVyIGEgZnJlc2ggdHJlZS4KICAgIHRyZWUgPSB0aGlzLl9zdGF0aWNUcmVlc1tpbmRleF0g
PSB0aGlzLiRvcHRpb25zLnN0YXRpY1JlbmRlckZuc1tpbmRleF0uY2FsbCh0aGlzLl9yZW5kZXJQ
cm94eSk7CiAgICBtYXJrU3RhdGljKHRyZWUsICgiX19zdGF0aWNfXyIgKyBpbmRleCksIGZhbHNl
KTsKICAgIHJldHVybiB0cmVlCiAgfTsKCiAgLy8gbWFyayBub2RlIGFzIHN0YXRpYyAodi1vbmNl
KQogIFZ1ZS5wcm90b3R5cGUuX28gPSBmdW5jdGlvbiBtYXJrT25jZSAoCiAgICB0cmVlLAogICAg
aW5kZXgsCiAgICBrZXkKICApIHsKICAgIG1hcmtTdGF0aWModHJlZSwgKCJfX29uY2VfXyIgKyBp
bmRleCArIChrZXkgPyAoIl8iICsga2V5KSA6ICIiKSksIHRydWUpOwogICAgcmV0dXJuIHRyZWUK
ICB9OwoKICBmdW5jdGlvbiBtYXJrU3RhdGljICh0cmVlLCBrZXksIGlzT25jZSkgewogICAgaWYg
KEFycmF5LmlzQXJyYXkodHJlZSkpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmVlLmxl
bmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRyZWVbaV0gJiYgdHlwZW9mIHRyZWVbaV0gIT09ICdz
dHJpbmcnKSB7CiAgICAgICAgICBtYXJrU3RhdGljTm9kZSh0cmVlW2ldLCAoa2V5ICsgIl8iICsg
aSksIGlzT25jZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBtYXJrU3Rh
dGljTm9kZSh0cmVlLCBrZXksIGlzT25jZSk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBtYXJrU3Rh
dGljTm9kZSAobm9kZSwga2V5LCBpc09uY2UpIHsKICAgIG5vZGUuaXNTdGF0aWMgPSB0cnVlOwog
ICAgbm9kZS5rZXkgPSBrZXk7CiAgICBub2RlLmlzT25jZSA9IGlzT25jZTsKICB9CgogIC8vIGZp
bHRlciByZXNvbHV0aW9uIGhlbHBlcgogIFZ1ZS5wcm90b3R5cGUuX2YgPSBmdW5jdGlvbiByZXNv
bHZlRmlsdGVyIChpZCkgewogICAgcmV0dXJuIHJlc29sdmVBc3NldCh0aGlzLiRvcHRpb25zLCAn
ZmlsdGVycycsIGlkLCB0cnVlKSB8fCBpZGVudGl0eQogIH07CgogIC8vIHJlbmRlciB2LWZvcgog
IFZ1ZS5wcm90b3R5cGUuX2wgPSBmdW5jdGlvbiByZW5kZXJMaXN0ICgKICAgIHZhbCwKICAgIHJl
bmRlcgogICkgewogICAgdmFyIHJldCwgaSwgbCwga2V5cywga2V5OwogICAgaWYgKEFycmF5Lmlz
QXJyYXkodmFsKSkgewogICAgICByZXQgPSBuZXcgQXJyYXkodmFsLmxlbmd0aCk7CiAgICAgIGZv
ciAoaSA9IDAsIGwgPSB2YWwubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgcmV0W2ldID0g
cmVuZGVyKHZhbFtpXSwgaSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0g
J251bWJlcicpIHsKICAgICAgcmV0ID0gbmV3IEFycmF5KHZhbCk7CiAgICAgIGZvciAoaSA9IDA7
IGkgPCB2YWw7IGkrKykgewogICAgICAgIHJldFtpXSA9IHJlbmRlcihpICsgMSwgaSk7CiAgICAg
IH0KICAgIH0gZWxzZSBpZiAoaXNPYmplY3QodmFsKSkgewogICAgICBrZXlzID0gT2JqZWN0Lmtl
eXModmFsKTsKICAgICAgcmV0ID0gbmV3IEFycmF5KGtleXMubGVuZ3RoKTsKICAgICAgZm9yIChp
ID0gMCwgbCA9IGtleXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAga2V5ID0ga2V5c1tp
XTsKICAgICAgICByZXRbaV0gPSByZW5kZXIodmFsW2tleV0sIGtleSwgaSk7CiAgICAgIH0KICAg
IH0KICAgIHJldHVybiByZXQKICB9OwoKICAvLyByZW5kZXJTbG90CiAgVnVlLnByb3RvdHlwZS5f
dCA9IGZ1bmN0aW9uICgKICAgIG5hbWUsCiAgICBmYWxsYmFjaywKICAgIHByb3BzCiAgKSB7CiAg
ICB2YXIgc2NvcGVkU2xvdEZuID0gdGhpcy4kc2NvcGVkU2xvdHNbbmFtZV07CiAgICBpZiAoc2Nv
cGVkU2xvdEZuKSB7IC8vIHNjb3BlZCBzbG90CiAgICAgIHJldHVybiBzY29wZWRTbG90Rm4ocHJv
cHMgfHwge30pIHx8IGZhbGxiYWNrCiAgICB9IGVsc2UgewogICAgICB2YXIgc2xvdE5vZGVzID0g
dGhpcy4kc2xvdHNbbmFtZV07CiAgICAgIC8vIHdhcm4gZHVwbGljYXRlIHNsb3QgdXNhZ2UKICAg
ICAgaWYgKHNsb3ROb2RlcyAmJiAiZGV2ZWxvcG1lbnQiICE9PSAncHJvZHVjdGlvbicpIHsKICAg
ICAgICBzbG90Tm9kZXMuX3JlbmRlcmVkICYmIHdhcm4oCiAgICAgICAgICAiRHVwbGljYXRlIHBy
ZXNlbmNlIG9mIHNsb3QgXCIiICsgbmFtZSArICJcIiBmb3VuZCBpbiB0aGUgc2FtZSByZW5kZXIg
dHJlZSAiICsKICAgICAgICAgICItIHRoaXMgd2lsbCBsaWtlbHkgY2F1c2UgcmVuZGVyIGVycm9y
cy4iLAogICAgICAgICAgdGhpcwogICAgICAgICk7CiAgICAgICAgc2xvdE5vZGVzLl9yZW5kZXJl
ZCA9IHRydWU7CiAgICAgIH0KICAgICAgcmV0dXJuIHNsb3ROb2RlcyB8fCBmYWxsYmFjawogICAg
fQogIH07CgogIC8vIGFwcGx5IHYtYmluZCBvYmplY3QKICBWdWUucHJvdG90eXBlLl9iID0gZnVu
Y3Rpb24gYmluZFByb3BzICgKICAgIGRhdGEsCiAgICB0YWcsCiAgICB2YWx1ZSwKICAgIGFzUHJv
cAogICkgewogICAgaWYgKHZhbHVlKSB7CiAgICAgIGlmICghaXNPYmplY3QodmFsdWUpKSB7CiAg
ICAgICAgImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oCiAgICAgICAgICAn
di1iaW5kIHdpdGhvdXQgYXJndW1lbnQgZXhwZWN0cyBhbiBPYmplY3Qgb3IgQXJyYXkgdmFsdWUn
LAogICAgICAgICAgdGhpcwogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKEFy
cmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgICAgICB2YWx1ZSA9IHRvT2JqZWN0KHZhbHVlKTsK
ICAgICAgICB9CiAgICAgICAgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7CiAgICAgICAgICBpZiAo
a2V5ID09PSAnY2xhc3MnIHx8IGtleSA9PT0gJ3N0eWxlJykgewogICAgICAgICAgICBkYXRhW2tl
eV0gPSB2YWx1ZVtrZXldOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIGhhc2gg
PSBhc1Byb3AgfHwgY29uZmlnLm11c3RVc2VQcm9wKHRhZywga2V5KQogICAgICAgICAgICAgID8g
ZGF0YS5kb21Qcm9wcyB8fCAoZGF0YS5kb21Qcm9wcyA9IHt9KQogICAgICAgICAgICAgIDogZGF0
YS5hdHRycyB8fCAoZGF0YS5hdHRycyA9IHt9KTsKICAgICAgICAgICAgaGFzaFtrZXldID0gdmFs
dWVba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBk
YXRhCiAgfTsKCiAgLy8gY2hlY2sgdi1vbiBrZXlDb2RlcwogIFZ1ZS5wcm90b3R5cGUuX2sgPSBm
dW5jdGlvbiBjaGVja0tleUNvZGVzICgKICAgIGV2ZW50S2V5Q29kZSwKICAgIGtleSwKICAgIGJ1
aWx0SW5BbGlhcwogICkgewogICAgdmFyIGtleUNvZGVzID0gY29uZmlnLmtleUNvZGVzW2tleV0g
fHwgYnVpbHRJbkFsaWFzOwogICAgaWYgKEFycmF5LmlzQXJyYXkoa2V5Q29kZXMpKSB7CiAgICAg
IHJldHVybiBrZXlDb2Rlcy5pbmRleE9mKGV2ZW50S2V5Q29kZSkgPT09IC0xCiAgICB9IGVsc2Ug
ewogICAgICByZXR1cm4ga2V5Q29kZXMgIT09IGV2ZW50S2V5Q29kZQogICAgfQogIH07Cn0KCmZ1
bmN0aW9uIHJlc29sdmVTbG90cyAoCiAgY2hpbGRyZW4sCiAgY29udGV4dAopIHsKICB2YXIgc2xv
dHMgPSB7fTsKICBpZiAoIWNoaWxkcmVuKSB7CiAgICByZXR1cm4gc2xvdHMKICB9CiAgdmFyIGRl
ZmF1bHRTbG90ID0gW107CiAgdmFyIG5hbWUsIGNoaWxkOwogIGZvciAodmFyIGkgPSAwLCBsID0g
Y2hpbGRyZW4ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICBjaGlsZCA9IGNoaWxkcmVuW2ldOwog
ICAgLy8gbmFtZWQgc2xvdHMgc2hvdWxkIG9ubHkgYmUgcmVzcGVjdGVkIGlmIHRoZSB2bm9kZSB3
YXMgcmVuZGVyZWQgaW4gdGhlCiAgICAvLyBzYW1lIGNvbnRleHQuCiAgICBpZiAoKGNoaWxkLmNv
bnRleHQgPT09IGNvbnRleHQgfHwgY2hpbGQuZnVuY3Rpb25hbENvbnRleHQgPT09IGNvbnRleHQp
ICYmCiAgICAgICAgY2hpbGQuZGF0YSAmJiAobmFtZSA9IGNoaWxkLmRhdGEuc2xvdCkpIHsKICAg
ICAgdmFyIHNsb3QgPSAoc2xvdHNbbmFtZV0gfHwgKHNsb3RzW25hbWVdID0gW10pKTsKICAgICAg
aWYgKGNoaWxkLnRhZyA9PT0gJ3RlbXBsYXRlJykgewogICAgICAgIHNsb3QucHVzaC5hcHBseShz
bG90LCBjaGlsZC5jaGlsZHJlbik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2xvdC5wdXNoKGNo
aWxkKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZGVmYXVsdFNsb3QucHVzaChjaGlsZCk7
CiAgICB9CiAgfQogIC8vIGlnbm9yZSBzaW5nbGUgd2hpdGVzcGFjZQogIGlmIChkZWZhdWx0U2xv
dC5sZW5ndGggJiYgISgKICAgIGRlZmF1bHRTbG90Lmxlbmd0aCA9PT0gMSAmJgogICAgKGRlZmF1
bHRTbG90WzBdLnRleHQgPT09ICcgJyB8fCBkZWZhdWx0U2xvdFswXS5pc0NvbW1lbnQpCiAgKSkg
ewogICAgc2xvdHMuZGVmYXVsdCA9IGRlZmF1bHRTbG90OwogIH0KICByZXR1cm4gc2xvdHMKfQoK
LyogICovCgpmdW5jdGlvbiBpbml0RXZlbnRzICh2bSkgewogIHZtLl9ldmVudHMgPSBPYmplY3Qu
Y3JlYXRlKG51bGwpOwogIC8vIGluaXQgcGFyZW50IGF0dGFjaGVkIGV2ZW50cwogIHZhciBsaXN0
ZW5lcnMgPSB2bS4kb3B0aW9ucy5fcGFyZW50TGlzdGVuZXJzOwogIHZhciBhZGQgPSBmdW5jdGlv
biAoZXZlbnQsIGZuLCBvbmNlKSB7CiAgICBvbmNlID8gdm0uJG9uY2UoZXZlbnQsIGZuKSA6IHZt
LiRvbihldmVudCwgZm4pOwogIH07CiAgdmFyIHJlbW92ZSQkMSA9IGJpbmQkMSh2bS4kb2ZmLCB2
bSk7CiAgdm0uX3VwZGF0ZUxpc3RlbmVycyA9IGZ1bmN0aW9uIChsaXN0ZW5lcnMsIG9sZExpc3Rl
bmVycykgewogICAgdXBkYXRlTGlzdGVuZXJzKGxpc3RlbmVycywgb2xkTGlzdGVuZXJzIHx8IHt9
LCBhZGQsIHJlbW92ZSQkMSwgdm0pOwogIH07CiAgaWYgKGxpc3RlbmVycykgewogICAgdm0uX3Vw
ZGF0ZUxpc3RlbmVycyhsaXN0ZW5lcnMpOwogIH0KfQoKZnVuY3Rpb24gZXZlbnRzTWl4aW4gKFZ1
ZSkgewogIFZ1ZS5wcm90b3R5cGUuJG9uID0gZnVuY3Rpb24gKGV2ZW50LCBmbikgewogICAgdmFy
IHZtID0gdGhpczsodm0uX2V2ZW50c1tldmVudF0gfHwgKHZtLl9ldmVudHNbZXZlbnRdID0gW10p
KS5wdXNoKGZuKTsKICAgIHJldHVybiB2bQogIH07CgogIFZ1ZS5wcm90b3R5cGUuJG9uY2UgPSBm
dW5jdGlvbiAoZXZlbnQsIGZuKSB7CiAgICB2YXIgdm0gPSB0aGlzOwogICAgZnVuY3Rpb24gb24g
KCkgewogICAgICB2bS4kb2ZmKGV2ZW50LCBvbik7CiAgICAgIGZuLmFwcGx5KHZtLCBhcmd1bWVu
dHMpOwogICAgfQogICAgb24uZm4gPSBmbjsKICAgIHZtLiRvbihldmVudCwgb24pOwogICAgcmV0
dXJuIHZtCiAgfTsKCiAgVnVlLnByb3RvdHlwZS4kb2ZmID0gZnVuY3Rpb24gKGV2ZW50LCBmbikg
ewogICAgdmFyIHZtID0gdGhpczsKICAgIC8vIGFsbAogICAgaWYgKCFhcmd1bWVudHMubGVuZ3Ro
KSB7CiAgICAgIHZtLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICByZXR1cm4g
dm0KICAgIH0KICAgIC8vIHNwZWNpZmljIGV2ZW50CiAgICB2YXIgY2JzID0gdm0uX2V2ZW50c1tl
dmVudF07CiAgICBpZiAoIWNicykgewogICAgICByZXR1cm4gdm0KICAgIH0KICAgIGlmIChhcmd1
bWVudHMubGVuZ3RoID09PSAxKSB7CiAgICAgIHZtLl9ldmVudHNbZXZlbnRdID0gbnVsbDsKICAg
ICAgcmV0dXJuIHZtCiAgICB9CiAgICAvLyBzcGVjaWZpYyBoYW5kbGVyCiAgICB2YXIgY2I7CiAg
ICB2YXIgaSA9IGNicy5sZW5ndGg7CiAgICB3aGlsZSAoaS0tKSB7CiAgICAgIGNiID0gY2JzW2ld
OwogICAgICBpZiAoY2IgPT09IGZuIHx8IGNiLmZuID09PSBmbikgewogICAgICAgIGNicy5zcGxp
Y2UoaSwgMSk7CiAgICAgICAgYnJlYWsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHZtCiAgfTsK
CiAgVnVlLnByb3RvdHlwZS4kZW1pdCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgdmFyIHZtID0g
dGhpczsKICAgIHZhciBjYnMgPSB2bS5fZXZlbnRzW2V2ZW50XTsKICAgIGlmIChjYnMpIHsKICAg
ICAgY2JzID0gY2JzLmxlbmd0aCA+IDEgPyB0b0FycmF5KGNicykgOiBjYnM7CiAgICAgIHZhciBh
cmdzID0gdG9BcnJheShhcmd1bWVudHMsIDEpOwogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNi
cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjYnNbaV0uYXBwbHkodm0sIGFyZ3MpOwog
ICAgICB9CiAgICB9CiAgICByZXR1cm4gdm0KICB9Owp9CgovKiAgKi8KCnZhciB1aWQgPSAwOwoK
ZnVuY3Rpb24gaW5pdE1peGluIChWdWUpIHsKICBWdWUucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rp
b24gKG9wdGlvbnMpIHsKICAgIHZhciB2bSA9IHRoaXM7CiAgICAvLyBhIHVpZAogICAgdm0uX3Vp
ZCA9IHVpZCsrOwogICAgLy8gYSBmbGFnIHRvIGF2b2lkIHRoaXMgYmVpbmcgb2JzZXJ2ZWQKICAg
IHZtLl9pc1Z1ZSA9IHRydWU7CiAgICAvLyBtZXJnZSBvcHRpb25zCiAgICBpZiAob3B0aW9ucyAm
JiBvcHRpb25zLl9pc0NvbXBvbmVudCkgewogICAgICAvLyBvcHRpbWl6ZSBpbnRlcm5hbCBjb21w
b25lbnQgaW5zdGFudGlhdGlvbgogICAgICAvLyBzaW5jZSBkeW5hbWljIG9wdGlvbnMgbWVyZ2lu
ZyBpcyBwcmV0dHkgc2xvdywgYW5kIG5vbmUgb2YgdGhlCiAgICAgIC8vIGludGVybmFsIGNvbXBv
bmVudCBvcHRpb25zIG5lZWRzIHNwZWNpYWwgdHJlYXRtZW50LgogICAgICBpbml0SW50ZXJuYWxD
b21wb25lbnQodm0sIG9wdGlvbnMpOwogICAgfSBlbHNlIHsKICAgICAgdm0uJG9wdGlvbnMgPSBt
ZXJnZU9wdGlvbnMoCiAgICAgICAgcmVzb2x2ZUNvbnN0cnVjdG9yT3B0aW9ucyh2bS5jb25zdHJ1
Y3RvciksCiAgICAgICAgb3B0aW9ucyB8fCB7fSwKICAgICAgICB2bQogICAgICApOwogICAgfQog
ICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KICAgIHsKICAgICAgaW5pdFByb3h5KHZtKTsK
ICAgIH0KICAgIC8vIGV4cG9zZSByZWFsIHNlbGYKICAgIHZtLl9zZWxmID0gdm07CiAgICBpbml0
TGlmZWN5Y2xlKHZtKTsKICAgIGluaXRFdmVudHModm0pOwogICAgY2FsbEhvb2sodm0sICdiZWZv
cmVDcmVhdGUnKTsKICAgIGluaXRTdGF0ZSh2bSk7CiAgICBjYWxsSG9vayh2bSwgJ2NyZWF0ZWQn
KTsKICAgIGluaXRSZW5kZXIodm0pOwogIH07Cn0KCmZ1bmN0aW9uIGluaXRJbnRlcm5hbENvbXBv
bmVudCAodm0sIG9wdGlvbnMpIHsKICB2YXIgb3B0cyA9IHZtLiRvcHRpb25zID0gT2JqZWN0LmNy
ZWF0ZSh2bS5jb25zdHJ1Y3Rvci5vcHRpb25zKTsKICAvLyBkb2luZyB0aGlzIGJlY2F1c2UgaXQn
cyBmYXN0ZXIgdGhhbiBkeW5hbWljIGVudW1lcmF0aW9uLgogIG9wdHMucGFyZW50ID0gb3B0aW9u
cy5wYXJlbnQ7CiAgb3B0cy5wcm9wc0RhdGEgPSBvcHRpb25zLnByb3BzRGF0YTsKICBvcHRzLl9w
YXJlbnRWbm9kZSA9IG9wdGlvbnMuX3BhcmVudFZub2RlOwogIG9wdHMuX3BhcmVudExpc3RlbmVy
cyA9IG9wdGlvbnMuX3BhcmVudExpc3RlbmVyczsKICBvcHRzLl9yZW5kZXJDaGlsZHJlbiA9IG9w
dGlvbnMuX3JlbmRlckNoaWxkcmVuOwogIG9wdHMuX2NvbXBvbmVudFRhZyA9IG9wdGlvbnMuX2Nv
bXBvbmVudFRhZzsKICBvcHRzLl9wYXJlbnRFbG0gPSBvcHRpb25zLl9wYXJlbnRFbG07CiAgb3B0
cy5fcmVmRWxtID0gb3B0aW9ucy5fcmVmRWxtOwogIGlmIChvcHRpb25zLnJlbmRlcikgewogICAg
b3B0cy5yZW5kZXIgPSBvcHRpb25zLnJlbmRlcjsKICAgIG9wdHMuc3RhdGljUmVuZGVyRm5zID0g
b3B0aW9ucy5zdGF0aWNSZW5kZXJGbnM7CiAgfQp9CgpmdW5jdGlvbiByZXNvbHZlQ29uc3RydWN0
b3JPcHRpb25zIChDdG9yKSB7CiAgdmFyIG9wdGlvbnMgPSBDdG9yLm9wdGlvbnM7CiAgaWYgKEN0
b3Iuc3VwZXIpIHsKICAgIHZhciBzdXBlck9wdGlvbnMgPSBDdG9yLnN1cGVyLm9wdGlvbnM7CiAg
ICB2YXIgY2FjaGVkU3VwZXJPcHRpb25zID0gQ3Rvci5zdXBlck9wdGlvbnM7CiAgICB2YXIgZXh0
ZW5kT3B0aW9ucyA9IEN0b3IuZXh0ZW5kT3B0aW9uczsKICAgIGlmIChzdXBlck9wdGlvbnMgIT09
IGNhY2hlZFN1cGVyT3B0aW9ucykgewogICAgICAvLyBzdXBlciBvcHRpb24gY2hhbmdlZAogICAg
ICBDdG9yLnN1cGVyT3B0aW9ucyA9IHN1cGVyT3B0aW9uczsKICAgICAgZXh0ZW5kT3B0aW9ucy5y
ZW5kZXIgPSBvcHRpb25zLnJlbmRlcjsKICAgICAgZXh0ZW5kT3B0aW9ucy5zdGF0aWNSZW5kZXJG
bnMgPSBvcHRpb25zLnN0YXRpY1JlbmRlckZuczsKICAgICAgZXh0ZW5kT3B0aW9ucy5fc2NvcGVJ
ZCA9IG9wdGlvbnMuX3Njb3BlSWQ7CiAgICAgIG9wdGlvbnMgPSBDdG9yLm9wdGlvbnMgPSBtZXJn
ZU9wdGlvbnMoc3VwZXJPcHRpb25zLCBleHRlbmRPcHRpb25zKTsKICAgICAgaWYgKG9wdGlvbnMu
bmFtZSkgewogICAgICAgIG9wdGlvbnMuY29tcG9uZW50c1tvcHRpb25zLm5hbWVdID0gQ3RvcjsK
ICAgICAgfQogICAgfQogIH0KICByZXR1cm4gb3B0aW9ucwp9CgpmdW5jdGlvbiBWdWUkMyAob3B0
aW9ucykgewogIGlmICgiZGV2ZWxvcG1lbnQiICE9PSAncHJvZHVjdGlvbicgJiYKICAgICEodGhp
cyBpbnN0YW5jZW9mIFZ1ZSQzKSkgewogICAgd2FybignVnVlIGlzIGEgY29uc3RydWN0b3IgYW5k
IHNob3VsZCBiZSBjYWxsZWQgd2l0aCB0aGUgYG5ld2Aga2V5d29yZCcpOwogIH0KICB0aGlzLl9p
bml0KG9wdGlvbnMpOwp9Cgppbml0TWl4aW4oVnVlJDMpOwpzdGF0ZU1peGluKFZ1ZSQzKTsKZXZl
bnRzTWl4aW4oVnVlJDMpOwpsaWZlY3ljbGVNaXhpbihWdWUkMyk7CnJlbmRlck1peGluKFZ1ZSQz
KTsKCi8qICAqLwoKZnVuY3Rpb24gaW5pdFVzZSAoVnVlKSB7CiAgVnVlLnVzZSA9IGZ1bmN0aW9u
IChwbHVnaW4pIHsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKHBsdWdpbi5p
bnN0YWxsZWQpIHsKICAgICAgcmV0dXJuCiAgICB9CiAgICAvLyBhZGRpdGlvbmFsIHBhcmFtZXRl
cnMKICAgIHZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMsIDEpOwogICAgYXJncy51bnNoaWZ0
KHRoaXMpOwogICAgaWYgKHR5cGVvZiBwbHVnaW4uaW5zdGFsbCA9PT0gJ2Z1bmN0aW9uJykgewog
ICAgICBwbHVnaW4uaW5zdGFsbC5hcHBseShwbHVnaW4sIGFyZ3MpOwogICAgfSBlbHNlIHsKICAg
ICAgcGx1Z2luLmFwcGx5KG51bGwsIGFyZ3MpOwogICAgfQogICAgcGx1Z2luLmluc3RhbGxlZCA9
IHRydWU7CiAgICByZXR1cm4gdGhpcwogIH07Cn0KCi8qICAqLwoKZnVuY3Rpb24gaW5pdE1peGlu
JDEgKFZ1ZSkgewogIFZ1ZS5taXhpbiA9IGZ1bmN0aW9uIChtaXhpbikgewogICAgdGhpcy5vcHRp
b25zID0gbWVyZ2VPcHRpb25zKHRoaXMub3B0aW9ucywgbWl4aW4pOwogIH07Cn0KCi8qICAqLwoK
ZnVuY3Rpb24gaW5pdEV4dGVuZCAoVnVlKSB7CiAgLyoqCiAgICogRWFjaCBpbnN0YW5jZSBjb25z
dHJ1Y3RvciwgaW5jbHVkaW5nIFZ1ZSwgaGFzIGEgdW5pcXVlCiAgICogY2lkLiBUaGlzIGVuYWJs
ZXMgdXMgdG8gY3JlYXRlIHdyYXBwZWQgImNoaWxkCiAgICogY29uc3RydWN0b3JzIiBmb3IgcHJv
dG90eXBhbCBpbmhlcml0YW5jZSBhbmQgY2FjaGUgdGhlbS4KICAgKi8KICBWdWUuY2lkID0gMDsK
ICB2YXIgY2lkID0gMTsKCiAgLyoqCiAgICogQ2xhc3MgaW5oZXJpdGFuY2UKICAgKi8KICBWdWUu
ZXh0ZW5kID0gZnVuY3Rpb24gKGV4dGVuZE9wdGlvbnMpIHsKICAgIGV4dGVuZE9wdGlvbnMgPSBl
eHRlbmRPcHRpb25zIHx8IHt9OwogICAgdmFyIFN1cGVyID0gdGhpczsKICAgIHZhciBTdXBlcklk
ID0gU3VwZXIuY2lkOwogICAgdmFyIGNhY2hlZEN0b3JzID0gZXh0ZW5kT3B0aW9ucy5fQ3RvciB8
fCAoZXh0ZW5kT3B0aW9ucy5fQ3RvciA9IHt9KTsKICAgIGlmIChjYWNoZWRDdG9yc1tTdXBlcklk
XSkgewogICAgICByZXR1cm4gY2FjaGVkQ3RvcnNbU3VwZXJJZF0KICAgIH0KICAgIHZhciBuYW1l
ID0gZXh0ZW5kT3B0aW9ucy5uYW1lIHx8IFN1cGVyLm9wdGlvbnMubmFtZTsKICAgIHsKICAgICAg
aWYgKCEvXlthLXpBLVpdW1x3LV0qJC8udGVzdChuYW1lKSkgewogICAgICAgIHdhcm4oCiAgICAg
ICAgICAnSW52YWxpZCBjb21wb25lbnQgbmFtZTogIicgKyBuYW1lICsgJyIuIENvbXBvbmVudCBu
YW1lcyAnICsKICAgICAgICAgICdjYW4gb25seSBjb250YWluIGFscGhhbnVtZXJpYyBjaGFyYWN0
ZXJzIGFuZCB0aGUgaHlwaGVuLCAnICsKICAgICAgICAgICdhbmQgbXVzdCBzdGFydCB3aXRoIGEg
bGV0dGVyLicKICAgICAgICApOwogICAgICB9CiAgICB9CiAgICB2YXIgU3ViID0gZnVuY3Rpb24g
VnVlQ29tcG9uZW50IChvcHRpb25zKSB7CiAgICAgIHRoaXMuX2luaXQob3B0aW9ucyk7CiAgICB9
OwogICAgU3ViLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU3VwZXIucHJvdG90eXBlKTsKICAg
IFN1Yi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBTdWI7CiAgICBTdWIuY2lkID0gY2lkKys7CiAg
ICBTdWIub3B0aW9ucyA9IG1lcmdlT3B0aW9ucygKICAgICAgU3VwZXIub3B0aW9ucywKICAgICAg
ZXh0ZW5kT3B0aW9ucwogICAgKTsKICAgIFN1Ylsnc3VwZXInXSA9IFN1cGVyOwogICAgLy8gYWxs
b3cgZnVydGhlciBleHRlbnNpb24vbWl4aW4vcGx1Z2luIHVzYWdlCiAgICBTdWIuZXh0ZW5kID0g
U3VwZXIuZXh0ZW5kOwogICAgU3ViLm1peGluID0gU3VwZXIubWl4aW47CiAgICBTdWIudXNlID0g
U3VwZXIudXNlOwogICAgLy8gY3JlYXRlIGFzc2V0IHJlZ2lzdGVycywgc28gZXh0ZW5kZWQgY2xh
c3NlcwogICAgLy8gY2FuIGhhdmUgdGhlaXIgcHJpdmF0ZSBhc3NldHMgdG9vLgogICAgY29uZmln
Ll9hc3NldFR5cGVzLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgU3ViW3R5cGVdID0g
U3VwZXJbdHlwZV07CiAgICB9KTsKICAgIC8vIGVuYWJsZSByZWN1cnNpdmUgc2VsZi1sb29rdXAK
ICAgIGlmIChuYW1lKSB7CiAgICAgIFN1Yi5vcHRpb25zLmNvbXBvbmVudHNbbmFtZV0gPSBTdWI7
CiAgICB9CiAgICAvLyBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZSBzdXBlciBvcHRpb25zIGF0IGV4
dGVuc2lvbiB0aW1lLgogICAgLy8gbGF0ZXIgYXQgaW5zdGFudGlhdGlvbiB3ZSBjYW4gY2hlY2sg
aWYgU3VwZXIncyBvcHRpb25zIGhhdmUKICAgIC8vIGJlZW4gdXBkYXRlZC4KICAgIFN1Yi5zdXBl
ck9wdGlvbnMgPSBTdXBlci5vcHRpb25zOwogICAgU3ViLmV4dGVuZE9wdGlvbnMgPSBleHRlbmRP
cHRpb25zOwogICAgLy8gY2FjaGUgY29uc3RydWN0b3IKICAgIGNhY2hlZEN0b3JzW1N1cGVySWRd
ID0gU3ViOwogICAgcmV0dXJuIFN1YgogIH07Cn0KCi8qICAqLwoKZnVuY3Rpb24gaW5pdEFzc2V0
UmVnaXN0ZXJzIChWdWUpIHsKICAvKioKICAgKiBDcmVhdGUgYXNzZXQgcmVnaXN0cmF0aW9uIG1l
dGhvZHMuCiAgICovCiAgY29uZmlnLl9hc3NldFR5cGVzLmZvckVhY2goZnVuY3Rpb24gKHR5cGUp
IHsKICAgIFZ1ZVt0eXBlXSA9IGZ1bmN0aW9uICgKICAgICAgaWQsCiAgICAgIGRlZmluaXRpb24K
ICAgICkgewogICAgICBpZiAoIWRlZmluaXRpb24pIHsKICAgICAgICByZXR1cm4gdGhpcy5vcHRp
b25zW3R5cGUgKyAncyddW2lkXQogICAgICB9IGVsc2UgewogICAgICAgIC8qIGlzdGFuYnVsIGln
bm9yZSBpZiAqLwogICAgICAgIHsKICAgICAgICAgIGlmICh0eXBlID09PSAnY29tcG9uZW50JyAm
JiBjb25maWcuaXNSZXNlcnZlZFRhZyhpZCkpIHsKICAgICAgICAgICAgd2FybigKICAgICAgICAg
ICAgICAnRG8gbm90IHVzZSBidWlsdC1pbiBvciByZXNlcnZlZCBIVE1MIGVsZW1lbnRzIGFzIGNv
bXBvbmVudCAnICsKICAgICAgICAgICAgICAnaWQ6ICcgKyBpZAogICAgICAgICAgICApOwogICAg
ICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAodHlwZSA9PT0gJ2NvbXBvbmVudCcgJiYgaXNQ
bGFpbk9iamVjdChkZWZpbml0aW9uKSkgewogICAgICAgICAgZGVmaW5pdGlvbi5uYW1lID0gZGVm
aW5pdGlvbi5uYW1lIHx8IGlkOwogICAgICAgICAgZGVmaW5pdGlvbiA9IHRoaXMub3B0aW9ucy5f
YmFzZS5leHRlbmQoZGVmaW5pdGlvbik7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlID09PSAn
ZGlyZWN0aXZlJyAmJiB0eXBlb2YgZGVmaW5pdGlvbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAg
ICAgZGVmaW5pdGlvbiA9IHsgYmluZDogZGVmaW5pdGlvbiwgdXBkYXRlOiBkZWZpbml0aW9uIH07
CiAgICAgICAgfQogICAgICAgIHRoaXMub3B0aW9uc1t0eXBlICsgJ3MnXVtpZF0gPSBkZWZpbml0
aW9uOwogICAgICAgIHJldHVybiBkZWZpbml0aW9uCiAgICAgIH0KICAgIH07CiAgfSk7Cn0KCi8q
ICAqLwoKdmFyIHBhdHRlcm5UeXBlcyA9IFtTdHJpbmcsIFJlZ0V4cF07CgpmdW5jdGlvbiBtYXRj
aGVzIChwYXR0ZXJuLCBuYW1lKSB7CiAgaWYgKHR5cGVvZiBwYXR0ZXJuID09PSAnc3RyaW5nJykg
ewogICAgcmV0dXJuIHBhdHRlcm4uc3BsaXQoJywnKS5pbmRleE9mKG5hbWUpID4gLTEKICB9IGVs
c2UgewogICAgcmV0dXJuIHBhdHRlcm4udGVzdChuYW1lKQogIH0KfQoKdmFyIEtlZXBBbGl2ZSA9
IHsKICBuYW1lOiAna2VlcC1hbGl2ZScsCiAgYWJzdHJhY3Q6IHRydWUsCiAgcHJvcHM6IHsKICAg
IGluY2x1ZGU6IHBhdHRlcm5UeXBlcywKICAgIGV4Y2x1ZGU6IHBhdHRlcm5UeXBlcwogIH0sCiAg
Y3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCAoKSB7CiAgICB0aGlzLmNhY2hlID0gT2JqZWN0LmNy
ZWF0ZShudWxsKTsKICB9LAogIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyICgpIHsKICAgIHZhciB2
bm9kZSA9IGdldEZpcnN0Q29tcG9uZW50Q2hpbGQodGhpcy4kc2xvdHMuZGVmYXVsdCk7CiAgICBp
ZiAodm5vZGUgJiYgdm5vZGUuY29tcG9uZW50T3B0aW9ucykgewogICAgICB2YXIgb3B0cyA9IHZu
b2RlLmNvbXBvbmVudE9wdGlvbnM7CiAgICAgIC8vIGNoZWNrIHBhdHRlcm4KICAgICAgdmFyIG5h
bWUgPSBvcHRzLkN0b3Iub3B0aW9ucy5uYW1lIHx8IG9wdHMudGFnOwogICAgICBpZiAobmFtZSAm
JiAoCiAgICAgICAgKHRoaXMuaW5jbHVkZSAmJiAhbWF0Y2hlcyh0aGlzLmluY2x1ZGUsIG5hbWUp
KSB8fAogICAgICAgICh0aGlzLmV4Y2x1ZGUgJiYgbWF0Y2hlcyh0aGlzLmV4Y2x1ZGUsIG5hbWUp
KQogICAgICApKSB7CiAgICAgICAgcmV0dXJuIHZub2RlCiAgICAgIH0KICAgICAgdmFyIGtleSA9
IHZub2RlLmtleSA9PSBudWxsCiAgICAgICAgLy8gc2FtZSBjb25zdHJ1Y3RvciBtYXkgZ2V0IHJl
Z2lzdGVyZWQgYXMgZGlmZmVyZW50IGxvY2FsIGNvbXBvbmVudHMKICAgICAgICAvLyBzbyBjaWQg
YWxvbmUgaXMgbm90IGVub3VnaCAoIzMyNjkpCiAgICAgICAgPyBvcHRzLkN0b3IuY2lkICsgKG9w
dHMudGFnID8gKCI6OiIgKyAob3B0cy50YWcpKSA6ICcnKQogICAgICAgIDogdm5vZGUua2V5Owog
ICAgICBpZiAodGhpcy5jYWNoZVtrZXldKSB7CiAgICAgICAgdm5vZGUuY2hpbGQgPSB0aGlzLmNh
Y2hlW2tleV0uY2hpbGQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jYWNoZVtrZXldID0g
dm5vZGU7CiAgICAgIH0KICAgICAgdm5vZGUuZGF0YS5rZWVwQWxpdmUgPSB0cnVlOwogICAgfQog
ICAgcmV0dXJuIHZub2RlCiAgfSwKICBkZXN0cm95ZWQ6IGZ1bmN0aW9uIGRlc3Ryb3llZCAoKSB7
CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5jYWNoZSkg
ewogICAgICB2YXIgdm5vZGUgPSB0aGlzJDEuY2FjaGVba2V5XTsKICAgICAgY2FsbEhvb2sodm5v
ZGUuY2hpbGQsICdkZWFjdGl2YXRlZCcpOwogICAgICB2bm9kZS5jaGlsZC4kZGVzdHJveSgpOwog
ICAgfQogIH0KfTsKCnZhciBidWlsdEluQ29tcG9uZW50cyA9IHsKICBLZWVwQWxpdmU6IEtlZXBB
bGl2ZQp9OwoKLyogICovCgpmdW5jdGlvbiBpbml0R2xvYmFsQVBJIChWdWUpIHsKICAvLyBjb25m
aWcKICB2YXIgY29uZmlnRGVmID0ge307CiAgY29uZmlnRGVmLmdldCA9IGZ1bmN0aW9uICgpIHsg
cmV0dXJuIGNvbmZpZzsgfTsKICB7CiAgICBjb25maWdEZWYuc2V0ID0gZnVuY3Rpb24gKCkgewog
ICAgICB3YXJuKAogICAgICAgICdEbyBub3QgcmVwbGFjZSB0aGUgVnVlLmNvbmZpZyBvYmplY3Qs
IHNldCBpbmRpdmlkdWFsIGZpZWxkcyBpbnN0ZWFkLicKICAgICAgKTsKICAgIH07CiAgfQogIE9i
amVjdC5kZWZpbmVQcm9wZXJ0eShWdWUsICdjb25maWcnLCBjb25maWdEZWYpOwogIFZ1ZS51dGls
ID0gdXRpbDsKICBWdWUuc2V0ID0gc2V0JDE7CiAgVnVlLmRlbGV0ZSA9IGRlbDsKICBWdWUubmV4
dFRpY2sgPSBuZXh0VGljazsKCiAgVnVlLm9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwog
IGNvbmZpZy5fYXNzZXRUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlKSB7CiAgICBWdWUub3B0
aW9uc1t0eXBlICsgJ3MnXSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgfSk7CgogIC8vIHRoaXMg
aXMgdXNlZCB0byBpZGVudGlmeSB0aGUgImJhc2UiIGNvbnN0cnVjdG9yIHRvIGV4dGVuZCBhbGwg
cGxhaW4tb2JqZWN0CiAgLy8gY29tcG9uZW50cyB3aXRoIGluIFdlZXgncyBtdWx0aS1pbnN0YW5j
ZSBzY2VuYXJpb3MuCiAgVnVlLm9wdGlvbnMuX2Jhc2UgPSBWdWU7CgogIGV4dGVuZChWdWUub3B0
aW9ucy5jb21wb25lbnRzLCBidWlsdEluQ29tcG9uZW50cyk7CgogIGluaXRVc2UoVnVlKTsKICBp
bml0TWl4aW4kMShWdWUpOwogIGluaXRFeHRlbmQoVnVlKTsKICBpbml0QXNzZXRSZWdpc3RlcnMo
VnVlKTsKfQoKaW5pdEdsb2JhbEFQSShWdWUkMyk7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoVnVl
JDMucHJvdG90eXBlLCAnJGlzU2VydmVyJywgewogIGdldDogaXNTZXJ2ZXJSZW5kZXJpbmcKfSk7
CgpWdWUkMy52ZXJzaW9uID0gJzIuMS42JzsKCi8qICAqLwoKLy8gYXR0cmlidXRlcyB0aGF0IHNo
b3VsZCBiZSB1c2luZyBwcm9wcyBmb3IgYmluZGluZwp2YXIgYWNjZXB0VmFsdWUgPSBtYWtlTWFw
KCdpbnB1dCx0ZXh0YXJlYSxvcHRpb24sc2VsZWN0Jyk7CnZhciBtdXN0VXNlUHJvcCA9IGZ1bmN0
aW9uICh0YWcsIGF0dHIpIHsKICByZXR1cm4gKAogICAgKGF0dHIgPT09ICd2YWx1ZScgJiYgYWNj
ZXB0VmFsdWUodGFnKSkgfHwKICAgIChhdHRyID09PSAnc2VsZWN0ZWQnICYmIHRhZyA9PT0gJ29w
dGlvbicpIHx8CiAgICAoYXR0ciA9PT0gJ2NoZWNrZWQnICYmIHRhZyA9PT0gJ2lucHV0JykgfHwK
ICAgIChhdHRyID09PSAnbXV0ZWQnICYmIHRhZyA9PT0gJ3ZpZGVvJykKICApCn07Cgp2YXIgaXNF
bnVtZXJhdGVkQXR0ciA9IG1ha2VNYXAoJ2NvbnRlbnRlZGl0YWJsZSxkcmFnZ2FibGUsc3BlbGxj
aGVjaycpOwoKdmFyIGlzQm9vbGVhbkF0dHIgPSBtYWtlTWFwKAogICdhbGxvd2Z1bGxzY3JlZW4s
YXN5bmMsYXV0b2ZvY3VzLGF1dG9wbGF5LGNoZWNrZWQsY29tcGFjdCxjb250cm9scyxkZWNsYXJl
LCcgKwogICdkZWZhdWx0LGRlZmF1bHRjaGVja2VkLGRlZmF1bHRtdXRlZCxkZWZhdWx0c2VsZWN0
ZWQsZGVmZXIsZGlzYWJsZWQsJyArCiAgJ2VuYWJsZWQsZm9ybW5vdmFsaWRhdGUsaGlkZGVuLGlu
ZGV0ZXJtaW5hdGUsaW5lcnQsaXNtYXAsaXRlbXNjb3BlLGxvb3AsbXVsdGlwbGUsJyArCiAgJ211
dGVkLG5vaHJlZixub3Jlc2l6ZSxub3NoYWRlLG5vdmFsaWRhdGUsbm93cmFwLG9wZW4scGF1c2Vv
bmV4aXQscmVhZG9ubHksJyArCiAgJ3JlcXVpcmVkLHJldmVyc2VkLHNjb3BlZCxzZWFtbGVzcyxz
ZWxlY3RlZCxzb3J0YWJsZSx0cmFuc2xhdGUsJyArCiAgJ3RydWVzcGVlZCx0eXBlbXVzdG1hdGNo
LHZpc2libGUnCik7Cgp2YXIgeGxpbmtOUyA9ICdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5r
JzsKCnZhciBpc1hsaW5rID0gZnVuY3Rpb24gKG5hbWUpIHsKICByZXR1cm4gbmFtZS5jaGFyQXQo
NSkgPT09ICc6JyAmJiBuYW1lLnNsaWNlKDAsIDUpID09PSAneGxpbmsnCn07Cgp2YXIgZ2V0WGxp
bmtQcm9wID0gZnVuY3Rpb24gKG5hbWUpIHsKICByZXR1cm4gaXNYbGluayhuYW1lKSA/IG5hbWUu
c2xpY2UoNiwgbmFtZS5sZW5ndGgpIDogJycKfTsKCnZhciBpc0ZhbHN5QXR0clZhbHVlID0gZnVu
Y3Rpb24gKHZhbCkgewogIHJldHVybiB2YWwgPT0gbnVsbCB8fCB2YWwgPT09IGZhbHNlCn07Cgov
KiAgKi8KCmZ1bmN0aW9uIGdlbkNsYXNzRm9yVm5vZGUgKHZub2RlKSB7CiAgdmFyIGRhdGEgPSB2
bm9kZS5kYXRhOwogIHZhciBwYXJlbnROb2RlID0gdm5vZGU7CiAgdmFyIGNoaWxkTm9kZSA9IHZu
b2RlOwogIHdoaWxlIChjaGlsZE5vZGUuY2hpbGQpIHsKICAgIGNoaWxkTm9kZSA9IGNoaWxkTm9k
ZS5jaGlsZC5fdm5vZGU7CiAgICBpZiAoY2hpbGROb2RlLmRhdGEpIHsKICAgICAgZGF0YSA9IG1l
cmdlQ2xhc3NEYXRhKGNoaWxkTm9kZS5kYXRhLCBkYXRhKTsKICAgIH0KICB9CiAgd2hpbGUgKChw
YXJlbnROb2RlID0gcGFyZW50Tm9kZS5wYXJlbnQpKSB7CiAgICBpZiAocGFyZW50Tm9kZS5kYXRh
KSB7CiAgICAgIGRhdGEgPSBtZXJnZUNsYXNzRGF0YShkYXRhLCBwYXJlbnROb2RlLmRhdGEpOwog
ICAgfQogIH0KICByZXR1cm4gZ2VuQ2xhc3NGcm9tRGF0YShkYXRhKQp9CgpmdW5jdGlvbiBtZXJn
ZUNsYXNzRGF0YSAoY2hpbGQsIHBhcmVudCkgewogIHJldHVybiB7CiAgICBzdGF0aWNDbGFzczog
Y29uY2F0KGNoaWxkLnN0YXRpY0NsYXNzLCBwYXJlbnQuc3RhdGljQ2xhc3MpLAogICAgY2xhc3M6
IGNoaWxkLmNsYXNzCiAgICAgID8gW2NoaWxkLmNsYXNzLCBwYXJlbnQuY2xhc3NdCiAgICAgIDog
cGFyZW50LmNsYXNzCiAgfQp9CgpmdW5jdGlvbiBnZW5DbGFzc0Zyb21EYXRhIChkYXRhKSB7CiAg
dmFyIGR5bmFtaWNDbGFzcyA9IGRhdGEuY2xhc3M7CiAgdmFyIHN0YXRpY0NsYXNzID0gZGF0YS5z
dGF0aWNDbGFzczsKICBpZiAoc3RhdGljQ2xhc3MgfHwgZHluYW1pY0NsYXNzKSB7CiAgICByZXR1
cm4gY29uY2F0KHN0YXRpY0NsYXNzLCBzdHJpbmdpZnlDbGFzcyhkeW5hbWljQ2xhc3MpKQogIH0K
ICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogIHJldHVybiAnJwp9CgpmdW5jdGlvbiBjb25j
YXQgKGEsIGIpIHsKICByZXR1cm4gYSA/IGIgPyAoYSArICcgJyArIGIpIDogYSA6IChiIHx8ICcn
KQp9CgpmdW5jdGlvbiBzdHJpbmdpZnlDbGFzcyAodmFsdWUpIHsKICB2YXIgcmVzID0gJyc7CiAg
aWYgKCF2YWx1ZSkgewogICAgcmV0dXJuIHJlcwogIH0KICBpZiAodHlwZW9mIHZhbHVlID09PSAn
c3RyaW5nJykgewogICAgcmV0dXJuIHZhbHVlCiAgfQogIGlmIChBcnJheS5pc0FycmF5KHZhbHVl
KSkgewogICAgdmFyIHN0cmluZ2lmaWVkOwogICAgZm9yICh2YXIgaSA9IDAsIGwgPSB2YWx1ZS5s
ZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgaWYgKHZhbHVlW2ldKSB7CiAgICAgICAgaWYgKChz
dHJpbmdpZmllZCA9IHN0cmluZ2lmeUNsYXNzKHZhbHVlW2ldKSkpIHsKICAgICAgICAgIHJlcyAr
PSBzdHJpbmdpZmllZCArICcgJzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBy
ZXMuc2xpY2UoMCwgLTEpCiAgfQogIGlmIChpc09iamVjdCh2YWx1ZSkpIHsKICAgIGZvciAodmFy
IGtleSBpbiB2YWx1ZSkgewogICAgICBpZiAodmFsdWVba2V5XSkgeyByZXMgKz0ga2V5ICsgJyAn
OyB9CiAgICB9CiAgICByZXR1cm4gcmVzLnNsaWNlKDAsIC0xKQogIH0KICAvKiBpc3RhbmJ1bCBp
Z25vcmUgbmV4dCAqLwogIHJldHVybiByZXMKfQoKLyogICovCgp2YXIgbmFtZXNwYWNlTWFwID0g
ewogIHN2ZzogJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywKICBtYXRoOiAnaHR0cDovL3d3
dy53My5vcmcvMTk5OC9NYXRoL01hdGhNTCcsCiAgeGh0bWw6ICdodHRwOi8vd3d3LnczLm9yZy8x
OTk5L3hodG1sJwp9OwoKdmFyIGlzSFRNTFRhZyA9IG1ha2VNYXAoCiAgJ2h0bWwsYm9keSxiYXNl
LGhlYWQsbGluayxtZXRhLHN0eWxlLHRpdGxlLCcgKwogICdhZGRyZXNzLGFydGljbGUsYXNpZGUs
Zm9vdGVyLGhlYWRlcixoMSxoMixoMyxoNCxoNSxoNixoZ3JvdXAsbmF2LHNlY3Rpb24sJyArCiAg
J2RpdixkZCxkbCxkdCxmaWdjYXB0aW9uLGZpZ3VyZSxocixpbWcsbGksbWFpbixvbCxwLHByZSx1
bCwnICsKICAnYSxiLGFiYnIsYmRpLGJkbyxicixjaXRlLGNvZGUsZGF0YSxkZm4sZW0saSxrYmQs
bWFyayxxLHJwLHJ0LHJ0YyxydWJ5LCcgKwogICdzLHNhbXAsc21hbGwsc3BhbixzdHJvbmcsc3Vi
LHN1cCx0aW1lLHUsdmFyLHdicixhcmVhLGF1ZGlvLG1hcCx0cmFjayx2aWRlbywnICsKICAnZW1i
ZWQsb2JqZWN0LHBhcmFtLHNvdXJjZSxjYW52YXMsc2NyaXB0LG5vc2NyaXB0LGRlbCxpbnMsJyAr
CiAgJ2NhcHRpb24sY29sLGNvbGdyb3VwLHRhYmxlLHRoZWFkLHRib2R5LHRkLHRoLHRyLCcgKwog
ICdidXR0b24sZGF0YWxpc3QsZmllbGRzZXQsZm9ybSxpbnB1dCxsYWJlbCxsZWdlbmQsbWV0ZXIs
b3B0Z3JvdXAsb3B0aW9uLCcgKwogICdvdXRwdXQscHJvZ3Jlc3Msc2VsZWN0LHRleHRhcmVhLCcg
KwogICdkZXRhaWxzLGRpYWxvZyxtZW51LG1lbnVpdGVtLHN1bW1hcnksJyArCiAgJ2NvbnRlbnQs
ZWxlbWVudCxzaGFkb3csdGVtcGxhdGUnCik7CgovLyB0aGlzIG1hcCBpcyBpbnRlbnRpb25hbGx5
IHNlbGVjdGl2ZSwgb25seSBjb3ZlcmluZyBTVkcgZWxlbWVudHMgdGhhdCBtYXkKLy8gY29udGFp
biBjaGlsZCBlbGVtZW50cy4KdmFyIGlzU1ZHID0gbWFrZU1hcCgKICAnc3ZnLGFuaW1hdGUsY2ly
Y2xlLGNsaXBwYXRoLGN1cnNvcixkZWZzLGRlc2MsZWxsaXBzZSxmaWx0ZXIsJyArCiAgJ2ZvbnQt
ZmFjZSxnLGdseXBoLGltYWdlLGxpbmUsbWFya2VyLG1hc2ssbWlzc2luZy1nbHlwaCxwYXRoLHBh
dHRlcm4sJyArCiAgJ3BvbHlnb24scG9seWxpbmUscmVjdCxzd2l0Y2gsc3ltYm9sLHRleHQsdGV4
dHBhdGgsdHNwYW4sdXNlLHZpZXcnLAogIHRydWUKKTsKCnZhciBpc1ByZVRhZyA9IGZ1bmN0aW9u
ICh0YWcpIHsgcmV0dXJuIHRhZyA9PT0gJ3ByZSc7IH07Cgp2YXIgaXNSZXNlcnZlZFRhZyA9IGZ1
bmN0aW9uICh0YWcpIHsKICByZXR1cm4gaXNIVE1MVGFnKHRhZykgfHwgaXNTVkcodGFnKQp9OwoK
ZnVuY3Rpb24gZ2V0VGFnTmFtZXNwYWNlICh0YWcpIHsKICBpZiAoaXNTVkcodGFnKSkgewogICAg
cmV0dXJuICdzdmcnCiAgfQogIC8vIGJhc2ljIHN1cHBvcnQgZm9yIE1hdGhNTAogIC8vIG5vdGUg
aXQgZG9lc24ndCBzdXBwb3J0IG90aGVyIE1hdGhNTCBlbGVtZW50cyBiZWluZyBjb21wb25lbnQg
cm9vdHMKICBpZiAodGFnID09PSAnbWF0aCcpIHsKICAgIHJldHVybiAnbWF0aCcKICB9Cn0KCnZh
ciB1bmtub3duRWxlbWVudENhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKZnVuY3Rpb24gaXNV
bmtub3duRWxlbWVudCAodGFnKSB7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKCFp
bkJyb3dzZXIpIHsKICAgIHJldHVybiB0cnVlCiAgfQogIGlmIChpc1Jlc2VydmVkVGFnKHRhZykp
IHsKICAgIHJldHVybiBmYWxzZQogIH0KICB0YWcgPSB0YWcudG9Mb3dlckNhc2UoKTsKICAvKiBp
c3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAodW5rbm93bkVsZW1lbnRDYWNoZVt0YWddICE9IG51
bGwpIHsKICAgIHJldHVybiB1bmtub3duRWxlbWVudENhY2hlW3RhZ10KICB9CiAgdmFyIGVsID0g
ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpOwogIGlmICh0YWcuaW5kZXhPZignLScpID4gLTEp
IHsKICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI4MjEwMzY0LzEwNzAyNDQKICAg
IHJldHVybiAodW5rbm93bkVsZW1lbnRDYWNoZVt0YWddID0gKAogICAgICBlbC5jb25zdHJ1Y3Rv
ciA9PT0gd2luZG93LkhUTUxVbmtub3duRWxlbWVudCB8fAogICAgICBlbC5jb25zdHJ1Y3RvciA9
PT0gd2luZG93LkhUTUxFbGVtZW50CiAgICApKQogIH0gZWxzZSB7CiAgICByZXR1cm4gKHVua25v
d25FbGVtZW50Q2FjaGVbdGFnXSA9IC9IVE1MVW5rbm93bkVsZW1lbnQvLnRlc3QoZWwudG9TdHJp
bmcoKSkpCiAgfQp9CgovKiAgKi8KCi8qKgogKiBRdWVyeSBhbiBlbGVtZW50IHNlbGVjdG9yIGlm
IGl0J3Mgbm90IGFuIGVsZW1lbnQgYWxyZWFkeS4KICovCmZ1bmN0aW9uIHF1ZXJ5IChlbCkgewog
IGlmICh0eXBlb2YgZWwgPT09ICdzdHJpbmcnKSB7CiAgICB2YXIgc2VsZWN0b3IgPSBlbDsKICAg
IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbCk7CiAgICBpZiAoIWVsKSB7CiAgICAgICJk
ZXZlbG9wbWVudCIgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKAogICAgICAgICdDYW5ub3QgZmlu
ZCBlbGVtZW50OiAnICsgc2VsZWN0b3IKICAgICAgKTsKICAgICAgcmV0dXJuIGRvY3VtZW50LmNy
ZWF0ZUVsZW1lbnQoJ2RpdicpCiAgICB9CiAgfQogIHJldHVybiBlbAp9CgovKiAgKi8KCmZ1bmN0
aW9uIGNyZWF0ZUVsZW1lbnQkMSAodGFnTmFtZSwgdm5vZGUpIHsKICB2YXIgZWxtID0gZG9jdW1l
bnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTsKICBpZiAodGFnTmFtZSAhPT0gJ3NlbGVjdCcpIHsK
ICAgIHJldHVybiBlbG0KICB9CiAgaWYgKHZub2RlLmRhdGEgJiYgdm5vZGUuZGF0YS5hdHRycyAm
JiAnbXVsdGlwbGUnIGluIHZub2RlLmRhdGEuYXR0cnMpIHsKICAgIGVsbS5zZXRBdHRyaWJ1dGUo
J211bHRpcGxlJywgJ211bHRpcGxlJyk7CiAgfQogIHJldHVybiBlbG0KfQoKZnVuY3Rpb24gY3Jl
YXRlRWxlbWVudE5TIChuYW1lc3BhY2UsIHRhZ05hbWUpIHsKICByZXR1cm4gZG9jdW1lbnQuY3Jl
YXRlRWxlbWVudE5TKG5hbWVzcGFjZU1hcFtuYW1lc3BhY2VdLCB0YWdOYW1lKQp9CgpmdW5jdGlv
biBjcmVhdGVUZXh0Tm9kZSAodGV4dCkgewogIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9k
ZSh0ZXh0KQp9CgpmdW5jdGlvbiBjcmVhdGVDb21tZW50ICh0ZXh0KSB7CiAgcmV0dXJuIGRvY3Vt
ZW50LmNyZWF0ZUNvbW1lbnQodGV4dCkKfQoKZnVuY3Rpb24gaW5zZXJ0QmVmb3JlIChwYXJlbnRO
b2RlLCBuZXdOb2RlLCByZWZlcmVuY2VOb2RlKSB7CiAgcGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUo
bmV3Tm9kZSwgcmVmZXJlbmNlTm9kZSk7Cn0KCmZ1bmN0aW9uIHJlbW92ZUNoaWxkIChub2RlLCBj
aGlsZCkgewogIG5vZGUucmVtb3ZlQ2hpbGQoY2hpbGQpOwp9CgpmdW5jdGlvbiBhcHBlbmRDaGls
ZCAobm9kZSwgY2hpbGQpIHsKICBub2RlLmFwcGVuZENoaWxkKGNoaWxkKTsKfQoKZnVuY3Rpb24g
cGFyZW50Tm9kZSAobm9kZSkgewogIHJldHVybiBub2RlLnBhcmVudE5vZGUKfQoKZnVuY3Rpb24g
bmV4dFNpYmxpbmcgKG5vZGUpIHsKICByZXR1cm4gbm9kZS5uZXh0U2libGluZwp9CgpmdW5jdGlv
biB0YWdOYW1lIChub2RlKSB7CiAgcmV0dXJuIG5vZGUudGFnTmFtZQp9CgpmdW5jdGlvbiBzZXRU
ZXh0Q29udGVudCAobm9kZSwgdGV4dCkgewogIG5vZGUudGV4dENvbnRlbnQgPSB0ZXh0Owp9Cgpm
dW5jdGlvbiBzZXRBdHRyaWJ1dGUgKG5vZGUsIGtleSwgdmFsKSB7CiAgbm9kZS5zZXRBdHRyaWJ1
dGUoa2V5LCB2YWwpOwp9CgoKdmFyIG5vZGVPcHMgPSBPYmplY3QuZnJlZXplKHsKCWNyZWF0ZUVs
ZW1lbnQ6IGNyZWF0ZUVsZW1lbnQkMSwKCWNyZWF0ZUVsZW1lbnROUzogY3JlYXRlRWxlbWVudE5T
LAoJY3JlYXRlVGV4dE5vZGU6IGNyZWF0ZVRleHROb2RlLAoJY3JlYXRlQ29tbWVudDogY3JlYXRl
Q29tbWVudCwKCWluc2VydEJlZm9yZTogaW5zZXJ0QmVmb3JlLAoJcmVtb3ZlQ2hpbGQ6IHJlbW92
ZUNoaWxkLAoJYXBwZW5kQ2hpbGQ6IGFwcGVuZENoaWxkLAoJcGFyZW50Tm9kZTogcGFyZW50Tm9k
ZSwKCW5leHRTaWJsaW5nOiBuZXh0U2libGluZywKCXRhZ05hbWU6IHRhZ05hbWUsCglzZXRUZXh0
Q29udGVudDogc2V0VGV4dENvbnRlbnQsCglzZXRBdHRyaWJ1dGU6IHNldEF0dHJpYnV0ZQp9KTsK
Ci8qICAqLwoKdmFyIHJlZiA9IHsKICBjcmVhdGU6IGZ1bmN0aW9uIGNyZWF0ZSAoXywgdm5vZGUp
IHsKICAgIHJlZ2lzdGVyUmVmKHZub2RlKTsKICB9LAogIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRl
IChvbGRWbm9kZSwgdm5vZGUpIHsKICAgIGlmIChvbGRWbm9kZS5kYXRhLnJlZiAhPT0gdm5vZGUu
ZGF0YS5yZWYpIHsKICAgICAgcmVnaXN0ZXJSZWYob2xkVm5vZGUsIHRydWUpOwogICAgICByZWdp
c3RlclJlZih2bm9kZSk7CiAgICB9CiAgfSwKICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95ICh2
bm9kZSkgewogICAgcmVnaXN0ZXJSZWYodm5vZGUsIHRydWUpOwogIH0KfTsKCmZ1bmN0aW9uIHJl
Z2lzdGVyUmVmICh2bm9kZSwgaXNSZW1vdmFsKSB7CiAgdmFyIGtleSA9IHZub2RlLmRhdGEucmVm
OwogIGlmICgha2V5KSB7IHJldHVybiB9CgogIHZhciB2bSA9IHZub2RlLmNvbnRleHQ7CiAgdmFy
IHJlZiA9IHZub2RlLmNoaWxkIHx8IHZub2RlLmVsbTsKICB2YXIgcmVmcyA9IHZtLiRyZWZzOwog
IGlmIChpc1JlbW92YWwpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KHJlZnNba2V5XSkpIHsKICAg
ICAgcmVtb3ZlJDEocmVmc1trZXldLCByZWYpOwogICAgfSBlbHNlIGlmIChyZWZzW2tleV0gPT09
IHJlZikgewogICAgICByZWZzW2tleV0gPSB1bmRlZmluZWQ7CiAgICB9CiAgfSBlbHNlIHsKICAg
IGlmICh2bm9kZS5kYXRhLnJlZkluRm9yKSB7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlZnNb
a2V5XSkgJiYgcmVmc1trZXldLmluZGV4T2YocmVmKSA8IDApIHsKICAgICAgICByZWZzW2tleV0u
cHVzaChyZWYpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlZnNba2V5XSA9IFtyZWZdOwogICAg
ICB9CiAgICB9IGVsc2UgewogICAgICByZWZzW2tleV0gPSByZWY7CiAgICB9CiAgfQp9CgovKioK
ICogVmlydHVhbCBET00gcGF0Y2hpbmcgYWxnb3JpdGhtIGJhc2VkIG9uIFNuYWJiZG9tIGJ5CiAq
IFNpbW9uIEZyaWlzIFZpbmR1bSAoQHBhbGRlcGluZCkKICogTGljZW5zZWQgdW5kZXIgdGhlIE1J
VCBMaWNlbnNlCiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9wYWxkZXBpbmQvc25hYmJkb20vYmxvYi9t
YXN0ZXIvTElDRU5TRQogKgogKiBtb2RpZmllZCBieSBFdmFuIFlvdSAoQHl5eDk5MDgwMykKICoK
Ci8qCiAqIE5vdCB0eXBlLWNoZWNraW5nIHRoaXMgYmVjYXVzZSB0aGlzIGZpbGUgaXMgcGVyZi1j
cml0aWNhbCBhbmQgdGhlIGNvc3QKICogb2YgbWFraW5nIGZsb3cgdW5kZXJzdGFuZCBpdCBpcyBu
b3Qgd29ydGggaXQuCiAqLwoKdmFyIGVtcHR5Tm9kZSA9IG5ldyBWTm9kZSgnJywge30sIFtdKTsK
CnZhciBob29rcyQxID0gWydjcmVhdGUnLCAnYWN0aXZhdGUnLCAndXBkYXRlJywgJ3JlbW92ZScs
ICdkZXN0cm95J107CgpmdW5jdGlvbiBpc1VuZGVmIChzKSB7CiAgcmV0dXJuIHMgPT0gbnVsbAp9
CgpmdW5jdGlvbiBpc0RlZiAocykgewogIHJldHVybiBzICE9IG51bGwKfQoKZnVuY3Rpb24gc2Ft
ZVZub2RlICh2bm9kZTEsIHZub2RlMik=</Default>
</Parameter>

<Parameter name="Frag91664421433626797493787">
<Default>b2RpZmllcnMucHJvcCA/ICcsdHJ1ZScgOiAnJykgKyAiKSIpCiAgfTsKfQoKdmFyIGJhc2VEaXJl
Y3RpdmVzID0gewogIGJpbmQ6IGJpbmQkMiwKICBjbG9hazogbm9vcAp9OwoKLyogICovCgovLyBj
b25maWd1cmFibGUgc3RhdGUKdmFyIHdhcm4kMjsKdmFyIHRyYW5zZm9ybXMkMTsKdmFyIGRhdGFH
ZW5GbnM7CnZhciBwbGF0Zm9ybURpcmVjdGl2ZXMkMTsKdmFyIHN0YXRpY1JlbmRlckZuczsKdmFy
IG9uY2VDb3VudDsKdmFyIGN1cnJlbnRPcHRpb25zOwoKZnVuY3Rpb24gZ2VuZXJhdGUgKAogIGFz
dCwKICBvcHRpb25zCikgewogIC8vIHNhdmUgcHJldmlvdXMgc3RhdGljUmVuZGVyRm5zIHNvIGdl
bmVyYXRlIGNhbGxzIGNhbiBiZSBuZXN0ZWQKICB2YXIgcHJldlN0YXRpY1JlbmRlckZucyA9IHN0
YXRpY1JlbmRlckZuczsKICB2YXIgY3VycmVudFN0YXRpY1JlbmRlckZucyA9IHN0YXRpY1JlbmRl
ckZucyA9IFtdOwogIHZhciBwcmV2T25jZUNvdW50ID0gb25jZUNvdW50OwogIG9uY2VDb3VudCA9
IDA7CiAgY3VycmVudE9wdGlvbnMgPSBvcHRpb25zOwogIHdhcm4kMiA9IG9wdGlvbnMud2FybiB8
fCBiYXNlV2FybjsKICB0cmFuc2Zvcm1zJDEgPSBwbHVja01vZHVsZUZ1bmN0aW9uKG9wdGlvbnMu
bW9kdWxlcywgJ3RyYW5zZm9ybUNvZGUnKTsKICBkYXRhR2VuRm5zID0gcGx1Y2tNb2R1bGVGdW5j
dGlvbihvcHRpb25zLm1vZHVsZXMsICdnZW5EYXRhJyk7CiAgcGxhdGZvcm1EaXJlY3RpdmVzJDEg
PSBvcHRpb25zLmRpcmVjdGl2ZXMgfHwge307CiAgdmFyIGNvZGUgPSBhc3QgPyBnZW5FbGVtZW50
KGFzdCkgOiAnX2MoImRpdiIpJzsKICBzdGF0aWNSZW5kZXJGbnMgPSBwcmV2U3RhdGljUmVuZGVy
Rm5zOwogIG9uY2VDb3VudCA9IHByZXZPbmNlQ291bnQ7CiAgcmV0dXJuIHsKICAgIHJlbmRlcjog
KCJ3aXRoKHRoaXMpe3JldHVybiAiICsgY29kZSArICJ9IiksCiAgICBzdGF0aWNSZW5kZXJGbnM6
IGN1cnJlbnRTdGF0aWNSZW5kZXJGbnMKICB9Cn0KCmZ1bmN0aW9uIGdlbkVsZW1lbnQgKGVsKSB7
CiAgaWYgKGVsLnN0YXRpY1Jvb3QgJiYgIWVsLnN0YXRpY1Byb2Nlc3NlZCkgewogICAgcmV0dXJu
IGdlblN0YXRpYyhlbCkKICB9IGVsc2UgaWYgKGVsLm9uY2UgJiYgIWVsLm9uY2VQcm9jZXNzZWQp
IHsKICAgIHJldHVybiBnZW5PbmNlKGVsKQogIH0gZWxzZSBpZiAoZWwuZm9yICYmICFlbC5mb3JQ
cm9jZXNzZWQpIHsKICAgIHJldHVybiBnZW5Gb3IoZWwpCiAgfSBlbHNlIGlmIChlbC5pZiAmJiAh
ZWwuaWZQcm9jZXNzZWQpIHsKICAgIHJldHVybiBnZW5JZihlbCkKICB9IGVsc2UgaWYgKGVsLnRh
ZyA9PT0gJ3RlbXBsYXRlJyAmJiAhZWwuc2xvdFRhcmdldCkgewogICAgcmV0dXJuIGdlbkNoaWxk
cmVuKGVsKSB8fCAndm9pZCAwJwogIH0gZWxzZSBpZiAoZWwudGFnID09PSAnc2xvdCcpIHsKICAg
IHJldHVybiBnZW5TbG90KGVsKQogIH0gZWxzZSB7CiAgICAvLyBjb21wb25lbnQgb3IgZWxlbWVu
dAogICAgdmFyIGNvZGU7CiAgICBpZiAoZWwuY29tcG9uZW50KSB7CiAgICAgIGNvZGUgPSBnZW5D
b21wb25lbnQoZWwuY29tcG9uZW50LCBlbCk7CiAgICB9IGVsc2UgewogICAgICB2YXIgZGF0YSA9
IGVsLnBsYWluID8gdW5kZWZpbmVkIDogZ2VuRGF0YShlbCk7CgogICAgICB2YXIgY2hpbGRyZW4g
PSBlbC5pbmxpbmVUZW1wbGF0ZSA/IG51bGwgOiBnZW5DaGlsZHJlbihlbCwgdHJ1ZSk7CiAgICAg
IGNvZGUgPSAiX2MoJyIgKyAoZWwudGFnKSArICInIiArIChkYXRhID8gKCIsIiArIGRhdGEpIDog
JycpICsgKGNoaWxkcmVuID8gKCIsIiArIGNoaWxkcmVuKSA6ICcnKSArICIpIjsKICAgIH0KICAg
IC8vIG1vZHVsZSB0cmFuc2Zvcm1zCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyYW5zZm9ybXMk
MS5sZW5ndGg7IGkrKykgewogICAgICBjb2RlID0gdHJhbnNmb3JtcyQxW2ldKGVsLCBjb2RlKTsK
ICAgIH0KICAgIHJldHVybiBjb2RlCiAgfQp9CgovLyBob2lzdCBzdGF0aWMgc3ViLXRyZWVzIG91
dApmdW5jdGlvbiBnZW5TdGF0aWMgKGVsKSB7CiAgZWwuc3RhdGljUHJvY2Vzc2VkID0gdHJ1ZTsK
ICBzdGF0aWNSZW5kZXJGbnMucHVzaCgoIndpdGgodGhpcyl7cmV0dXJuICIgKyAoZ2VuRWxlbWVu
dChlbCkpICsgIn0iKSk7CiAgcmV0dXJuICgiX20oIiArIChzdGF0aWNSZW5kZXJGbnMubGVuZ3Ro
IC0gMSkgKyAoZWwuc3RhdGljSW5Gb3IgPyAnLHRydWUnIDogJycpICsgIikiKQp9CgovLyB2LW9u
Y2UKZnVuY3Rpb24gZ2VuT25jZSAoZWwpIHsKICBlbC5vbmNlUHJvY2Vzc2VkID0gdHJ1ZTsKICBp
ZiAoZWwuaWYgJiYgIWVsLmlmUHJvY2Vzc2VkKSB7CiAgICByZXR1cm4gZ2VuSWYoZWwpCiAgfSBl
bHNlIGlmIChlbC5zdGF0aWNJbkZvcikgewogICAgdmFyIGtleSA9ICcnOwogICAgdmFyIHBhcmVu
dCA9IGVsLnBhcmVudDsKICAgIHdoaWxlIChwYXJlbnQpIHsKICAgICAgaWYgKHBhcmVudC5mb3Ip
IHsKICAgICAgICBrZXkgPSBwYXJlbnQua2V5OwogICAgICAgIGJyZWFrCiAgICAgIH0KICAgICAg
cGFyZW50ID0gcGFyZW50LnBhcmVudDsKICAgIH0KICAgIGlmICgha2V5KSB7CiAgICAgICJkZXZl
bG9wbWVudCIgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuJDIoCiAgICAgICAgInYtb25jZSBjYW4g
b25seSBiZSB1c2VkIGluc2lkZSB2LWZvciB0aGF0IGlzIGtleWVkLiAiCiAgICAgICk7CiAgICAg
IHJldHVybiBnZW5FbGVtZW50KGVsKQogICAgfQogICAgcmV0dXJuICgiX28oIiArIChnZW5FbGVt
ZW50KGVsKSkgKyAiLCIgKyAob25jZUNvdW50KyspICsgKGtleSA/ICgiLCIgKyBrZXkpIDogIiIp
ICsgIikiKQogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2VuU3RhdGljKGVsKQogIH0KfQoKZnVuY3Rp
b24gZ2VuSWYgKGVsKSB7CiAgZWwuaWZQcm9jZXNzZWQgPSB0cnVlOyAvLyBhdm9pZCByZWN1cnNp
b24KICByZXR1cm4gZ2VuSWZDb25kaXRpb25zKGVsLmlmQ29uZGl0aW9ucy5zbGljZSgpKQp9Cgpm
dW5jdGlvbiBnZW5JZkNvbmRpdGlvbnMgKGNvbmRpdGlvbnMpIHsKICBpZiAoIWNvbmRpdGlvbnMu
bGVuZ3RoKSB7CiAgICByZXR1cm4gJ19lKCknCiAgfQoKICB2YXIgY29uZGl0aW9uID0gY29uZGl0
aW9ucy5zaGlmdCgpOwogIGlmIChjb25kaXRpb24uZXhwKSB7CiAgICByZXR1cm4gKCIoIiArIChj
b25kaXRpb24uZXhwKSArICIpPyIgKyAoZ2VuVGVybmFyeUV4cChjb25kaXRpb24uYmxvY2spKSAr
ICI6IiArIChnZW5JZkNvbmRpdGlvbnMoY29uZGl0aW9ucykpKQogIH0gZWxzZSB7CiAgICByZXR1
cm4gKCIiICsgKGdlblRlcm5hcnlFeHAoY29uZGl0aW9uLmJsb2NrKSkpCiAgfQoKICAvLyB2LWlm
IHdpdGggdi1vbmNlIHNob3VsZCBnZW5lcmF0ZSBjb2RlIGxpa2UgKGEpP19tKDApOl9tKDEpCiAg
ZnVuY3Rpb24gZ2VuVGVybmFyeUV4cCAoZWwpIHsKICAgIHJldHVybiBlbC5vbmNlID8gZ2VuT25j
ZShlbCkgOiBnZW5FbGVtZW50KGVsKQogIH0KfQoKZnVuY3Rpb24gZ2VuRm9yIChlbCkgewogIHZh
ciBleHAgPSBlbC5mb3I7CiAgdmFyIGFsaWFzID0gZWwuYWxpYXM7CiAgdmFyIGl0ZXJhdG9yMSA9
IGVsLml0ZXJhdG9yMSA/ICgiLCIgKyAoZWwuaXRlcmF0b3IxKSkgOiAnJzsKICB2YXIgaXRlcmF0
b3IyID0gZWwuaXRlcmF0b3IyID8gKCIsIiArIChlbC5pdGVyYXRvcjIpKSA6ICcnOwogIGVsLmZv
clByb2Nlc3NlZCA9IHRydWU7IC8vIGF2b2lkIHJlY3Vyc2lvbgogIHJldHVybiAiX2woKCIgKyBl
eHAgKyAiKSwiICsKICAgICJmdW5jdGlvbigiICsgYWxpYXMgKyBpdGVyYXRvcjEgKyBpdGVyYXRv
cjIgKyAiKXsiICsKICAgICAgInJldHVybiAiICsgKGdlbkVsZW1lbnQoZWwpKSArCiAgICAnfSkn
Cn0KCmZ1bmN0aW9uIGdlbkRhdGEgKGVsKSB7CiAgdmFyIGRhdGEgPSAneyc7CgogIC8vIGRpcmVj
dGl2ZXMgZmlyc3QuCiAgLy8gZGlyZWN0aXZlcyBtYXkgbXV0YXRlIHRoZSBlbCdzIG90aGVyIHBy
b3BlcnRpZXMgYmVmb3JlIHRoZXkgYXJlIGdlbmVyYXRlZC4KICB2YXIgZGlycyA9IGdlbkRpcmVj
dGl2ZXMoZWwpOwogIGlmIChkaXJzKSB7IGRhdGEgKz0gZGlycyArICcsJzsgfQoKICAvLyBrZXkK
ICBpZiAoZWwua2V5KSB7CiAgICBkYXRhICs9ICJrZXk6IiArIChlbC5rZXkpICsgIiwiOwogIH0K
ICAvLyByZWYKICBpZiAoZWwucmVmKSB7CiAgICBkYXRhICs9ICJyZWY6IiArIChlbC5yZWYpICsg
IiwiOwogIH0KICBpZiAoZWwucmVmSW5Gb3IpIHsKICAgIGRhdGEgKz0gInJlZkluRm9yOnRydWUs
IjsKICB9CiAgLy8gcHJlCiAgaWYgKGVsLnByZSkgewogICAgZGF0YSArPSAicHJlOnRydWUsIjsK
ICB9CiAgLy8gcmVjb3JkIG9yaWdpbmFsIHRhZyBuYW1lIGZvciBjb21wb25lbnRzIHVzaW5nICJp
cyIgYXR0cmlidXRlCiAgaWYgKGVsLmNvbXBvbmVudCkgewogICAgZGF0YSArPSAidGFnOlwiIiAr
IChlbC50YWcpICsgIlwiLCI7CiAgfQogIC8vIG1vZHVsZSBkYXRhIGdlbmVyYXRpb24gZnVuY3Rp
b25zCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhR2VuRm5zLmxlbmd0aDsgaSsrKSB7CiAgICBk
YXRhICs9IGRhdGFHZW5GbnNbaV0oZWwpOwogIH0KICAvLyBhdHRyaWJ1dGVzCiAgaWYgKGVsLmF0
dHJzKSB7CiAgICBkYXRhICs9ICJhdHRyczp7IiArIChnZW5Qcm9wcyhlbC5hdHRycykpICsgIn0s
IjsKICB9CiAgLy8gRE9NIHByb3BzCiAgaWYgKGVsLnByb3BzKSB7CiAgICBkYXRhICs9ICJkb21Q
cm9wczp7IiArIChnZW5Qcm9wcyhlbC5wcm9wcykpICsgIn0sIjsKICB9CiAgLy8gZXZlbnQgaGFu
ZGxlcnMKICBpZiAoZWwuZXZlbnRzKSB7CiAgICBkYXRhICs9IChnZW5IYW5kbGVycyhlbC5ldmVu
dHMpKSArICIsIjsKICB9CiAgaWYgKGVsLm5hdGl2ZUV2ZW50cykgewogICAgZGF0YSArPSAoZ2Vu
SGFuZGxlcnMoZWwubmF0aXZlRXZlbnRzLCB0cnVlKSkgKyAiLCI7CiAgfQogIC8vIHNsb3QgdGFy
Z2V0CiAgaWYgKGVsLnNsb3RUYXJnZXQpIHsKICAgIGRhdGEgKz0gInNsb3Q6IiArIChlbC5zbG90
VGFyZ2V0KSArICIsIjsKICB9CiAgLy8gc2NvcGVkIHNsb3RzCiAgaWYgKGVsLnNjb3BlZFNsb3Rz
KSB7CiAgICBkYXRhICs9IChnZW5TY29wZWRTbG90cyhlbC5zY29wZWRTbG90cykpICsgIiwiOwog
IH0KICAvLyBpbmxpbmUtdGVtcGxhdGUKICBpZiAoZWwuaW5saW5lVGVtcGxhdGUpIHsKICAgIHZh
ciBpbmxpbmVUZW1wbGF0ZSA9IGdlbklubGluZVRlbXBsYXRlKGVsKTsKICAgIGlmIChpbmxpbmVU
ZW1wbGF0ZSkgewogICAgICBkYXRhICs9IGlubGluZVRlbXBsYXRlICsgIiwiOwogICAgfQogIH0K
ICBkYXRhID0gZGF0YS5yZXBsYWNlKC8sJC8sICcnKSArICd9JzsKICAvLyB2LWJpbmQgZGF0YSB3
cmFwCiAgaWYgKGVsLndyYXBEYXRhKSB7CiAgICBkYXRhID0gZWwud3JhcERhdGEoZGF0YSk7CiAg
fQogIHJldHVybiBkYXRhCn0KCmZ1bmN0aW9uIGdlbkRpcmVjdGl2ZXMgKGVsKSB7CiAgdmFyIGRp
cnMgPSBlbC5kaXJlY3RpdmVzOwogIGlmICghZGlycykgeyByZXR1cm4gfQogIHZhciByZXMgPSAn
ZGlyZWN0aXZlczpbJzsKICB2YXIgaGFzUnVudGltZSA9IGZhbHNlOwogIHZhciBpLCBsLCBkaXIs
IG5lZWRSdW50aW1lOwogIGZvciAoaSA9IDAsIGwgPSBkaXJzLmxlbmd0aDsgaSA8IGw7IGkrKykg
ewogICAgZGlyID0gZGlyc1tpXTsKICAgIG5lZWRSdW50aW1lID0gdHJ1ZTsKICAgIHZhciBnZW4g
PSBwbGF0Zm9ybURpcmVjdGl2ZXMkMVtkaXIubmFtZV0gfHwgYmFzZURpcmVjdGl2ZXNbZGlyLm5h
bWVdOwogICAgaWYgKGdlbikgewogICAgICAvLyBjb21waWxlLXRpbWUgZGlyZWN0aXZlIHRoYXQg
bWFuaXB1bGF0ZXMgQVNULgogICAgICAvLyByZXR1cm5zIHRydWUgaWYgaXQgYWxzbyBuZWVkcyBh
IHJ1bnRpbWUgY291bnRlcnBhcnQuCiAgICAgIG5lZWRSdW50aW1lID0gISFnZW4oZWwsIGRpciwg
d2FybiQyKTsKICAgIH0KICAgIGlmIChuZWVkUnVudGltZSkgewogICAgICBoYXNSdW50aW1lID0g
dHJ1ZTsKICAgICAgcmVzICs9ICJ7bmFtZTpcIiIgKyAoZGlyLm5hbWUpICsgIlwiLHJhd05hbWU6
XCIiICsgKGRpci5yYXdOYW1lKSArICJcIiIgKyAoZGlyLnZhbHVlID8gKCIsdmFsdWU6KCIgKyAo
ZGlyLnZhbHVlKSArICIpLGV4cHJlc3Npb246IiArIChKU09OLnN0cmluZ2lmeShkaXIudmFsdWUp
KSkgOiAnJykgKyAoZGlyLmFyZyA/ICgiLGFyZzpcIiIgKyAoZGlyLmFyZykgKyAiXCIiKSA6ICcn
KSArIChkaXIubW9kaWZpZXJzID8gKCIsbW9kaWZpZXJzOiIgKyAoSlNPTi5zdHJpbmdpZnkoZGly
Lm1vZGlmaWVycykpKSA6ICcnKSArICJ9LCI7CiAgICB9CiAgfQogIGlmIChoYXNSdW50aW1lKSB7
CiAgICByZXR1cm4gcmVzLnNsaWNlKDAsIC0xKSArICddJwogIH0KfQoKZnVuY3Rpb24gZ2VuSW5s
aW5lVGVtcGxhdGUgKGVsKSB7CiAgdmFyIGFzdCA9IGVsLmNoaWxkcmVuWzBdOwogIGlmICgiZGV2
ZWxvcG1lbnQiICE9PSAncHJvZHVjdGlvbicgJiYgKAogICAgZWwuY2hpbGRyZW4ubGVuZ3RoID4g
MSB8fCBhc3QudHlwZSAhPT0gMQogICkpIHsKICAgIHdhcm4kMignSW5saW5lLXRlbXBsYXRlIGNv
bXBvbmVudHMgbXVzdCBoYXZlIGV4YWN0bHkgb25lIGNoaWxkIGVsZW1lbnQuJyk7CiAgfQogIGlm
IChhc3QudHlwZSA9PT0gMSkgewogICAgdmFyIGlubGluZVJlbmRlckZucyA9IGdlbmVyYXRlKGFz
dCwgY3VycmVudE9wdGlvbnMpOwogICAgcmV0dXJuICgiaW5saW5lVGVtcGxhdGU6e3JlbmRlcjpm
dW5jdGlvbigpeyIgKyAoaW5saW5lUmVuZGVyRm5zLnJlbmRlcikgKyAifSxzdGF0aWNSZW5kZXJG
bnM6WyIgKyAoaW5saW5lUmVuZGVyRm5zLnN0YXRpY1JlbmRlckZucy5tYXAoZnVuY3Rpb24gKGNv
ZGUpIHsgcmV0dXJuICgiZnVuY3Rpb24oKXsiICsgY29kZSArICJ9Iik7IH0pLmpvaW4oJywnKSkg
KyAiXX0iKQogIH0KfQoKZnVuY3Rpb24gZ2VuU2NvcGVkU2xvdHMgKHNsb3RzKSB7CiAgcmV0dXJu
ICgic2NvcGVkU2xvdHM6eyIgKyAoT2JqZWN0LmtleXMoc2xvdHMpLm1hcChmdW5jdGlvbiAoa2V5
KSB7IHJldHVybiBnZW5TY29wZWRTbG90KGtleSwgc2xvdHNba2V5XSk7IH0pLmpvaW4oJywnKSkg
KyAifSIpCn0KCmZ1bmN0aW9uIGdlblNjb3BlZFNsb3QgKGtleSwgZWwpIHsKICByZXR1cm4ga2V5
ICsgIjpmdW5jdGlvbigiICsgKFN0cmluZyhlbC5hdHRyc01hcC5zY29wZSkpICsgIil7IiArCiAg
ICAicmV0dXJuICIgKyAoZWwudGFnID09PSAndGVtcGxhdGUnCiAgICAgID8gZ2VuQ2hpbGRyZW4o
ZWwpIHx8ICd2b2lkIDAnCiAgICAgIDogZ2VuRWxlbWVudChlbCkpICsgIn0iCn0KCmZ1bmN0aW9u
IGdlbkNoaWxkcmVuIChlbCwgY2hlY2tTa2lwKSB7CiAgdmFyIGNoaWxkcmVuID0gZWwuY2hpbGRy
ZW47CiAgaWYgKGNoaWxkcmVuLmxlbmd0aCkgewogICAgdmFyIGVsJDEgPSBjaGlsZHJlblswXTsK
ICAgIC8vIG9wdGltaXplIHNpbmdsZSB2LWZvcgogICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA9PT0g
MSAmJgogICAgICAgIGVsJDEuZm9yICYmCiAgICAgICAgZWwkMS50YWcgIT09ICd0ZW1wbGF0ZScg
JiYKICAgICAgICBlbCQxLnRhZyAhPT0gJ3Nsb3QnKSB7CiAgICAgIHJldHVybiBnZW5FbGVtZW50
KGVsJDEpCiAgICB9CiAgICByZXR1cm4gKCJbIiArIChjaGlsZHJlbi5tYXAoZ2VuTm9kZSkuam9p
bignLCcpKSArICJdIiArIChjaGVja1NraXAKICAgICAgICA/IGNhblNraXBOb3JtYWxpemF0aW9u
KGNoaWxkcmVuKSA/ICcnIDogJyx0cnVlJwogICAgICAgIDogJycpKQogIH0KfQoKZnVuY3Rpb24g
Y2FuU2tpcE5vcm1hbGl6YXRpb24gKGNoaWxkcmVuKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBj
aGlsZHJlbi5sZW5ndGg7IGkrKykgewogICAgdmFyIGVsID0gY2hpbGRyZW5baV07CiAgICBpZiAo
bmVlZHNOb3JtYWxpemF0aW9uKGVsKSB8fAogICAgICAgIChlbC5pZiAmJiBlbC5pZkNvbmRpdGlv
bnMuc29tZShmdW5jdGlvbiAoYykgeyByZXR1cm4gbmVlZHNOb3JtYWxpemF0aW9uKGMuYmxvY2sp
OyB9KSkpIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CiAgfQogIHJldHVybiB0cnVlCn0KCmZ1
bmN0aW9uIG5lZWRzTm9ybWFsaXphdGlvbiAoZWwpIHsKICByZXR1cm4gZWwuZm9yIHx8IGVsLnRh
ZyA9PT0gJ3RlbXBsYXRlJyB8fCBlbC50YWcgPT09ICdzbG90Jwp9CgpmdW5jdGlvbiBnZW5Ob2Rl
IChub2RlKSB7CiAgaWYgKG5vZGUudHlwZSA9PT0gMSkgewogICAgcmV0dXJuIGdlbkVsZW1lbnQo
bm9kZSkKICB9IGVsc2UgewogICAgcmV0dXJuIGdlblRleHQobm9kZSkKICB9Cn0KCmZ1bmN0aW9u
IGdlblRleHQgKHRleHQpIHsKICByZXR1cm4gKCJfdigiICsgKHRleHQudHlwZSA9PT0gMgogICAg
PyB0ZXh0LmV4cHJlc3Npb24gLy8gbm8gbmVlZCBmb3IgKCkgYmVjYXVzZSBhbHJlYWR5IHdyYXBw
ZWQgaW4gX3MoKQogICAgOiB0cmFuc2Zvcm1TcGVjaWFsTmV3bGluZXMoSlNPTi5zdHJpbmdpZnko
dGV4dC50ZXh0KSkpICsgIikiKQp9CgpmdW5jdGlvbiBnZW5TbG90IChlbCkgewogIHZhciBzbG90
TmFtZSA9IGVsLnNsb3ROYW1lIHx8ICciZGVmYXVsdCInOwogIHZhciBjaGlsZHJlbiA9IGdlbkNo
aWxkcmVuKGVsKTsKICByZXR1cm4gKCJfdCgiICsgc2xvdE5hbWUgKyAoY2hpbGRyZW4gPyAoIiwi
ICsgY2hpbGRyZW4pIDogJycpICsgKGVsLmF0dHJzID8gKChjaGlsZHJlbiA/ICcnIDogJyxudWxs
JykgKyAiLHsiICsgKGVsLmF0dHJzLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gKChjYW1lbGl6
ZShhLm5hbWUpKSArICI6IiArIChhLnZhbHVlKSk7IH0pLmpvaW4oJywnKSkgKyAifSIpIDogJycp
ICsgIikiKQp9CgovLyBjb21wb25lbnROYW1lIGlzIGVsLmNvbXBvbmVudCwgdGFrZSBpdCBhcyBh
cmd1bWVudCB0byBzaHVuIGZsb3cncyBwZXNzaW1pc3RpYyByZWZpbmVtZW50CmZ1bmN0aW9uIGdl
bkNvbXBvbmVudCAoY29tcG9uZW50TmFtZSwgZWwpIHsKICB2YXIgY2hpbGRyZW4gPSBlbC5pbmxp
bmVUZW1wbGF0ZSA/IG51bGwgOiBnZW5DaGlsZHJlbihlbCwgdHJ1ZSk7CiAgcmV0dXJuICgiX2Mo
IiArIGNvbXBvbmVudE5hbWUgKyAiLCIgKyAoZ2VuRGF0YShlbCkpICsgKGNoaWxkcmVuID8gKCIs
IiArIGNoaWxkcmVuKSA6ICcnKSArICIpIikKfQoKZnVuY3Rpb24gZ2VuUHJvcHMgKHByb3BzKSB7
CiAgdmFyIHJlcyA9ICcnOwogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKysp
IHsKICAgIHZhciBwcm9wID0gcHJvcHNbaV07CiAgICByZXMgKz0gIlwiIiArIChwcm9wLm5hbWUp
ICsgIlwiOiIgKyAodHJhbnNmb3JtU3BlY2lhbE5ld2xpbmVzKHByb3AudmFsdWUpKSArICIsIjsK
ICB9CiAgcmV0dXJuIHJlcy5zbGljZSgwLCAtMSkKfQoKLy8gIzM4OTUsICM0MjY4CmZ1bmN0aW9u
IHRyYW5zZm9ybVNwZWNpYWxOZXdsaW5lcyAodGV4dCkgewogIHJldHVybiB0ZXh0CiAgICAucmVw
bGFjZSgvXHUyMDI4L2csICdcXHUyMDI4JykKICAgIC5yZXBsYWNlKC9cdTIwMjkvZywgJ1xcdTIw
MjknKQp9CgovKiAgKi8KCi8qKgogKiBDb21waWxlIGEgdGVtcGxhdGUuCiAqLwpmdW5jdGlvbiBj
b21waWxlJDEgKAogIHRlbXBsYXRlLAogIG9wdGlvbnMKKSB7CiAgdmFyIGFzdCA9IHBhcnNlKHRl
bXBsYXRlLnRyaW0oKSwgb3B0aW9ucyk7CiAgb3B0aW1pemUoYXN0LCBvcHRpb25zKTsKICB2YXIg
Y29kZSA9IGdlbmVyYXRlKGFzdCwgb3B0aW9ucyk7CiAgcmV0dXJuIHsKICAgIGFzdDogYXN0LAog
ICAgcmVuZGVyOiBjb2RlLnJlbmRlciwKICAgIHN0YXRpY1JlbmRlckZuczogY29kZS5zdGF0aWNS
ZW5kZXJGbnMKICB9Cn0KCi8qICAqLwoKLy8gb3BlcmF0b3JzIGxpa2UgdHlwZW9mLCBpbnN0YW5j
ZW9mIGFuZCBpbiBhcmUgYWxsb3dlZAp2YXIgcHJvaGliaXRlZEtleXdvcmRSRSA9IG5ldyBSZWdF
eHAoJ1xcYicgKyAoCiAgJ2RvLGlmLGZvcixsZXQsbmV3LHRyeSx2YXIsY2FzZSxlbHNlLHdpdGgs
YXdhaXQsYnJlYWssY2F0Y2gsY2xhc3MsY29uc3QsJyArCiAgJ3N1cGVyLHRocm93LHdoaWxlLHlp
ZWxkLGRlbGV0ZSxleHBvcnQsaW1wb3J0LHJldHVybixzd2l0Y2gsZGVmYXVsdCwnICsKICAnZXh0
ZW5kcyxmaW5hbGx5LGNvbnRpbnVlLGRlYnVnZ2VyLGZ1bmN0aW9uLGFyZ3VtZW50cycKKS5zcGxp
dCgnLCcpLmpvaW4oJ1xcYnxcXGInKSArICdcXGInKTsKLy8gY2hlY2sgdmFsaWQgaWRlbnRpZmll
ciBmb3Igdi1mb3IKdmFyIGlkZW50UkUgPSAvW0EtWmEtel8kXVtcdyRdKi87Ci8vIHN0cmlwIHN0
cmluZ3MgaW4gZXhwcmVzc2lvbnMKdmFyIHN0cmlwU3RyaW5nUkUgPSAvJyg/OlteJ1xcXXxcXC4p
Kid8Iig/OlteIlxcXXxcXC4pKiJ8YCg/OlteYFxcXXxcXC4pKlwkXHt8XH0oPzpbXmBcXF18XFwu
KSpgfGAoPzpbXmBcXF18XFwuKSpgL2c7CgovLyBkZXRlY3QgcHJvYmxlbWF0aWMgZXhwcmVzc2lv
bnMgaW4gYSB0ZW1wbGF0ZQpmdW5jdGlvbiBkZXRlY3RFcnJvcnMgKGFzdCkgewogIHZhciBlcnJv
cnMgPSBbXTsKICBpZiAoYXN0KSB7CiAgICBjaGVja05vZGUoYXN0LCBlcnJvcnMpOwogIH0KICBy
ZXR1cm4gZXJyb3JzCn0KCmZ1bmN0aW9uIGNoZWNrTm9kZSAobm9kZSwgZXJyb3JzKSB7CiAgaWYg
KG5vZGUudHlwZSA9PT0gMSkgewogICAgZm9yICh2YXIgbmFtZSBpbiBub2RlLmF0dHJzTWFwKSB7
CiAgICAgIGlmIChkaXJSRS50ZXN0KG5hbWUpKSB7CiAgICAgICAgdmFyIHZhbHVlID0gbm9kZS5h
dHRyc01hcFtuYW1lXTsKICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgIGlmIChuYW1lID09
PSAndi1mb3InKSB7CiAgICAgICAgICAgIGNoZWNrRm9yKG5vZGUsICgidi1mb3I9XCIiICsgdmFs
dWUgKyAiXCIiKSwgZXJyb3JzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNoZWNr
RXhwcmVzc2lvbih2YWx1ZSwgKG5hbWUgKyAiPVwiIiArIHZhbHVlICsgIlwiIiksIGVycm9ycyk7
CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAobm9kZS5jaGlsZHJl
bikgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpKysp
IHsKICAgICAgICBjaGVja05vZGUobm9kZS5jaGlsZHJlbltpXSwgZXJyb3JzKTsKICAgICAgfQog
ICAgfQogIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSAyKSB7CiAgICBjaGVja0V4cHJlc3Npb24o
bm9kZS5leHByZXNzaW9uLCBub2RlLnRleHQsIGVycm9ycyk7CiAgfQp9CgpmdW5jdGlvbiBjaGVj
a0ZvciAobm9kZSwgdGV4dCwgZXJyb3JzKSB7CiAgY2hlY2tFeHByZXNzaW9uKG5vZGUuZm9yIHx8
ICcnLCB0ZXh0LCBlcnJvcnMpOwogIGNoZWNrSWRlbnRpZmllcihub2RlLmFsaWFzLCAndi1mb3Ig
YWxpYXMnLCB0ZXh0LCBlcnJvcnMpOwogIGNoZWNrSWRlbnRpZmllcihub2RlLml0ZXJhdG9yMSwg
J3YtZm9yIGl0ZXJhdG9yJywgdGV4dCwgZXJyb3JzKTsKICBjaGVja0lkZW50aWZpZXIobm9kZS5p
dGVyYXRvcjIsICd2LWZvciBpdGVyYXRvcicsIHRleHQsIGVycm9ycyk7Cn0KCmZ1bmN0aW9uIGNo
ZWNrSWRlbnRpZmllciAoaWRlbnQsIHR5cGUsIHRleHQsIGVycm9ycykgewogIGlmICh0eXBlb2Yg
aWRlbnQgPT09ICdzdHJpbmcnICYmICFpZGVudFJFLnRlc3QoaWRlbnQpKSB7CiAgICBlcnJvcnMu
cHVzaCgoIi0gaW52YWxpZCAiICsgdHlwZSArICIgXCIiICsgaWRlbnQgKyAiXCIgaW4gZXhwcmVz
c2lvbjogIiArIHRleHQpKTsKICB9Cn0KCmZ1bmN0aW9uIGNoZWNrRXhwcmVzc2lvbiAoZXhwLCB0
ZXh0LCBlcnJvcnMpIHsKICB0cnkgewogICAgbmV3IEZ1bmN0aW9uKCgicmV0dXJuICIgKyBleHAp
KTsKICB9IGNhdGNoIChlKSB7CiAgICB2YXIga2V5d29yZE1hdGNoID0gZXhwLnJlcGxhY2Uoc3Ry
aXBTdHJpbmdSRSwgJycpLm1hdGNoKHByb2hpYml0ZWRLZXl3b3JkUkUpOwogICAgaWYgKGtleXdv
cmRNYXRjaCkgewogICAgICBlcnJvcnMucHVzaCgKICAgICAgICAiLSBhdm9pZCB1c2luZyBKYXZh
U2NyaXB0IGtleXdvcmQgYXMgcHJvcGVydHkgbmFtZTogIiArCiAgICAgICAgIlwiIiArIChrZXl3
b3JkTWF0Y2hbMF0pICsgIlwiIGluIGV4cHJlc3Npb24gIiArIHRleHQKICAgICAgKTsKICAgIH0g
ZWxzZSB7CiAgICAgIGVycm9ycy5wdXNoKCgiLSBpbnZhbGlkIGV4cHJlc3Npb246ICIgKyB0ZXh0
KSk7CiAgICB9CiAgfQp9CgovKiAgKi8KCmZ1bmN0aW9uIHRyYW5zZm9ybU5vZGUgKGVsLCBvcHRp
b25zKSB7CiAgdmFyIHdhcm4gPSBvcHRpb25zLndhcm4gfHwgYmFzZVdhcm47CiAgdmFyIHN0YXRp
Y0NsYXNzID0gZ2V0QW5kUmVtb3ZlQXR0cihlbCwgJ2NsYXNzJyk7CiAgaWYgKCJkZXZlbG9wbWVu
dCIgIT09ICdwcm9kdWN0aW9uJyAmJiBzdGF0aWNDbGFzcykgewogICAgdmFyIGV4cHJlc3Npb24g
PSBwYXJzZVRleHQoc3RhdGljQ2xhc3MsIG9wdGlvbnMuZGVsaW1pdGVycyk7CiAgICBpZiAoZXhw
cmVzc2lvbikgewogICAgICB3YXJuKAogICAgICAgICJjbGFzcz1cIiIgKyBzdGF0aWNDbGFzcyAr
ICJcIjogIiArCiAgICAgICAgJ0ludGVycG9sYXRpb24gaW5zaWRlIGF0dHJpYnV0ZXMgaGFzIGJl
ZW4gcmVtb3ZlZC4gJyArCiAgICAgICAgJ1VzZSB2LWJpbmQgb3IgdGhlIGNvbG9uIHNob3J0aGFu
ZCBpbnN0ZWFkLiBGb3IgZXhhbXBsZSwgJyArCiAgICAgICAgJ2luc3RlYWQgb2YgPGRpdiBjbGFz
cz0ie3sgdmFsIH19Ij4sIHVzZSA8ZGl2IDpjbGFzcz0idmFsIj4uJwogICAgICApOwogICAgfQog
IH0KICBpZiAoc3RhdGljQ2xhc3MpIHsKICAgIGVsLnN0YXRpY0NsYXNzID0gSlNPTi5zdHJpbmdp
Znkoc3RhdGljQ2xhc3MpOwogIH0KICB2YXIgY2xhc3NCaW5kaW5nID0gZ2V0QmluZGluZ0F0dHIo
ZWwsICdjbGFzcycsIGZhbHNlIC8qIGdldFN0YXRpYyAqLyk7CiAgaWYgKGNsYXNzQmluZGluZykg
ewogICAgZWwuY2xhc3NCaW5kaW5nID0gY2xhc3NCaW5kaW5nOwogIH0KfQoKZnVuY3Rpb24gZ2Vu
RGF0YSQxIChlbCkgewogIHZhciBkYXRhID0gJyc7CiAgaWYgKGVsLnN0YXRpY0NsYXNzKSB7CiAg
ICBkYXRhICs9ICJzdGF0aWNDbGFzczoiICsgKGVsLnN0YXRpY0NsYXNzKSArICIsIjsKICB9CiAg
aWYgKGVsLmNsYXNzQmluZGluZykgewogICAgZGF0YSArPSAiY2xhc3M6IiArIChlbC5jbGFzc0Jp
bmRpbmcpICsgIiwiOwogIH0KICByZXR1cm4gZGF0YQp9Cgp2YXIga2xhc3MkMSA9IHsKICBzdGF0
aWNLZXlzOiBbJ3N0YXRpY0NsYXNzJ10sCiAgdHJhbnNmb3JtTm9kZTogdHJhbnNmb3JtTm9kZSwK
ICBnZW5EYXRhOiBnZW5EYXRhJDEKfTsKCi8qICAqLwoKZnVuY3Rpb24gdHJhbnNmb3JtTm9kZSQx
IChlbCwgb3B0aW9ucykgewogIHZhciB3YXJuID0gb3B0aW9ucy53YXJuIHx8IGJhc2VXYXJuOwog
IHZhciBzdGF0aWNTdHlsZSA9IGdldEFuZFJlbW92ZUF0dHIoZWwsICdzdHlsZScpOwogIGlmIChz
dGF0aWNTdHlsZSkgewogICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgICB7CiAgICAgIHZh
ciBleHByZXNzaW9uID0gcGFyc2VUZXh0KHN0YXRpY1N0eWxlLCBvcHRpb25zLmRlbGltaXRlcnMp
OwogICAgICBpZiAoZXhwcmVzc2lvbikgewogICAgICAgIHdhcm4oCiAgICAgICAgICAic3R5bGU9
XCIiICsgc3RhdGljU3R5bGUgKyAiXCI6ICIgKwogICAgICAgICAgJ0ludGVycG9sYXRpb24gaW5z
aWRlIGF0dHJpYnV0ZXMgaGFzIGJlZW4gcmVtb3ZlZC4gJyArCiAgICAgICAgICAnVXNlIHYtYmlu
ZCBvciB0aGUgY29sb24gc2hvcnRoYW5kIGluc3RlYWQuIEZvciBleGFtcGxlLCAnICsKICAgICAg
ICAgICdpbnN0ZWFkIG9mIDxkaXYgc3R5bGU9Int7IHZhbCB9fSI+LCB1c2UgPGRpdiA6c3R5bGU9
InZhbCI+LicKICAgICAgICApOwogICAgICB9CiAgICB9CiAgICBlbC5zdGF0aWNTdHlsZSA9IEpT
T04uc3RyaW5naWZ5KHBhcnNlU3R5bGVUZXh0KHN0YXRpY1N0eWxlKSk7CiAgfQoKICB2YXIgc3R5
bGVCaW5kaW5nID0gZ2V0QmluZGluZ0F0dHIoZWwsICdzdHlsZScsIGZhbHNlIC8qIGdldFN0YXRp
YyAqLyk7CiAgaWYgKHN0eWxlQmluZGluZykgewogICAgZWwuc3R5bGVCaW5kaW5nID0gc3R5bGVC
aW5kaW5nOwogIH0KfQoKZnVuY3Rpb24gZ2VuRGF0YSQyIChlbCkgewogIHZhciBkYXRhID0gJyc7
CiAgaWYgKGVsLnN0YXRpY1N0eWxlKSB7CiAgICBkYXRhICs9ICJzdGF0aWNTdHlsZToiICsgKGVs
LnN0YXRpY1N0eWxlKSArICIsIjsKICB9CiAgaWYgKGVsLnN0eWxlQmluZGluZykgewogICAgZGF0
YSArPSAic3R5bGU6KCIgKyAoZWwuc3R5bGVCaW5kaW5nKSArICIpLCI7CiAgfQogIHJldHVybiBk
YXRhCn0KCnZhciBzdHlsZSQxID0gewogIHN0YXRpY0tleXM6IFsnc3RhdGljU3R5bGUnXSwKICB0
cmFuc2Zvcm1Ob2RlOiB0cmFuc2Zvcm1Ob2RlJDEsCiAgZ2VuRGF0YTogZ2VuRGF0YSQyCn07Cgp2
YXIgbW9kdWxlcyQxID0gWwogIGtsYXNzJDEsCiAgc3R5bGUkMQpdOwoKLyogICovCgp2YXIgd2Fy
biQzOwoKZnVuY3Rpb24gbW9kZWwkMSAoCiAgZWwsCiAgZGlyLAogIF93YXJuCikgewogIHdhcm4k
MyA9IF93YXJuOwogIHZhciB2YWx1ZSA9IGRpci52YWx1ZTsKICB2YXIgbW9kaWZpZXJzID0gZGly
Lm1vZGlmaWVyczsKICB2YXIgdGFnID0gZWwudGFnOwogIHZhciB0eXBlID0gZWwuYXR0cnNNYXAu
dHlwZTsKICB7CiAgICB2YXIgZHluYW1pY1R5cGUgPSBlbC5hdHRyc01hcFsndi1iaW5kOnR5cGUn
XSB8fCBlbC5hdHRyc01hcFsnOnR5cGUnXTsKICAgIGlmICh0YWcgPT09ICdpbnB1dCcgJiYgZHlu
YW1pY1R5cGUpIHsKICAgICAgd2FybiQzKAogICAgICAgICI8aW5wdXQgOnR5cGU9XCIiICsgZHlu
YW1pY1R5cGUgKyAiXCIgdi1tb2RlbD1cIiIgKyB2YWx1ZSArICJcIj46XG4iICsKICAgICAgICAi
di1tb2RlbCBkb2VzIG5vdCBzdXBwb3J0IGR5bmFtaWMgaW5wdXQgdHlwZXMuIFVzZSB2LWlmIGJy
YW5jaGVzIGluc3RlYWQuIgogICAgICApOwogICAgfQogIH0KICBpZiAodGFnID09PSAnc2VsZWN0
JykgewogICAgZ2VuU2VsZWN0KGVsLCB2YWx1ZSwgbW9kaWZpZXJzKTsKICB9IGVsc2UgaWYgKHRh
ZyA9PT0gJ2lucHV0JyAmJiB0eXBlID09PSAnY2hlY2tib3gnKSB7CiAgICBnZW5DaGVja2JveE1v
ZGVsKGVsLCB2YWx1ZSwgbW9kaWZpZXJzKTsKICB9IGVsc2UgaWYgKHRhZyA9PT0gJ2lucHV0JyAm
JiB0eXBlID09PSAncmFkaW8nKSB7CiAgICBnZW5SYWRpb01vZGVsKGVsLCB2YWx1ZSwgbW9kaWZp
ZXJzKTsKICB9IGVsc2UgewogICAgZ2VuRGVmYXVsdE1vZGVsKGVsLCB2YWx1ZSwgbW9kaWZpZXJz
KTsKICB9CiAgLy8gZW5zdXJlIHJ1bnRpbWUgZGlyZWN0aXZlIG1ldGFkYXRhCiAgcmV0dXJuIHRy
dWUKfQoKZnVuY3Rpb24gZ2VuQ2hlY2tib3hNb2RlbCAoCiAgZWwsCiAgdmFsdWUsCiAgbW9kaWZp
ZXJzCikgewogIGlmICgiZGV2ZWxvcG1lbnQiICE9PSAncHJvZHVjdGlvbicgJiYKICAgIGVsLmF0
dHJzTWFwLmNoZWNrZWQgIT0gbnVsbCkgewogICAgd2FybiQzKAogICAgICAiPCIgKyAoZWwudGFn
KSArICIgdi1tb2RlbD1cIiIgKyB2YWx1ZSArICJcIiBjaGVja2VkPjpcbiIgKwogICAgICAiaW5s
aW5lIGNoZWNrZWQgYXR0cmlidXRlcyB3aWxsIGJlIGlnbm9yZWQgd2hlbiB1c2luZyB2LW1vZGVs
LiAiICsKICAgICAgJ0RlY2xhcmUgaW5pdGlhbCB2YWx1ZXMgaW4gdGhlIGNvbXBvbmVudFwncyBk
YXRhIG9wdGlvbiBpbnN0ZWFkLicKICAgICk7CiAgfQogIHZhciBudW1iZXIgPSBtb2RpZmllcnMg
JiYgbW9kaWZpZXJzLm51bWJlcjsKICB2YXIgdmFsdWVCaW5kaW5nID0gZ2V0QmluZGluZ0F0dHIo
ZWwsICd2YWx1ZScpIHx8ICdudWxsJzsKICB2YXIgdHJ1ZVZhbHVlQmluZGluZyA9IGdldEJpbmRp
bmdBdHRyKGVsLCAndHJ1ZS12YWx1ZScpIHx8ICd0cnVlJzsKICB2YXIgZmFsc2VWYWx1ZUJpbmRp
bmcgPSBnZXRCaW5kaW5nQXR0cihlbCwgJ2ZhbHNlLXZhbHVlJykgfHwgJ2ZhbHNlJzsKICBhZGRQ
cm9wKGVsLCAnY2hlY2tlZCcsCiAgICAiQXJyYXkuaXNBcnJheSgiICsgdmFsdWUgKyAiKSIgKwog
ICAgICAiP19pKCIgKyB2YWx1ZSArICIsIiArIHZhbHVlQmluZGluZyArICIpPi0xIiArCiAgICAg
ICI6X3EoIiArIHZhbHVlICsgIiwiICsgdHJ1ZVZhbHVlQmluZGluZyArICIpIgogICk7CiAgYWRk
SGFuZGxlcihlbCwgJ2NoYW5nZScsCiAgICAidmFyICQkYT0iICsgdmFsdWUgKyAiLCIgKwogICAg
ICAgICckJGVsPSRldmVudC50YXJnZXQsJyArCiAgICAgICAgIiQkYz0kJGVsLmNoZWNrZWQ/KCIg
KyB0cnVlVmFsdWVCaW5kaW5nICsgIik6KCIgKyBmYWxzZVZhbHVlQmluZGluZyArICIpOyIgKwog
ICAgJ2lmKEFycmF5LmlzQXJyYXkoJCRhKSl7JyArCiAgICAgICJ2YXIgJCR2PSIgKyAobnVtYmVy
ID8gJ19uKCcgKyB2YWx1ZUJpbmRpbmcgKyAnKScgOiB2YWx1ZUJpbmRpbmcpICsgIiwiICsKICAg
ICAgICAgICckJGk9X2koJCRhLCQkdik7JyArCiAgICAgICJpZigkJGMpeyQkaTwwJiYoIiArIHZh
bHVlICsgIj0kJGEuY29uY2F0KCQkdikpfSIgKwogICAgICAiZWxzZXskJGk+LTEmJigiICsgdmFs
dWUgKyAiPSQkYS5zbGljZSgwLCQkaSkuY29uY2F0KCQkYS5zbGljZSgkJGkrMSkpKX0iICsKICAg
ICJ9ZWxzZXsiICsgdmFsdWUgKyAiPSQkY30iLAogICAgbnVsbCwgdHJ1ZQogICk7Cn0KCmZ1bmN0
aW9uIGdlblJhZGlvTW9kZWwgKAogICAgZWwsCiAgICB2YWx1ZSwKICAgIG1vZGlmaWVycwopIHsK
ICBpZiAoImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmCiAgICBlbC5hdHRyc01hcC5j
aGVja2VkICE9IG51bGwpIHsKICAgIHdhcm4kMygKICAgICAgIjwiICsgKGVsLnRhZykgKyAiIHYt
bW9kZWw9XCIiICsgdmFsdWUgKyAiXCIgY2hlY2tlZD46XG4iICsKICAgICAgImlubGluZSBjaGVj
a2VkIGF0dHJpYnV0ZXMgd2lsbCBiZSBpZ25vcmVkIHdoZW4gdXNpbmcgdi1tb2RlbC4gIiArCiAg
ICAgICdEZWNsYXJlIGluaXRpYWwgdmFsdWVzIGluIHRoZSBjb21wb25lbnRcJ3MgZGF0YSBvcHRp
b24gaW5zdGVhZC4nCiAgICApOwogIH0KICB2YXIgbnVtYmVyID0gbW9kaWZpZXJzICYmIG1vZGlm
aWVycy5udW1iZXI7CiAgdmFyIHZhbHVlQmluZGluZyA9IGdldEJpbmRpbmdBdHRyKGVsLCAndmFs
dWUnKSB8fCAnbnVsbCc7CiAgdmFsdWVCaW5kaW5nID0gbnVtYmVyID8gKCJfbigiICsgdmFsdWVC
aW5kaW5nICsgIikiKSA6IHZhbHVlQmluZGluZzsKICBhZGRQcm9wKGVsLCAnY2hlY2tlZCcsICgi
X3EoIiArIHZhbHVlICsgIiwiICsgdmFsdWVCaW5kaW5nICsgIikiKSk7CiAgYWRkSGFuZGxlcihl
bCwgJ2NoYW5nZScsIGdlbkFzc2lnbm1lbnRDb2RlKHZhbHVlLCB2YWx1ZUJpbmRpbmcpLCBudWxs
LCB0cnVlKTsKfQoKZnVuY3Rpb24gZ2VuRGVmYXVsdE1vZGVsICgKICBlbCwKICB2YWx1ZSwKICBt
b2RpZmllcnMKKSB7CiAgewogICAgaWYgKGVsLnRhZyA9PT0gJ2lucHV0JyAmJiBlbC5hdHRyc01h
cC52YWx1ZSkgewogICAgICB3YXJuJDMoCiAgICAgICAgIjwiICsgKGVsLnRhZykgKyAiIHYtbW9k
ZWw9XCIiICsgdmFsdWUgKyAiXCIgdmFsdWU9XCIiICsgKGVsLmF0dHJzTWFwLnZhbHVlKSArICJc
Ij46XG4iICsKICAgICAgICAnaW5saW5lIHZhbHVlIGF0dHJpYnV0ZXMgd2lsbCBiZSBpZ25vcmVk
IHdoZW4gdXNpbmcgdi1tb2RlbC4gJyArCiAgICAgICAgJ0RlY2xhcmUgaW5pdGlhbCB2YWx1ZXMg
aW4gdGhlIGNvbXBvbmVudFwncyBkYXRhIG9wdGlvbiBpbnN0ZWFkLicKICAgICAgKTsKICAgIH0K
ICAgIGlmIChlbC50YWcgPT09ICd0ZXh0YXJlYScgJiYgZWwuY2hpbGRyZW4ubGVuZ3RoKSB7CiAg
ICAgIHdhcm4kMygKICAgICAgICAiPHRleHRhcmVhIHYtbW9kZWw9XCIiICsgdmFsdWUgKyAiXCI+
OlxuIiArCiAgICAgICAgJ2lubGluZSBjb250ZW50IGluc2lkZSA8dGV4dGFyZWE+IHdpbGwgYmUg
aWdub3JlZCB3aGVuIHVzaW5nIHYtbW9kZWwuICcgKwogICAgICAgICdEZWNsYXJlIGluaXRpYWwg
dmFsdWVzIGluIHRoZSBjb21wb25lbnRcJ3MgZGF0YSBvcHRpb24gaW5zdGVhZC4nCiAgICAgICk7
CiAgICB9CiAgfQoKICB2YXIgdHlwZSA9IGVsLmF0dHJzTWFwLnR5cGU7CiAgdmFyIHJlZiA9IG1v
ZGlmaWVycyB8fCB7fTsKICB2YXIgbGF6eSA9IHJlZi5sYXp5OwogIHZhciBudW1iZXIgPSByZWYu
bnVtYmVyOwogIHZhciB0cmltID0gcmVmLnRyaW07CiAgdmFyIGV2ZW50ID0gbGF6eSB8fCAoaXNJ
RSAmJiB0eXBlID09PSAncmFuZ2UnKSA/ICdjaGFuZ2UnIDogJ2lucHV0JzsKICB2YXIgbmVlZENv
bXBvc2l0aW9uR3VhcmQgPSAhbGF6eSAmJiB0eXBlICE9PSAncmFuZ2UnOwogIHZhciBpc05hdGl2
ZSA9IGVsLnRhZyA9PT0gJ2lucHV0JyB8fCBlbC50YWcgPT09ICd0ZXh0YXJlYSc7CgogIHZhciB2
YWx1ZUV4cHJlc3Npb24gPSBpc05hdGl2ZQogICAgPyAoIiRldmVudC50YXJnZXQudmFsdWUiICsg
KHRyaW0gPyAnLnRyaW0oKScgOiAnJykpCiAgICA6IHRyaW0gPyAiKHR5cGVvZiAkZXZlbnQgPT09
ICdzdHJpbmcnID8gJGV2ZW50LnRyaW0oKSA6ICRldmVudCkiIDogIiRldmVudCI7CiAgdmFsdWVF
eHByZXNzaW9uID0gbnVtYmVyIHx8IHR5cGUgPT09ICdudW1iZXInCiAgICA/ICgiX24oIiArIHZh
bHVlRXhwcmVzc2lvbiArICIpIikKICAgIDogdmFsdWVFeHByZXNzaW9uOwoKICB2YXIgY29kZSA9
IGdlbkFzc2lnbm1lbnRDb2RlKHZhbHVlLCB2YWx1ZUV4cHJlc3Npb24pOwogIGlmIChpc05hdGl2
ZSAmJiBuZWVkQ29tcG9zaXRpb25HdWFyZCkgewogICAgY29kZSA9ICJpZigkZXZlbnQudGFyZ2V0
LmNvbXBvc2luZylyZXR1cm47IiArIGNvZGU7CiAgfQoKICAvLyBpbnB1dHMgd2l0aCB0eXBlPSJm
aWxlIiBhcmUgcmVhZCBvbmx5IGFuZCBzZXR0aW5nIHRoZSBpbnB1dCdzCiAgLy8gdmFsdWUgd2ls
bCB0aHJvdyBhbiBlcnJvci4KICBpZiAoImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYm
CiAgICAgIHR5cGUgPT09ICdmaWxlJykgewogICAgd2FybiQzKAogICAgICAiPCIgKyAoZWwudGFn
KSArICIgdi1tb2RlbD1cIiIgKyB2YWx1ZSArICJcIiB0eXBlPVwiZmlsZVwiPjpcbiIgKwogICAg
ICAiRmlsZSBpbnB1dHMgYXJlIHJlYWQgb25seS4gVXNlIGEgdi1vbjpjaGFuZ2UgbGlzdGVuZXIg
aW5zdGVhZC4iCiAgICApOwogIH0KCiAgYWRkUHJvcChlbCwgJ3ZhbHVlJywgaXNOYXRpdmUgPyAo
Il9zKCIgKyB2YWx1ZSArICIpIikgOiAoIigiICsgdmFsdWUgKyAiKSIpKTsKICBhZGRIYW5kbGVy
KGVsLCBldmVudCwgY29kZSwgbnVsbCwgdHJ1ZSk7CiAgaWYgKHRyaW0gfHwgbnVtYmVyIHx8IHR5
cGUgPT09ICdudW1iZXInKSB7CiAgICBhZGRIYW5kbGVyKGVsLCAnYmx1cicsICckZm9yY2VVcGRh
dGUoKScpOwogIH0KfQoKZnVuY3Rpb24gZ2VuU2VsZWN0ICgKICAgIGVsLAogICAgdmFsdWUsCiAg
ICBtb2RpZmllcnMKKSB7CiAgewogICAgZWwuY2hpbGRyZW4uc29tZShjaGVja09wdGlvbldhcm5p
bmcpOwogIH0KCiAgdmFyIG51bWJlciA9IG1vZGlmaWVycyAmJiBtb2RpZmllcnMubnVtYmVyOwog
IHZhciBhc3NpZ25tZW50ID0gIkFycmF5LnByb3RvdHlwZS5maWx0ZXIiICsKICAgICIuY2FsbCgk
ZXZlbnQudGFyZ2V0Lm9wdGlvbnMsZnVuY3Rpb24obyl7cmV0dXJuIG8uc2VsZWN0ZWR9KSIgKwog
ICAgIi5tYXAoZnVuY3Rpb24obyl7dmFyIHZhbCA9IFwiX3ZhbHVlXCIgaW4gbyA/IG8uX3ZhbHVl
IDogby52YWx1ZTsiICsKICAgICJyZXR1cm4gIiArIChudW1iZXIgPyAnX24odmFsKScgOiAndmFs
JykgKyAifSkiICsKICAgIChlbC5hdHRyc01hcC5tdWx0aXBsZSA9PSBudWxsID8gJ1swXScgOiAn
Jyk7CgogIHZhciBjb2RlID0gZ2VuQXNzaWdubWVudENvZGUodmFsdWUsIGFzc2lnbm1lbnQpOwog
IGFkZEhhbmRsZXIoZWwsICdjaGFuZ2UnLCBjb2RlLCBudWxsLCB0cnVlKTsKfQoKZnVuY3Rpb24g
Y2hlY2tPcHRpb25XYXJuaW5nIChvcHRpb24pIHsKICBpZiAob3B0aW9uLnR5cGUgPT09IDEgJiYK
ICAgIG9wdGlvbi50YWcgPT09ICdvcHRpb24nICYmCiAgICBvcHRpb24uYXR0cnNNYXAuc2VsZWN0
ZWQgIT0gbnVsbCkgewogICAgd2FybiQzKAogICAgICAiPHNlbGVjdCB2LW1vZGVsPVwiIiArIChv
cHRpb24ucGFyZW50LmF0dHJzTWFwWyd2LW1vZGVsJ10pICsgIlwiPjpcbiIgKwogICAgICAnaW5s
aW5lIHNlbGVjdGVkIGF0dHJpYnV0ZXMgb24gPG9wdGlvbj4gd2lsbCBiZSBpZ25vcmVkIHdoZW4g
dXNpbmcgdi1tb2RlbC4gJyArCiAgICAgICdEZWNsYXJlIGluaXRpYWwgdmFsdWVzIGluIHRoZSBj
b21wb25lbnRcJ3MgZGF0YSBvcHRpb24gaW5zdGVhZC4nCiAgICApOwogICAgcmV0dXJuIHRydWUK
ICB9CiAgcmV0dXJuIGZhbHNlCn0KCmZ1bmN0aW9uIGdlbkFzc2lnbm1lbnRDb2RlICh2YWx1ZSwg
YXNzaWdubWVudCkgewogIHZhciBtb2RlbFJzID0gcGFyc2VNb2RlbCh2YWx1ZSk7CiAgaWYgKG1v
ZGVsUnMuaWR4ID09PSBudWxsKSB7CiAgICByZXR1cm4gKHZhbHVlICsgIj0iICsgYXNzaWdubWVu
dCkKICB9IGVsc2UgewogICAgcmV0dXJuICJ2YXIgJCRleHAgPSAiICsgKG1vZGVsUnMuZXhwKSAr
ICIsICQkaWR4ID0gIiArIChtb2RlbFJzLmlkeCkgKyAiOyIgKwogICAgICAiaWYgKCFBcnJheS5p
c0FycmF5KCQkZXhwKSl7IiArCiAgICAgICAgdmFsdWUgKyAiPSIgKyBhc3NpZ25tZW50ICsgIn0i
ICsKICAgICAgImVsc2V7JCRleHAuc3BsaWNlKCQkaWR4LCAxLCAiICsgYXNzaWdubWVudCArICIp
fSIKICB9Cn0KCi8qICAqLwoKZnVuY3Rpb24gdGV4dCAoZWwsIGRpcikgewogIGlmIChkaXIudmFs
dWUpIHsKICAgIGFkZFByb3AoZWwsICd0ZXh0Q29udGVudCcsICgiX3MoIiArIChkaXIudmFsdWUp
ICsgIikiKSk7CiAgfQp9CgovKiAgKi8KCmZ1bmN0aW9uIGh0bWwgKGVsLCBkaXIpIHsKICBpZiAo
ZGlyLnZhbHVlKSB7CiAgICBhZGRQcm9wKGVsLCAnaW5uZXJIVE1MJywgKCJfcygiICsgKGRpci52
YWx1ZSkgKyAiKSIpKTsKICB9Cn0KCnZhciBkaXJlY3RpdmVzJDEgPSB7CiAgbW9kZWw6IG1vZGVs
JDEsCiAgdGV4dDogdGV4dCwKICBodG1sOiBodG1sCn07CgovKiAgKi8KCnZhciBjYWNoZSA9IE9i
amVjdC5jcmVhdGUobnVsbCk7Cgp2YXIgYmFzZU9wdGlvbnMgPSB7CiAgZXhwZWN0SFRNTDogdHJ1
ZSwKICBtb2R1bGVzOiBtb2R1bGVzJDEsCiAgc3RhdGljS2V5czogZ2VuU3RhdGljS2V5cyhtb2R1
bGVzJDEpLAogIGRpcmVjdGl2ZXM6IGRpcmVjdGl2ZXMkMSwKICBpc1Jlc2VydmVkVGFnOiBpc1Jl
c2VydmVkVGFnLAogIGlzVW5hcnlUYWc6IGlzVW5hcnlUYWcsCiAgbXVzdFVzZVByb3A6IG11c3RV
c2VQcm9wLAogIGdldFRhZ05hbWVzcGFjZTogZ2V0VGFnTmFtZXNwYWNlLAogIGlzUHJlVGFnOiBp
c1ByZVRhZwp9OwoKZnVuY3Rpb24gY29tcGlsZSQkMSAoCiAgdGVtcGxhdGUsCiAgb3B0aW9ucwop
IHsKICBvcHRpb25zID0gb3B0aW9ucwogICAgPyBleHRlbmQoZXh0ZW5kKHt9LCBiYXNlT3B0aW9u
cyksIG9wdGlvbnMpCiAgICA6IGJhc2VPcHRpb25zOwogIHJldHVybiBjb21waWxlJDEodGVtcGxh
dGUsIG9wdGlvbnMpCn0KCmZ1bmN0aW9uIGNvbXBpbGVUb0Z1bmN0aW9ucyAoCiAgdGVtcGxhdGUs
CiAgb3B0aW9ucywKICB2bQopIHsKICB2YXIgX3dhcm4gPSAob3B0aW9ucyAmJiBvcHRpb25zLndh
cm4pIHx8IHdhcm47CiAgLy8gZGV0ZWN0IHBvc3NpYmxlIENTUCByZXN0cmljdGlvbgogIC8qIGlz
dGFuYnVsIGlnbm9yZSBpZiAqLwogIHsKICAgIHRyeSB7CiAgICAgIG5ldyBGdW5jdGlvbigncmV0
dXJuIDEnKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgaWYgKGUudG9TdHJpbmcoKS5tYXRjaCgv
dW5zYWZlLWV2YWx8Q1NQLykpIHsKICAgICAgICBfd2FybigKICAgICAgICAgICdJdCBzZWVtcyB5
b3UgYXJlIHVzaW5nIHRoZSBzdGFuZGFsb25lIGJ1aWxkIG9mIFZ1ZS5qcyBpbiBhbiAnICsKICAg
ICAgICAgICdlbnZpcm9ubWVudCB3aXRoIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5IHRoYXQgcHJv
aGliaXRzIHVuc2FmZS1ldmFsLiAnICsKICAgICAgICAgICdUaGUgdGVtcGxhdGUgY29tcGlsZXIg
Y2Fubm90IHdvcmsgaW4gdGhpcyBlbnZpcm9ubWVudC4gQ29uc2lkZXIgJyArCiAgICAgICAgICAn
cmVsYXhpbmcgdGhlIHBvbGljeSB0byBhbGxvdyB1bnNhZmUtZXZhbCBvciBwcmUtY29tcGlsaW5n
IHlvdXIgJyArCiAgICAgICAgICAndGVtcGxhdGVzIGludG8gcmVuZGVyIGZ1bmN0aW9ucy4nCiAg
ICAgICAgKTsKICAgICAgfQogICAgfQogIH0KICB2YXIga2V5ID0gb3B0aW9ucyAmJiBvcHRpb25z
LmRlbGltaXRlcnMKICAgID8gU3RyaW5nKG9wdGlvbnMuZGVsaW1pdGVycykgKyB0ZW1wbGF0ZQog
ICAgOiB0ZW1wbGF0ZTsKICBpZiAoY2FjaGVba2V5XSkgewogICAgcmV0dXJuIGNhY2hlW2tleV0K
ICB9CiAgdmFyIHJlcyA9IHt9OwogIHZhciBjb21waWxlZCA9IGNvbXBpbGUkJDEodGVtcGxhdGUs
IG9wdGlvbnMpOwogIHJlcy5yZW5kZXIgPSBtYWtlRnVuY3Rpb24oY29tcGlsZWQucmVuZGVyKTsK
ICB2YXIgbCA9IGNvbXBpbGVkLnN0YXRpY1JlbmRlckZucy5sZW5ndGg7CiAgcmVzLnN0YXRpY1Jl
bmRlckZucyA9IG5ldyBBcnJheShsKTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGw7IGkrKykgewog
ICAgcmVzLnN0YXRpY1JlbmRlckZuc1tpXSA9IG1ha2VGdW5jdGlvbihjb21waWxlZC5zdGF0aWNS
ZW5kZXJGbnNbaV0pOwogIH0KICB7CiAgICBpZiAocmVzLnJlbmRlciA9PT0gbm9vcCB8fCByZXMu
c3RhdGljUmVuZGVyRm5zLnNvbWUoZnVuY3Rpb24gKGZuKSB7IHJldHVybiBmbiA9PT0gbm9vcDsg
fSkpIHsKICAgICAgX3dhcm4oCiAgICAgICAgImZhaWxlZCB0byBjb21waWxlIHRlbXBsYXRlOlxu
XG4iICsgdGVtcGxhdGUgKyAiXG5cbiIgKwogICAgICAgIGRldGVjdEVycm9ycyhjb21waWxlZC5h
c3QpLmpvaW4oJ1xuJykgKwogICAgICAgICdcblxuJywKICAgICAgICB2bQogICAgICApOwogICAg
fQogIH0KICByZXR1cm4gKGNhY2hlW2tleV0gPSByZXMpCn0KCmZ1bmN0aW9uIG1ha2VGdW5jdGlv
biAoY29kZSkgewogIHRyeSB7CiAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKGNvZGUpCiAgfSBjYXRj
aCAoZSkgewogICAgcmV0dXJuIG5vb3AKICB9Cn0KCi8qICAqLwoKdmFyIGlkVG9UZW1wbGF0ZSA9
IGNhY2hlZChmdW5jdGlvbiAoaWQpIHsKICB2YXIgZWwgPSBxdWVyeShpZCk7CiAgcmV0dXJuIGVs
ICYmIGVsLmlubmVySFRNTAp9KTsKCnZhciBtb3VudCA9IFZ1ZSQzLnByb3RvdHlwZS4kbW91bnQ7
ClZ1ZSQzLnByb3RvdHlwZS4kbW91bnQgPSBmdW5jdGlvbiAoCiAgZWwsCiAgaHlkcmF0aW5nCikg
ewogIGVsID0gZWwgJiYgcXVlcnkoZWwpOwoKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBp
ZiAoZWwgPT09IGRvY3VtZW50LmJvZHkgfHwgZWwgPT09IGRvY3VtZW50LmRvY3VtZW50RWxlbWVu
dCkgewogICAgImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oCiAgICAgICJE
byBub3QgbW91bnQgVnVlIHRvIDxodG1sPiBvciA8Ym9keT4gLSBtb3VudCB0byBub3JtYWwgZWxl
bWVudHMgaW5zdGVhZC4iCiAgICApOwogICAgcmV0dXJuIHRoaXMKICB9CgogIHZhciBvcHRpb25z
ID0gdGhpcy4kb3B0aW9uczsKICAvLyByZXNvbHZlIHRlbXBsYXRlL2VsIGFuZCBjb252ZXJ0IHRv
IHJlbmRlciBmdW5jdGlvbgogIGlmICghb3B0aW9ucy5yZW5kZXIpIHsKICAgIHZhciB0ZW1wbGF0
ZSA9IG9wdGlvbnMudGVtcGxhdGU7CiAgICBpZiAodGVtcGxhdGUpIHsKICAgICAgaWYgKHR5cGVv
ZiB0ZW1wbGF0ZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICBpZiAodGVtcGxhdGUuY2hhckF0KDAp
ID09PSAnIycpIHsKICAgICAgICAgIHRlbXBsYXRlID0gaWRUb1RlbXBsYXRlKHRlbXBsYXRlKTsK
ICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgICAgICAgaWYgKCJkZXZlbG9w
bWVudCIgIT09ICdwcm9kdWN0aW9uJyAmJiAhdGVtcGxhdGUpIHsKICAgICAgICAgICAgd2FybigK
ICAgICAgICAgICAgICAoIlRlbXBsYXRlIGVsZW1lbnQgbm90IGZvdW5kIG9yIGlzIGVtcHR5OiAi
ICsgKG9wdGlvbnMudGVtcGxhdGUpKSwKICAgICAgICAgICAgICB0aGlzCiAgICAgICAgICAgICk7
CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRlbXBsYXRlLm5vZGVUeXBl
KSB7CiAgICAgICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZS5pbm5lckhUTUw7CiAgICAgIH0gZWxzZSB7
CiAgICAgICAgewogICAgICAgICAgd2FybignaW52YWxpZCB0ZW1wbGF0ZSBvcHRpb246JyArIHRl
bXBsYXRlLCB0aGlzKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMKICAgICAgfQogICAg
fSBlbHNlIGlmIChlbCkgewogICAgICB0ZW1wbGF0ZSA9IGdldE91dGVySFRNTChlbCk7CiAgICB9
CiAgICBpZiAodGVtcGxhdGUpIHsKICAgICAgdmFyIHJlZiA9IGNvbXBpbGVUb0Z1bmN0aW9ucyh0
ZW1wbGF0ZSwgewogICAgICAgIHdhcm46IHdhcm4sCiAgICAgICAgc2hvdWxkRGVjb2RlTmV3bGlu
ZXM6IHNob3VsZERlY29kZU5ld2xpbmVzLAogICAgICAgIGRlbGltaXRlcnM6IG9wdGlvbnMuZGVs
aW1pdGVycwogICAgICB9LCB0aGlzKTsKICAgICAgdmFyIHJlbmRlciA9IHJlZi5yZW5kZXI7CiAg
ICAgIHZhciBzdGF0aWNSZW5kZXJGbnMgPSByZWYuc3RhdGljUmVuZGVyRm5zOwogICAgICBvcHRp
b25zLnJlbmRlciA9IHJlbmRlcjsKICAgICAgb3B0aW9ucy5zdGF0aWNSZW5kZXJGbnMgPSBzdGF0
aWNSZW5kZXJGbnM7CiAgICB9CiAgfQogIHJldHVybiBtb3VudC5jYWxsKHRoaXMsIGVsLCBoeWRy
YXRpbmcpCn07CgovKioKICogR2V0IG91dGVySFRNTCBvZiBlbGVtZW50cywgdGFraW5nIGNhcmUK
ICogb2YgU1ZHIGVsZW1lbnRzIGluIElFIGFzIHdlbGwuCiAqLwpmdW5jdGlvbiBnZXRPdXRlckhU
TUwgKGVsKSB7CiAgaWYgKGVsLm91dGVySFRNTCkgewogICAgcmV0dXJuIGVsLm91dGVySFRNTAog
IH0gZWxzZSB7CiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2
Jyk7CiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZWwuY2xvbmVOb2RlKHRydWUpKTsKICAgIHJl
dHVybiBjb250YWluZXIuaW5uZXJIVE1MCiAgfQp9CgpWdWUkMy5jb21waWxlID0gY29tcGlsZVRv
RnVuY3Rpb25zOwoKcmV0dXJuIFZ1ZSQzOwoKfSkpKTsK</Default>
</Parameter>

<Parameter name="Frag916644214336275393184859">
<Default>LyohCiAqIFZ1ZS5qcyB2Mi4xLjYKICogKGMpIDIwMTQtMjAxNiBFdmFuIFlvdQogKiBSZWxlYXNl
ZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuCiAqLwooZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkg
ewogIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5k
ZWZpbmVkJyA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDoKICB0eXBlb2YgZGVmaW5lID09
PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOgogIChnbG9iYWwu
VnVlID0gZmFjdG9yeSgpKTsKfSh0aGlzLCAoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7Cgov
KiAgKi8KCi8qKgogKiBDb252ZXJ0IGEgdmFsdWUgdG8gYSBzdHJpbmcgdGhhdCBpcyBhY3R1YWxs
eSByZW5kZXJlZC4KICovCmZ1bmN0aW9uIF90b1N0cmluZyAodmFsKSB7CiAgcmV0dXJuIHZhbCA9
PSBudWxsCiAgICA/ICcnCiAgICA6IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnCiAgICAgID8gSlNP
Ti5zdHJpbmdpZnkodmFsLCBudWxsLCAyKQogICAgICA6IFN0cmluZyh2YWwpCn0KCi8qKgogKiBD
b252ZXJ0IGEgaW5wdXQgdmFsdWUgdG8gYSBudW1iZXIgZm9yIHBlcnNpc3RlbmNlLgogKiBJZiB0
aGUgY29udmVyc2lvbiBmYWlscywgcmV0dXJuIG9yaWdpbmFsIHN0cmluZy4KICovCmZ1bmN0aW9u
IHRvTnVtYmVyICh2YWwpIHsKICB2YXIgbiA9IHBhcnNlRmxvYXQodmFsLCAxMCk7CiAgcmV0dXJu
IChuIHx8IG4gPT09IDApID8gbiA6IHZhbAp9CgovKioKICogTWFrZSBhIG1hcCBhbmQgcmV0dXJu
IGEgZnVuY3Rpb24gZm9yIGNoZWNraW5nIGlmIGEga2V5CiAqIGlzIGluIHRoYXQgbWFwLgogKi8K
ZnVuY3Rpb24gbWFrZU1hcCAoCiAgc3RyLAogIGV4cGVjdHNMb3dlckNhc2UKKSB7CiAgdmFyIG1h
cCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgdmFyIGxpc3QgPSBzdHIuc3BsaXQoJywnKTsKICBm
b3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsKICAgIG1hcFtsaXN0W2ldXSA9
IHRydWU7CiAgfQogIHJldHVybiBleHBlY3RzTG93ZXJDYXNlCiAgICA/IGZ1bmN0aW9uICh2YWwp
IHsgcmV0dXJuIG1hcFt2YWwudG9Mb3dlckNhc2UoKV07IH0KICAgIDogZnVuY3Rpb24gKHZhbCkg
eyByZXR1cm4gbWFwW3ZhbF07IH0KfQoKLyoqCiAqIENoZWNrIGlmIGEgdGFnIGlzIGEgYnVpbHQt
aW4gdGFnLgogKi8KdmFyIGlzQnVpbHRJblRhZyA9IG1ha2VNYXAoJ3Nsb3QsY29tcG9uZW50Jywg
dHJ1ZSk7CgovKioKICogUmVtb3ZlIGFuIGl0ZW0gZnJvbSBhbiBhcnJheQogKi8KZnVuY3Rpb24g
cmVtb3ZlJDEgKGFyciwgaXRlbSkgewogIGlmIChhcnIubGVuZ3RoKSB7CiAgICB2YXIgaW5kZXgg
PSBhcnIuaW5kZXhPZihpdGVtKTsKICAgIGlmIChpbmRleCA+IC0xKSB7CiAgICAgIHJldHVybiBh
cnIuc3BsaWNlKGluZGV4LCAxKQogICAgfQogIH0KfQoKLyoqCiAqIENoZWNrIHdoZXRoZXIgdGhl
IG9iamVjdCBoYXMgdGhlIHByb3BlcnR5LgogKi8KdmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0
LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKZnVuY3Rpb24gaGFzT3duIChvYmosIGtleSkgewog
IHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KQp9CgovKioKICogQ2hlY2sgaWYg
dmFsdWUgaXMgcHJpbWl0aXZlCiAqLwpmdW5jdGlvbiBpc1ByaW1pdGl2ZSAodmFsdWUpIHsKICBy
ZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsdWUgPT09ICdudW1i
ZXInCn0KCi8qKgogKiBDcmVhdGUgYSBjYWNoZWQgdmVyc2lvbiBvZiBhIHB1cmUgZnVuY3Rpb24u
CiAqLwpmdW5jdGlvbiBjYWNoZWQgKGZuKSB7CiAgdmFyIGNhY2hlID0gT2JqZWN0LmNyZWF0ZShu
dWxsKTsKICByZXR1cm4gZnVuY3Rpb24gY2FjaGVkRm4gKHN0cikgewogICAgdmFyIGhpdCA9IGNh
Y2hlW3N0cl07CiAgICByZXR1cm4gaGl0IHx8IChjYWNoZVtzdHJdID0gZm4oc3RyKSkKICB9Cn0K
Ci8qKgogKiBDYW1lbGl6ZSBhIGh5cGhlbi1kZWxtaXRlZCBzdHJpbmcuCiAqLwp2YXIgY2FtZWxp
emVSRSA9IC8tKFx3KS9nOwp2YXIgY2FtZWxpemUgPSBjYWNoZWQoZnVuY3Rpb24gKHN0cikgewog
IHJldHVybiBzdHIucmVwbGFjZShjYW1lbGl6ZVJFLCBmdW5jdGlvbiAoXywgYykgeyByZXR1cm4g
YyA/IGMudG9VcHBlckNhc2UoKSA6ICcnOyB9KQp9KTsKCi8qKgogKiBDYXBpdGFsaXplIGEgc3Ry
aW5nLgogKi8KdmFyIGNhcGl0YWxpemUgPSBjYWNoZWQoZnVuY3Rpb24gKHN0cikgewogIHJldHVy
biBzdHIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoMSkKfSk7CgovKioKICog
SHlwaGVuYXRlIGEgY2FtZWxDYXNlIHN0cmluZy4KICovCnZhciBoeXBoZW5hdGVSRSA9IC8oW14t
XSkoW0EtWl0pL2c7CnZhciBoeXBoZW5hdGUgPSBjYWNoZWQoZnVuY3Rpb24gKHN0cikgewogIHJl
dHVybiBzdHIKICAgIC5yZXBsYWNlKGh5cGhlbmF0ZVJFLCAnJDEtJDInKQogICAgLnJlcGxhY2Uo
aHlwaGVuYXRlUkUsICckMS0kMicpCiAgICAudG9Mb3dlckNhc2UoKQp9KTsKCi8qKgogKiBTaW1w
bGUgYmluZCwgZmFzdGVyIHRoYW4gbmF0aXZlCiAqLwpmdW5jdGlvbiBiaW5kJDEgKGZuLCBjdHgp
IHsKICBmdW5jdGlvbiBib3VuZEZuIChhKSB7CiAgICB2YXIgbCA9IGFyZ3VtZW50cy5sZW5ndGg7
CiAgICByZXR1cm4gbAogICAgICA/IGwgPiAxCiAgICAgICAgPyBmbi5hcHBseShjdHgsIGFyZ3Vt
ZW50cykKICAgICAgICA6IGZuLmNhbGwoY3R4LCBhKQogICAgICA6IGZuLmNhbGwoY3R4KQogIH0K
ICAvLyByZWNvcmQgb3JpZ2luYWwgZm4gbGVuZ3RoCiAgYm91bmRGbi5fbGVuZ3RoID0gZm4ubGVu
Z3RoOwogIHJldHVybiBib3VuZEZuCn0KCi8qKgogKiBDb252ZXJ0IGFuIEFycmF5LWxpa2Ugb2Jq
ZWN0IHRvIGEgcmVhbCBBcnJheS4KICovCmZ1bmN0aW9uIHRvQXJyYXkgKGxpc3QsIHN0YXJ0KSB7
CiAgc3RhcnQgPSBzdGFydCB8fCAwOwogIHZhciBpID0gbGlzdC5sZW5ndGggLSBzdGFydDsKICB2
YXIgcmV0ID0gbmV3IEFycmF5KGkpOwogIHdoaWxlIChpLS0pIHsKICAgIHJldFtpXSA9IGxpc3Rb
aSArIHN0YXJ0XTsKICB9CiAgcmV0dXJuIHJldAp9CgovKioKICogTWl4IHByb3BlcnRpZXMgaW50
byB0YXJnZXQgb2JqZWN0LgogKi8KZnVuY3Rpb24gZXh0ZW5kICh0bywgX2Zyb20pIHsKICBmb3Ig
KHZhciBrZXkgaW4gX2Zyb20pIHsKICAgIHRvW2tleV0gPSBfZnJvbVtrZXldOwogIH0KICByZXR1
cm4gdG8KfQoKLyoqCiAqIFF1aWNrIG9iamVjdCBjaGVjayAtIHRoaXMgaXMgcHJpbWFyaWx5IHVz
ZWQgdG8gdGVsbAogKiBPYmplY3RzIGZyb20gcHJpbWl0aXZlIHZhbHVlcyB3aGVuIHdlIGtub3cg
dGhlIHZhbHVlCiAqIGlzIGEgSlNPTi1jb21wbGlhbnQgdHlwZS4KICovCmZ1bmN0aW9uIGlzT2Jq
ZWN0IChvYmopIHsKICByZXR1cm4gb2JqICE9PSBudWxsICYmIHR5cGVvZiBvYmogPT09ICdvYmpl
Y3QnCn0KCi8qKgogKiBTdHJpY3Qgb2JqZWN0IHR5cGUgY2hlY2suIE9ubHkgcmV0dXJucyB0cnVl
CiAqIGZvciBwbGFpbiBKYXZhU2NyaXB0IG9iamVjdHMuCiAqLwp2YXIgdG9TdHJpbmcgPSBPYmpl
Y3QucHJvdG90eXBlLnRvU3RyaW5nOwp2YXIgT0JKRUNUX1NUUklORyA9ICdbb2JqZWN0IE9iamVj
dF0nOwpmdW5jdGlvbiBpc1BsYWluT2JqZWN0IChvYmopIHsKICByZXR1cm4gdG9TdHJpbmcuY2Fs
bChvYmopID09PSBPQkpFQ1RfU1RSSU5HCn0KCi8qKgogKiBNZXJnZSBhbiBBcnJheSBvZiBPYmpl
Y3RzIGludG8gYSBzaW5nbGUgT2JqZWN0LgogKi8KZnVuY3Rpb24gdG9PYmplY3QgKGFycikgewog
IHZhciByZXMgPSB7fTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewog
ICAgaWYgKGFycltpXSkgewogICAgICBleHRlbmQocmVzLCBhcnJbaV0pOwogICAgfQogIH0KICBy
ZXR1cm4gcmVzCn0KCi8qKgogKiBQZXJmb3JtIG5vIG9wZXJhdGlvbi4KICovCmZ1bmN0aW9uIG5v
b3AgKCkge30KCi8qKgogKiBBbHdheXMgcmV0dXJuIGZhbHNlLgogKi8KdmFyIG5vID0gZnVuY3Rp
b24gKCkgeyByZXR1cm4gZmFsc2U7IH07CgovKioKICogUmV0dXJuIHNhbWUgdmFsdWUKICovCnZh
ciBpZGVudGl0eSA9IGZ1bmN0aW9uIChfKSB7IHJldHVybiBfOyB9OwoKLyoqCiAqIEdlbmVyYXRl
IGEgc3RhdGljIGtleXMgc3RyaW5nIGZyb20gY29tcGlsZXIgbW9kdWxlcy4KICovCmZ1bmN0aW9u
IGdlblN0YXRpY0tleXMgKG1vZHVsZXMpIHsKICByZXR1cm4gbW9kdWxlcy5yZWR1Y2UoZnVuY3Rp
b24gKGtleXMsIG0pIHsKICAgIHJldHVybiBrZXlzLmNvbmNhdChtLnN0YXRpY0tleXMgfHwgW10p
CiAgfSwgW10pLmpvaW4oJywnKQp9CgovKioKICogQ2hlY2sgaWYgdHdvIHZhbHVlcyBhcmUgbG9v
c2VseSBlcXVhbCAtIHRoYXQgaXMsCiAqIGlmIHRoZXkgYXJlIHBsYWluIG9iamVjdHMsIGRvIHRo
ZXkgaGF2ZSB0aGUgc2FtZSBzaGFwZT8KICovCmZ1bmN0aW9uIGxvb3NlRXF1YWwgKGEsIGIpIHsK
ICAvKiBlc2xpbnQtZGlzYWJsZSBlcWVxZXEgKi8KICByZXR1cm4gYSA9PSBiIHx8ICgKICAgIGlz
T2JqZWN0KGEpICYmIGlzT2JqZWN0KGIpCiAgICAgID8gSlNPTi5zdHJpbmdpZnkoYSkgPT09IEpT
T04uc3RyaW5naWZ5KGIpCiAgICAgIDogZmFsc2UKICApCiAgLyogZXNsaW50LWVuYWJsZSBlcWVx
ZXEgKi8KfQoKZnVuY3Rpb24gbG9vc2VJbmRleE9mIChhcnIsIHZhbCkgewogIGZvciAodmFyIGkg
PSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAobG9vc2VFcXVhbChhcnJbaV0sIHZh
bCkpIHsgcmV0dXJuIGkgfQogIH0KICByZXR1cm4gLTEKfQoKLyogICovCgp2YXIgY29uZmlnID0g
ewogIC8qKgogICAqIE9wdGlvbiBtZXJnZSBzdHJhdGVnaWVzICh1c2VkIGluIGNvcmUvdXRpbC9v
cHRpb25zKQogICAqLwogIG9wdGlvbk1lcmdlU3RyYXRlZ2llczogT2JqZWN0LmNyZWF0ZShudWxs
KSwKCiAgLyoqCiAgICogV2hldGhlciB0byBzdXBwcmVzcyB3YXJuaW5ncy4KICAgKi8KICBzaWxl
bnQ6IGZhbHNlLAoKICAvKioKICAgKiBXaGV0aGVyIHRvIGVuYWJsZSBkZXZ0b29scwogICAqLwog
IGRldnRvb2xzOiAiZGV2ZWxvcG1lbnQiICE9PSAncHJvZHVjdGlvbicsCgogIC8qKgogICAqIEVy
cm9yIGhhbmRsZXIgZm9yIHdhdGNoZXIgZXJyb3JzCiAgICovCiAgZXJyb3JIYW5kbGVyOiBudWxs
LAoKICAvKioKICAgKiBJZ25vcmUgY2VydGFpbiBjdXN0b20gZWxlbWVudHMKICAgKi8KICBpZ25v
cmVkRWxlbWVudHM6IG51bGwsCgogIC8qKgogICAqIEN1c3RvbSB1c2VyIGtleSBhbGlhc2VzIGZv
ciB2LW9uCiAgICovCiAga2V5Q29kZXM6IE9iamVjdC5jcmVhdGUobnVsbCksCgogIC8qKgogICAq
IENoZWNrIGlmIGEgdGFnIGlzIHJlc2VydmVkIHNvIHRoYXQgaXQgY2Fubm90IGJlIHJlZ2lzdGVy
ZWQgYXMgYQogICAqIGNvbXBvbmVudC4gVGhpcyBpcyBwbGF0Zm9ybS1kZXBlbmRlbnQgYW5kIG1h
eSBiZSBvdmVyd3JpdHRlbi4KICAgKi8KICBpc1Jlc2VydmVkVGFnOiBubywKCiAgLyoqCiAgICog
Q2hlY2sgaWYgYSB0YWcgaXMgYW4gdW5rbm93biBlbGVtZW50LgogICAqIFBsYXRmb3JtLWRlcGVu
ZGVudC4KICAgKi8KICBpc1Vua25vd25FbGVtZW50OiBubywKCiAgLyoqCiAgICogR2V0IHRoZSBu
YW1lc3BhY2Ugb2YgYW4gZWxlbWVudAogICAqLwogIGdldFRhZ05hbWVzcGFjZTogbm9vcCwKCiAg
LyoqCiAgICogUGFyc2UgdGhlIHJlYWwgdGFnIG5hbWUgZm9yIHRoZSBzcGVjaWZpYyBwbGF0Zm9y
bS4KICAgKi8KICBwYXJzZVBsYXRmb3JtVGFnTmFtZTogaWRlbnRpdHksCgogIC8qKgogICAqIENo
ZWNrIGlmIGFuIGF0dHJpYnV0ZSBtdXN0IGJlIGJvdW5kIHVzaW5nIHByb3BlcnR5LCBlLmcuIHZh
bHVlCiAgICogUGxhdGZvcm0tZGVwZW5kZW50LgogICAqLwogIG11c3RVc2VQcm9wOiBubywKCiAg
LyoqCiAgICogTGlzdCBvZiBhc3NldCB0eXBlcyB0aGF0IGEgY29tcG9uZW50IGNhbiBvd24uCiAg
ICovCiAgX2Fzc2V0VHlwZXM6IFsKICAgICdjb21wb25lbnQnLAogICAgJ2RpcmVjdGl2ZScsCiAg
ICAnZmlsdGVyJwogIF0sCgogIC8qKgogICAqIExpc3Qgb2YgbGlmZWN5Y2xlIGhvb2tzLgogICAq
LwogIF9saWZlY3ljbGVIb29rczogWwogICAgJ2JlZm9yZUNyZWF0ZScsCiAgICAnY3JlYXRlZCcs
CiAgICAnYmVmb3JlTW91bnQnLAogICAgJ21vdW50ZWQnLAogICAgJ2JlZm9yZVVwZGF0ZScsCiAg
ICAndXBkYXRlZCcsCiAgICAnYmVmb3JlRGVzdHJveScsCiAgICAnZGVzdHJveWVkJywKICAgICdh
Y3RpdmF0ZWQnLAogICAgJ2RlYWN0aXZhdGVkJwogIF0sCgogIC8qKgogICAqIE1heCBjaXJjdWxh
ciB1cGRhdGVzIGFsbG93ZWQgaW4gYSBzY2hlZHVsZXIgZmx1c2ggY3ljbGUuCiAgICovCiAgX21h
eFVwZGF0ZUNvdW50OiAxMDAKfTsKCi8qICAqLwoKLyoqCiAqIENoZWNrIGlmIGEgc3RyaW5nIHN0
YXJ0cyB3aXRoICQgb3IgXwogKi8KZnVuY3Rpb24gaXNSZXNlcnZlZCAoc3RyKSB7CiAgdmFyIGMg
PSAoc3RyICsgJycpLmNoYXJDb2RlQXQoMCk7CiAgcmV0dXJuIGMgPT09IDB4MjQgfHwgYyA9PT0g
MHg1Rgp9CgovKioKICogRGVmaW5lIGEgcHJvcGVydHkuCiAqLwpmdW5jdGlvbiBkZWYgKG9iaiwg
a2V5LCB2YWwsIGVudW1lcmFibGUpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXks
IHsKICAgIHZhbHVlOiB2YWwsCiAgICBlbnVtZXJhYmxlOiAhIWVudW1lcmFibGUsCiAgICB3cml0
YWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwp9CgovKioKICogUGFyc2Ug
c2ltcGxlIHBhdGguCiAqLwp2YXIgYmFpbFJFID0gL1teXHcuJF0vOwpmdW5jdGlvbiBwYXJzZVBh
dGggKHBhdGgpIHsKICBpZiAoYmFpbFJFLnRlc3QocGF0aCkpIHsKICAgIHJldHVybgogIH0gZWxz
ZSB7CiAgICB2YXIgc2VnbWVudHMgPSBwYXRoLnNwbGl0KCcuJyk7CiAgICByZXR1cm4gZnVuY3Rp
b24gKG9iaikgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlZ21lbnRzLmxlbmd0aDsgaSsr
KSB7CiAgICAgICAgaWYgKCFvYmopIHsgcmV0dXJuIH0KICAgICAgICBvYmogPSBvYmpbc2VnbWVu
dHNbaV1dOwogICAgICB9CiAgICAgIHJldHVybiBvYmoKICAgIH0KICB9Cn0KCi8qICAqLwovKiBn
bG9iYWxzIE11dGF0aW9uT2JzZXJ2ZXIgKi8KCi8vIGNhbiB3ZSB1c2UgX19wcm90b19fPwp2YXIg
aGFzUHJvdG8gPSAnX19wcm90b19fJyBpbiB7fTsKCi8vIEJyb3dzZXIgZW52aXJvbm1lbnQgc25p
ZmZpbmcKdmFyIGluQnJvd3NlciA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnOwp2YXIg
VUEgPSBpbkJyb3dzZXIgJiYgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2Uo
KTsKdmFyIGlzSUUgPSBVQSAmJiAvbXNpZXx0cmlkZW50Ly50ZXN0KFVBKTsKdmFyIGlzSUU5ID0g
VUEgJiYgVUEuaW5kZXhPZignbXNpZSA5LjAnKSA+IDA7CnZhciBpc0VkZ2UgPSBVQSAmJiBVQS5p
bmRleE9mKCdlZGdlLycpID4gMDsKdmFyIGlzQW5kcm9pZCA9IFVBICYmIFVBLmluZGV4T2YoJ2Fu
ZHJvaWQnKSA+IDA7CnZhciBpc0lPUyA9IFVBICYmIC9pcGhvbmV8aXBhZHxpcG9kfGlvcy8udGVz
dChVQSk7CgovLyB0aGlzIG5lZWRzIHRvIGJlIGxhenktZXZhbGVkIGJlY2F1c2UgdnVlIG1heSBi
ZSByZXF1aXJlZCBiZWZvcmUKLy8gdnVlLXNlcnZlci1yZW5kZXJlciBjYW4gc2V0IFZVRV9FTlYK
dmFyIF9pc1NlcnZlcjsKdmFyIGlzU2VydmVyUmVuZGVyaW5nID0gZnVuY3Rpb24gKCkgewogIGlm
IChfaXNTZXJ2ZXIgPT09IHVuZGVmaW5lZCkgewogICAgLyogaXN0YW5idWwgaWdub3JlIGlmICov
CiAgICBpZiAoIWluQnJvd3NlciAmJiB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykgewog
ICAgICAvLyBkZXRlY3QgcHJlc2VuY2Ugb2YgdnVlLXNlcnZlci1yZW5kZXJlciBhbmQgYXZvaWQK
ICAgICAgLy8gV2VicGFjayBzaGltbWluZyB0aGUgcHJvY2VzcwogICAgICBfaXNTZXJ2ZXIgPSBn
bG9iYWxbJ3Byb2Nlc3MnXS5lbnYuVlVFX0VOViA9PT0gJ3NlcnZlcic7CiAgICB9IGVsc2Ugewog
ICAgICBfaXNTZXJ2ZXIgPSBmYWxzZTsKICAgIH0KICB9CiAgcmV0dXJuIF9pc1NlcnZlcgp9OwoK
Ly8gZGV0ZWN0IGRldnRvb2xzCnZhciBkZXZ0b29scyA9IGluQnJvd3NlciAmJiB3aW5kb3cuX19W
VUVfREVWVE9PTFNfR0xPQkFMX0hPT0tfXzsKCi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCmZ1
bmN0aW9uIGlzTmF0aXZlIChDdG9yKSB7CiAgcmV0dXJuIC9uYXRpdmUgY29kZS8udGVzdChDdG9y
LnRvU3RyaW5nKCkpCn0KCi8qKgogKiBEZWZlciBhIHRhc2sgdG8gZXhlY3V0ZSBpdCBhc3luY2hy
b25vdXNseS4KICovCnZhciBuZXh0VGljayA9IChmdW5jdGlvbiAoKSB7CiAgdmFyIGNhbGxiYWNr
cyA9IFtdOwogIHZhciBwZW5kaW5nID0gZmFsc2U7CiAgdmFyIHRpbWVyRnVuYzsKCiAgZnVuY3Rp
b24gbmV4dFRpY2tIYW5kbGVyICgpIHsKICAgIHBlbmRpbmcgPSBmYWxzZTsKICAgIHZhciBjb3Bp
ZXMgPSBjYWxsYmFja3Muc2xpY2UoMCk7CiAgICBjYWxsYmFja3MubGVuZ3RoID0gMDsKICAgIGZv
ciAodmFyIGkgPSAwOyBpIDwgY29waWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvcGllc1tpXSgp
OwogICAgfQogIH0KCiAgLy8gdGhlIG5leHRUaWNrIGJlaGF2aW9yIGxldmVyYWdlcyB0aGUgbWlj
cm90YXNrIHF1ZXVlLCB3aGljaCBjYW4gYmUgYWNjZXNzZWQKICAvLyB2aWEgZWl0aGVyIG5hdGl2
ZSBQcm9taXNlLnRoZW4gb3IgTXV0YXRpb25PYnNlcnZlci4KICAvLyBNdXRhdGlvbk9ic2VydmVy
IGhhcyB3aWRlciBzdXBwb3J0LCBob3dldmVyIGl0IGlzIHNlcmlvdXNseSBidWdnZWQgaW4KICAv
LyBVSVdlYlZpZXcgaW4gaU9TID49IDkuMy4zIHdoZW4gdHJpZ2dlcmVkIGluIHRvdWNoIGV2ZW50
IGhhbmRsZXJzLiBJdAogIC8vIGNvbXBsZXRlbHkgc3RvcHMgd29ya2luZyBhZnRlciB0cmlnZ2Vy
aW5nIGEgZmV3IHRpbWVzLi4uIHNvLCBpZiBuYXRpdmUKICAvLyBQcm9taXNlIGlzIGF2YWlsYWJs
ZSwgd2Ugd2lsbCB1c2UgaXQ6CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKHR5cGVv
ZiBQcm9taXNlICE9PSAndW5kZWZpbmVkJyAmJiBpc05hdGl2ZShQcm9taXNlKSkgewogICAgdmFy
IHAgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgIHZhciBsb2dFcnJvciA9IGZ1bmN0aW9uIChlcnIp
IHsgY29uc29sZS5lcnJvcihlcnIpOyB9OwogICAgdGltZXJGdW5jID0gZnVuY3Rpb24gKCkgewog
ICAgICBwLnRoZW4obmV4dFRpY2tIYW5kbGVyKS5jYXRjaChsb2dFcnJvcik7CiAgICAgIC8vIGlu
IHByb2JsZW1hdGljIFVJV2ViVmlld3MsIFByb21pc2UudGhlbiBkb2Vzbid0IGNvbXBsZXRlbHkg
YnJlYWssIGJ1dAogICAgICAvLyBpdCBjYW4gZ2V0IHN0dWNrIGluIGEgd2VpcmQgc3RhdGUgd2hl
cmUgY2FsbGJhY2tzIGFyZSBwdXNoZWQgaW50byB0aGUKICAgICAgLy8gbWljcm90YXNrIHF1ZXVl
IGJ1dCB0aGUgcXVldWUgaXNuJ3QgYmVpbmcgZmx1c2hlZCwgdW50aWwgdGhlIGJyb3dzZXIKICAg
ICAgLy8gbmVlZHMgdG8gZG8gc29tZSBvdGhlciB3b3JrLCBlLmcuIGhhbmRsZSBhIHRpbWVyLiBU
aGVyZWZvcmUgd2UgY2FuCiAgICAgIC8vICJmb3JjZSIgdGhlIG1pY3JvdGFzayBxdWV1ZSB0byBi
ZSBmbHVzaGVkIGJ5IGFkZGluZyBhbiBlbXB0eSB0aW1lci4KICAgICAgaWYgKGlzSU9TKSB7IHNl
dFRpbWVvdXQobm9vcCk7IH0KICAgIH07CiAgfSBlbHNlIGlmICh0eXBlb2YgTXV0YXRpb25PYnNl
cnZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgKAogICAgaXNOYXRpdmUoTXV0YXRpb25PYnNlcnZlcikg
fHwKICAgIC8vIFBoYW50b21KUyBhbmQgaU9TIDcueAogICAgTXV0YXRpb25PYnNlcnZlci50b1N0
cmluZygpID09PSAnW29iamVjdCBNdXRhdGlvbk9ic2VydmVyQ29uc3RydWN0b3JdJwogICkpIHsK
ICAgIC8vIHVzZSBNdXRhdGlvbk9ic2VydmVyIHdoZXJlIG5hdGl2ZSBQcm9taXNlIGlzIG5vdCBh
dmFpbGFibGUsCiAgICAvLyBlLmcuIFBoYW50b21KUyBJRTExLCBpT1M3LCBBbmRyb2lkIDQuNAog
ICAgdmFyIGNvdW50ZXIgPSAxOwogICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2
ZXIobmV4dFRpY2tIYW5kbGVyKTsKICAgIHZhciB0ZXh0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRl
eHROb2RlKFN0cmluZyhjb3VudGVyKSk7CiAgICBvYnNlcnZlci5vYnNlcnZlKHRleHROb2RlLCB7
CiAgICAgIGNoYXJhY3RlckRhdGE6IHRydWUKICAgIH0pOwogICAgdGltZXJGdW5jID0gZnVuY3Rp
b24gKCkgewogICAgICBjb3VudGVyID0gKGNvdW50ZXIgKyAxKSAlIDI7CiAgICAgIHRleHROb2Rl
LmRhdGEgPSBTdHJpbmcoY291bnRlcik7CiAgICB9OwogIH0gZWxzZSB7CiAgICAvLyBmYWxsYmFj
ayB0byBzZXRUaW1lb3V0CiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgdGltZXJG
dW5jID0gZnVuY3Rpb24gKCkgewogICAgICBzZXRUaW1lb3V0KG5leHRUaWNrSGFuZGxlciwgMCk7
CiAgICB9OwogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIHF1ZXVlTmV4dFRpY2sgKGNiLCBjdHgpIHsK
ICAgIHZhciBfcmVzb2x2ZTsKICAgIGNhbGxiYWNrcy5wdXNoKGZ1bmN0aW9uICgpIHsKICAgICAg
aWYgKGNiKSB7IGNiLmNhbGwoY3R4KTsgfQogICAgICBpZiAoX3Jlc29sdmUpIHsgX3Jlc29sdmUo
Y3R4KTsgfQogICAgfSk7CiAgICBpZiAoIXBlbmRpbmcpIHsKICAgICAgcGVuZGluZyA9IHRydWU7
CiAgICAgIHRpbWVyRnVuYygpOwogICAgfQogICAgaWYgKCFjYiAmJiB0eXBlb2YgUHJvbWlzZSAh
PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNv
bHZlKSB7CiAgICAgICAgX3Jlc29sdmUgPSByZXNvbHZlOwogICAgICB9KQogICAgfQogIH0KfSko
KTsKCnZhciBfU2V0OwovKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KaWYgKHR5cGVvZiBTZXQgIT09
ICd1bmRlZmluZWQnICYmIGlzTmF0aXZlKFNldCkpIHsKICAvLyB1c2UgbmF0aXZlIFNldCB3aGVu
IGF2YWlsYWJsZS4KICBfU2V0ID0gU2V0Owp9IGVsc2UgewogIC8vIGEgbm9uLXN0YW5kYXJkIFNl
dCBwb2x5ZmlsbCB0aGF0IG9ubHkgd29ya3Mgd2l0aCBwcmltaXRpdmUga2V5cy4KICBfU2V0ID0g
KGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFNldCAoKSB7CiAgICAgIHRoaXMuc2V0ID0gT2Jq
ZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KICAgIFNldC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24g
aGFzIChrZXkpIHsKICAgICAgcmV0dXJuIHRoaXMuc2V0W2tleV0gPT09IHRydWUKICAgIH07CiAg
ICBTZXQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIGFkZCAoa2V5KSB7CiAgICAgIHRoaXMuc2V0
W2tleV0gPSB0cnVlOwogICAgfTsKICAgIFNldC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiBj
bGVhciAoKSB7CiAgICAgIHRoaXMuc2V0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH07Cgog
ICAgcmV0dXJuIFNldDsKICB9KCkpOwp9Cgp2YXIgd2FybiA9IG5vb3A7CnZhciBmb3JtYXRDb21w
b25lbnROYW1lOwoKewogIHZhciBoYXNDb25zb2xlID0gdHlwZW9mIGNvbnNvbGUgIT09ICd1bmRl
ZmluZWQnOwoKICB3YXJuID0gZnVuY3Rpb24gKG1zZywgdm0pIHsKICAgIGlmIChoYXNDb25zb2xl
ICYmICghY29uZmlnLnNpbGVudCkpIHsKICAgICAgY29uc29sZS5lcnJvcigiW1Z1ZSB3YXJuXTog
IiArIG1zZyArICIgIiArICgKICAgICAgICB2bSA/IGZvcm1hdExvY2F0aW9uKGZvcm1hdENvbXBv
bmVudE5hbWUodm0pKSA6ICcnCiAgICAgICkpOwogICAgfQogIH07CgogIGZvcm1hdENvbXBvbmVu
dE5hbWUgPSBmdW5jdGlvbiAodm0pIHsKICAgIGlmICh2bS4kcm9vdCA9PT0gdm0pIHsKICAgICAg
cmV0dXJuICdyb290IGluc3RhbmNlJwogICAgfQogICAgdmFyIG5hbWUgPSB2bS5faXNWdWUKICAg
ICAgPyB2bS4kb3B0aW9ucy5uYW1lIHx8IHZtLiRvcHRpb25zLl9jb21wb25lbnRUYWcKICAgICAg
OiB2bS5uYW1lOwogICAgcmV0dXJuICgKICAgICAgKG5hbWUgPyAoImNvbXBvbmVudCA8IiArIG5h
bWUgKyAiPiIpIDogImFub255bW91cyBjb21wb25lbnQiKSArCiAgICAgICh2bS5faXNWdWUgJiYg
dm0uJG9wdGlvbnMuX19maWxlID8gKCIgYXQgIiArICh2bS4kb3B0aW9ucy5fX2ZpbGUpKSA6ICcn
KQogICAgKQogIH07CgogIHZhciBmb3JtYXRMb2NhdGlvbiA9IGZ1bmN0aW9uIChzdHIpIHsKICAg
IGlmIChzdHIgPT09ICdhbm9ueW1vdXMgY29tcG9uZW50JykgewogICAgICBzdHIgKz0gIiAtIHVz
ZSB0aGUgXCJuYW1lXCIgb3B0aW9uIGZvciBiZXR0ZXIgZGVidWdnaW5nIG1lc3NhZ2VzLiI7CiAg
ICB9CiAgICByZXR1cm4gKCJcbihmb3VuZCBpbiAiICsgc3RyICsgIikiKQogIH07Cn0KCi8qICAq
LwoKCnZhciB1aWQkMSA9IDA7CgovKioKICogQSBkZXAgaXMgYW4gb2JzZXJ2YWJsZSB0aGF0IGNh
biBoYXZlIG11bHRpcGxlCiAqIGRpcmVjdGl2ZXMgc3Vic2NyaWJpbmcgdG8gaXQuCiAqLwp2YXIg
RGVwID0gZnVuY3Rpb24gRGVwICgpIHsKICB0aGlzLmlkID0gdWlkJDErKzsKICB0aGlzLnN1YnMg
PSBbXTsKfTsKCkRlcC5wcm90b3R5cGUuYWRkU3ViID0gZnVuY3Rpb24gYWRkU3ViIChzdWIpIHsK
ICB0aGlzLnN1YnMucHVzaChzdWIpOwp9OwoKRGVwLnByb3RvdHlwZS5yZW1vdmVTdWIgPSBmdW5j
dGlvbiByZW1vdmVTdWIgKHN1YikgewogIHJlbW92ZSQxKHRoaXMuc3Vicywgc3ViKTsKfTsKCkRl
cC5wcm90b3R5cGUuZGVwZW5kID0gZnVuY3Rpb24gZGVwZW5kICgpIHsKICBpZiAoRGVwLnRhcmdl
dCkgewogICAgRGVwLnRhcmdldC5hZGREZXAodGhpcyk7CiAgfQp9OwoKRGVwLnByb3RvdHlwZS5u
b3RpZnkgPSBmdW5jdGlvbiBub3RpZnkgKCkgewogIC8vIHN0YWJsaXplIHRoZSBzdWJzY3JpYmVy
IGxpc3QgZmlyc3QKICB2YXIgc3VicyA9IHRoaXMuc3Vicy5zbGljZSgpOwogIGZvciAodmFyIGkg
PSAwLCBsID0gc3Vicy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIHN1YnNbaV0udXBkYXRlKCk7
CiAgfQp9OwoKLy8gdGhlIGN1cnJlbnQgdGFyZ2V0IHdhdGNoZXIgYmVpbmcgZXZhbHVhdGVkLgov
LyB0aGlzIGlzIGdsb2JhbGx5IHVuaXF1ZSBiZWNhdXNlIHRoZXJlIGNvdWxkIGJlIG9ubHkgb25l
Ci8vIHdhdGNoZXIgYmVpbmcgZXZhbHVhdGVkIGF0IGFueSB0aW1lLgpEZXAudGFyZ2V0ID0gbnVs
bDsKdmFyIHRhcmdldFN0YWNrID0gW107CgpmdW5jdGlvbiBwdXNoVGFyZ2V0IChfdGFyZ2V0KSB7
CiAgaWYgKERlcC50YXJnZXQpIHsgdGFyZ2V0U3RhY2sucHVzaChEZXAudGFyZ2V0KTsgfQogIERl
cC50YXJnZXQgPSBfdGFyZ2V0Owp9CgpmdW5jdGlvbiBwb3BUYXJnZXQgKCkgewogIERlcC50YXJn
ZXQgPSB0YXJnZXRTdGFjay5wb3AoKTsKfQoKLyoKICogbm90IHR5cGUgY2hlY2tpbmcgdGhpcyBm
aWxlIGJlY2F1c2UgZmxvdyBkb2Vzbid0IHBsYXkgd2VsbCB3aXRoCiAqIGR5bmFtaWNhbGx5IGFj
Y2Vzc2luZyBtZXRob2RzIG9uIEFycmF5IHByb3RvdHlwZQogKi8KCnZhciBhcnJheVByb3RvID0g
QXJyYXkucHJvdG90eXBlOwp2YXIgYXJyYXlNZXRob2RzID0gT2JqZWN0LmNyZWF0ZShhcnJheVBy
b3RvKTtbCiAgJ3B1c2gnLAogICdwb3AnLAogICdzaGlmdCcsCiAgJ3Vuc2hpZnQnLAogICdzcGxp
Y2UnLAogICdzb3J0JywKICAncmV2ZXJzZScKXQouZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7
CiAgLy8gY2FjaGUgb3JpZ2luYWwgbWV0aG9kCiAgdmFyIG9yaWdpbmFsID0gYXJyYXlQcm90b1tt
ZXRob2RdOwogIGRlZihhcnJheU1ldGhvZHMsIG1ldGhvZCwgZnVuY3Rpb24gbXV0YXRvciAoKSB7
CiAgICB2YXIgYXJndW1lbnRzJDEgPSBhcmd1bWVudHM7CgogICAgLy8gYXZvaWQgbGVha2luZyBh
cmd1bWVudHM6CiAgICAvLyBodHRwOi8vanNwZXJmLmNvbS9jbG9zdXJlLXdpdGgtYXJndW1lbnRz
CiAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGg7CiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShp
KTsKICAgIHdoaWxlIChpLS0pIHsKICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50cyQxW2ldOwogICAg
fQogICAgdmFyIHJlc3VsdCA9IG9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3MpOwogICAgdmFyIG9i
ID0gdGhpcy5fX29iX187CiAgICB2YXIgaW5zZXJ0ZWQ7CiAgICBzd2l0Y2ggKG1ldGhvZCkgewog
ICAgICBjYXNlICdwdXNoJzoKICAgICAgICBpbnNlcnRlZCA9IGFyZ3M7CiAgICAgICAgYnJlYWsK
ICAgICAgY2FzZSAndW5zaGlmdCc6CiAgICAgICAgaW5zZXJ0ZWQgPSBhcmdzOwogICAgICAgIGJy
ZWFrCiAgICAgIGNhc2UgJ3NwbGljZSc6CiAgICAgICAgaW5zZXJ0ZWQgPSBhcmdzLnNsaWNlKDIp
OwogICAgICAgIGJyZWFrCiAgICB9CiAgICBpZiAoaW5zZXJ0ZWQpIHsgb2Iub2JzZXJ2ZUFycmF5
KGluc2VydGVkKTsgfQogICAgLy8gbm90aWZ5IGNoYW5nZQogICAgb2IuZGVwLm5vdGlmeSgpOwog
ICAgcmV0dXJuIHJlc3VsdAogIH0pOwp9KTsKCi8qICAqLwoKdmFyIGFycmF5S2V5cyA9IE9iamVj
dC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGFycmF5TWV0aG9kcyk7CgovKioKICogQnkgZGVmYXVsdCwg
d2hlbiBhIHJlYWN0aXZlIHByb3BlcnR5IGlzIHNldCwgdGhlIG5ldyB2YWx1ZSBpcwogKiBhbHNv
IGNvbnZlcnRlZCB0byBiZWNvbWUgcmVhY3RpdmUuIEhvd2V2ZXIgd2hlbiBwYXNzaW5nIGRvd24g
cHJvcHMsCiAqIHdlIGRvbid0IHdhbnQgdG8gZm9yY2UgY29udmVyc2lvbiBiZWNhdXNlIHRoZSB2
YWx1ZSBtYXkgYmUgYSBuZXN0ZWQgdmFsdWUKICogdW5kZXIgYSBmcm96ZW4gZGF0YSBzdHJ1Y3R1
cmUuIENvbnZlcnRpbmcgaXQgd291bGQgZGVmZWF0IHRoZSBvcHRpbWl6YXRpb24uCiAqLwp2YXIg
b2JzZXJ2ZXJTdGF0ZSA9IHsKICBzaG91bGRDb252ZXJ0OiB0cnVlLAogIGlzU2V0dGluZ1Byb3Bz
OiBmYWxzZQp9OwoKLyoqCiAqIE9ic2VydmVyIGNsYXNzIHRoYXQgYXJlIGF0dGFjaGVkIHRvIGVh
Y2ggb2JzZXJ2ZWQKICogb2JqZWN0LiBPbmNlIGF0dGFjaGVkLCB0aGUgb2JzZXJ2ZXIgY29udmVy
dHMgdGFyZ2V0CiAqIG9iamVjdCdzIHByb3BlcnR5IGtleXMgaW50byBnZXR0ZXIvc2V0dGVycyB0
aGF0CiAqIGNvbGxlY3QgZGVwZW5kZW5jaWVzIGFuZCBkaXNwYXRjaGVzIHVwZGF0ZXMuCiAqLwp2
YXIgT2JzZXJ2ZXIgPSBmdW5jdGlvbiBPYnNlcnZlciAodmFsdWUpIHsKICB0aGlzLnZhbHVlID0g
dmFsdWU7CiAgdGhpcy5kZXAgPSBuZXcgRGVwKCk7CiAgdGhpcy52bUNvdW50ID0gMDsKICBkZWYo
dmFsdWUsICdfX29iX18nLCB0aGlzKTsKICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAg
IHZhciBhdWdtZW50ID0gaGFzUHJvdG8KICAgICAgPyBwcm90b0F1Z21lbnQKICAgICAgOiBjb3B5
QXVnbWVudDsKICAgIGF1Z21lbnQodmFsdWUsIGFycmF5TWV0aG9kcywgYXJyYXlLZXlzKTsKICAg
IHRoaXMub2JzZXJ2ZUFycmF5KHZhbHVlKTsKICB9IGVsc2UgewogICAgdGhpcy53YWxrKHZhbHVl
KTsKICB9Cn07CgovKioKICogV2FsayB0aHJvdWdoIGVhY2ggcHJvcGVydHkgYW5kIGNvbnZlcnQg
dGhlbSBpbnRvCiAqIGdldHRlci9zZXR0ZXJzLiBUaGlzIG1ldGhvZCBzaG91bGQgb25seSBiZSBj
YWxsZWQgd2hlbgogKiB2YWx1ZSB0eXBlIGlzIE9iamVjdC4KICovCk9ic2VydmVyLnByb3RvdHlw
ZS53YWxrID0gZnVuY3Rpb24gd2FsayAob2JqKSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhv
YmopOwogIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgZGVmaW5l
UmVhY3RpdmUkJDEob2JqLCBrZXlzW2ldLCBvYmpba2V5c1tpXV0pOwogIH0KfTsKCi8qKgogKiBP
YnNlcnZlIGEgbGlzdCBvZiBBcnJheSBpdGVtcy4KICovCk9ic2VydmVyLnByb3RvdHlwZS5vYnNl
cnZlQXJyYXkgPSBmdW5jdGlvbiBvYnNlcnZlQXJyYXkgKGl0ZW1zKSB7CiAgZm9yICh2YXIgaSA9
IDAsIGwgPSBpdGVtcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIG9ic2VydmUoaXRlbXNbaV0p
OwogIH0KfTsKCi8vIGhlbHBlcnMKCi8qKgogKiBBdWdtZW50IGFuIHRhcmdldCBPYmplY3Qgb3Ig
QXJyYXkgYnkgaW50ZXJjZXB0aW5nCiAqIHRoZSBwcm90b3R5cGUgY2hhaW4gdXNpbmcgX19wcm90
b19fCiAqLwpmdW5jdGlvbiBwcm90b0F1Z21lbnQgKHRhcmdldCwgc3JjKSB7CiAgLyogZXNsaW50
LWRpc2FibGUgbm8tcHJvdG8gKi8KICB0YXJnZXQuX19wcm90b19fID0gc3JjOwogIC8qIGVzbGlu
dC1lbmFibGUgbm8tcHJvdG8gKi8KfQoKLyoqCiAqIEF1Z21lbnQgYW4gdGFyZ2V0IE9iamVjdCBv
ciBBcnJheSBieSBkZWZpbmluZwogKiBoaWRkZW4gcHJvcGVydGllcy4KICovCi8qIGlzdGFuYnVs
IGlnbm9yZSBuZXh0ICovCmZ1bmN0aW9uIGNvcHlBdWdtZW50ICh0YXJnZXQsIHNyYywga2V5cykg
ewogIGZvciAodmFyIGkgPSAwLCBsID0ga2V5cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIHZh
ciBrZXkgPSBrZXlzW2ldOwogICAgZGVmKHRhcmdldCwga2V5LCBzcmNba2V5XSk7CiAgfQp9Cgov
KioKICogQXR0ZW1wdCB0byBjcmVhdGUgYW4gb2JzZXJ2ZXIgaW5zdGFuY2UgZm9yIGEgdmFsdWUs
CiAqIHJldHVybnMgdGhlIG5ldyBvYnNlcnZlciBpZiBzdWNjZXNzZnVsbHkgb2JzZXJ2ZWQsCiAq
IG9yIHRoZSBleGlzdGluZyBvYnNlcnZlciBpZiB0aGUgdmFsdWUgYWxyZWFkeSBoYXMgb25lLgog
Ki8KZnVuY3Rpb24gb2JzZXJ2ZSAodmFsdWUpIHsKICBpZiAoIWlzT2JqZWN0KHZhbHVlKSkgewog
ICAgcmV0dXJuCiAgfQogIHZhciBvYjsKICBpZiAoaGFzT3duKHZhbHVlLCAnX19vYl9fJykgJiYg
dmFsdWUuX19vYl9fIGluc3RhbmNlb2YgT2JzZXJ2ZXIpIHsKICAgIG9iID0gdmFsdWUuX19vYl9f
OwogIH0gZWxzZSBpZiAoCiAgICBvYnNlcnZlclN0YXRlLnNob3VsZENvbnZlcnQgJiYKICAgICFp
c1NlcnZlclJlbmRlcmluZygpICYmCiAgICAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgaXNQbGFp
bk9iamVjdCh2YWx1ZSkpICYmCiAgICBPYmplY3QuaXNFeHRlbnNpYmxlKHZhbHVlKSAmJgogICAg
IXZhbHVlLl9pc1Z1ZQogICkgewogICAgb2IgPSBuZXcgT2JzZXJ2ZXIodmFsdWUpOwogIH0KICBy
ZXR1cm4gb2IKfQoKLyoqCiAqIERlZmluZSBhIHJlYWN0aXZlIHByb3BlcnR5IG9uIGFuIE9iamVj
dC4KICovCmZ1bmN0aW9uIGRlZmluZVJlYWN0aXZlJCQxICgKICBvYmosCiAga2V5LAogIHZhbCwK
ICBjdXN0b21TZXR0ZXIKKSB7CiAgdmFyIGRlcCA9IG5ldyBEZXAoKTsKCiAgdmFyIHByb3BlcnR5
ID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSk7CiAgaWYgKHByb3Bl
cnR5ICYmIHByb3BlcnR5LmNvbmZpZ3VyYWJsZSA9PT0gZmFsc2UpIHsKICAgIHJldHVybgogIH0K
CiAgLy8gY2F0ZXIgZm9yIHByZS1kZWZpbmVkIGdldHRlci9zZXR0ZXJzCiAgdmFyIGdldHRlciA9
IHByb3BlcnR5ICYmIHByb3BlcnR5LmdldDsKICB2YXIgc2V0dGVyID0gcHJvcGVydHkgJiYgcHJv
cGVydHkuc2V0OwoKICB2YXIgY2hpbGRPYiA9IG9ic2VydmUodmFsKTsKICBPYmplY3QuZGVmaW5l
UHJvcGVydHkob2JqLCBrZXksIHsKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBjb25maWd1cmFi
bGU6IHRydWUsCiAgICBnZXQ6IGZ1bmN0aW9uIHJlYWN0aXZlR2V0dGVyICgpIHsKICAgICAgdmFy
IHZhbHVlID0gZ2V0dGVyID8gZ2V0dGVyLmNhbGwob2JqKSA6IHZhbDsKICAgICAgaWYgKERlcC50
YXJnZXQpIHsKICAgICAgICBkZXAuZGVwZW5kKCk7CiAgICAgICAgaWYgKGNoaWxkT2IpIHsKICAg
ICAgICAgIGNoaWxkT2IuZGVwLmRlcGVuZCgpOwogICAgICAgIH0KICAgICAgICBpZiAoQXJyYXku
aXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICAgIGRlcGVuZEFycmF5KHZhbHVlKTsKICAgICAgICB9
CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlCiAgICB9LAogICAgc2V0OiBmdW5jdGlvbiByZWFj
dGl2ZVNldHRlciAobmV3VmFsKSB7CiAgICAgIHZhciB2YWx1ZSA9IGdldHRlciA/IGdldHRlci5j
YWxsKG9iaikgOiB2YWw7CiAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLXNlbGYtY29tcGFyZSAq
LwogICAgICBpZiAobmV3VmFsID09PSB2YWx1ZSB8fCAobmV3VmFsICE9PSBuZXdWYWwgJiYgdmFs
dWUgIT09IHZhbHVlKSkgewogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIC8qIGVzbGludC1l
bmFibGUgbm8tc2VsZi1jb21wYXJlICovCiAgICAgIGlmICgiZGV2ZWxvcG1lbnQiICE9PSAncHJv
ZHVjdGlvbicgJiYgY3VzdG9tU2V0dGVyKSB7CiAgICAgICAgY3VzdG9tU2V0dGVyKCk7CiAgICAg
IH0KICAgICAgaWYgKHNldHRlcikgewogICAgICAgIHNldHRlci5jYWxsKG9iaiwgbmV3VmFsKTsK
ICAgICAgfSBlbHNlIHsKICAgICAgICB2YWwgPSBuZXdWYWw7CiAgICAgIH0KICAgICAgY2hpbGRP
YiA9IG9ic2VydmUobmV3VmFsKTsKICAgICAgZGVwLm5vdGlmeSgpOwogICAgfQogIH0pOwp9Cgov
KioKICogU2V0IGEgcHJvcGVydHkgb24gYW4gb2JqZWN0LiBBZGRzIHRoZSBuZXcgcHJvcGVydHkg
YW5kCiAqIHRyaWdnZXJzIGNoYW5nZSBub3RpZmljYXRpb24gaWYgdGhlIHByb3BlcnR5IGRvZXNu
J3QKICogYWxyZWFkeSBleGlzdC4KICovCmZ1bmN0aW9uIHNldCQxIChvYmosIGtleSwgdmFsKSB7
CiAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkgewogICAgb2JqLmxlbmd0aCA9IE1hdGgubWF4KG9i
ai5sZW5ndGgsIGtleSk7CiAgICBvYmouc3BsaWNlKGtleSwgMSwgdmFsKTsKICAgIHJldHVybiB2
YWwKICB9CiAgaWYgKGhhc093bihvYmosIGtleSkpIHsKICAgIG9ialtrZXldID0gdmFsOwogICAg
cmV0dXJuCiAgfQogIHZhciBvYiA9IG9iai5fX29iX187CiAgaWYgKG9iai5faXNWdWUgfHwgKG9i
ICYmIG9iLnZtQ291bnQpKSB7CiAgICAiZGV2ZWxvcG1lbnQiICE9PSAncHJvZHVjdGlvbicgJiYg
d2FybigKICAgICAgJ0F2b2lkIGFkZGluZyByZWFjdGl2ZSBwcm9wZXJ0aWVzIHRvIGEgVnVlIGlu
c3RhbmNlIG9yIGl0cyByb290ICRkYXRhICcgKwogICAgICAnYXQgcnVudGltZSAtIGRlY2xhcmUg
aXQgdXBmcm9udCBpbiB0aGUgZGF0YSBvcHRpb24uJwogICAgKTsKICAgIHJldHVybgogIH0KICBp
ZiAoIW9iKSB7CiAgICBvYmpba2V5XSA9IHZhbDsKICAgIHJldHVybgogIH0KICBkZWZpbmVSZWFj
dGl2ZSQkMShvYi52YWx1ZSwga2V5LCB2YWwpOwogIG9iLmRlcC5ub3RpZnkoKTsKICByZXR1cm4g
dmFsCn0KCi8qKgogKiBEZWxldGUgYSBwcm9wZXJ0eSBhbmQgdHJpZ2dlciBjaGFuZ2UgaWYgbmVj
ZXNzYXJ5LgogKi8KZnVuY3Rpb24gZGVsIChvYmosIGtleSkgewogIHZhciBvYiA9IG9iai5fX29i
X187CiAgaWYgKG9iai5faXNWdWUgfHwgKG9iICYmIG9iLnZtQ291bnQpKSB7CiAgICAiZGV2ZWxv
cG1lbnQiICE9PSAncHJvZHVjdGlvbicgJiYgd2FybigKICAgICAgJ0F2b2lkIGRlbGV0aW5nIHBy
b3BlcnRpZXMgb24gYSBWdWUgaW5zdGFuY2Ugb3IgaXRzIHJvb3QgJGRhdGEgJyArCiAgICAgICct
IGp1c3Qgc2V0IGl0IHRvIG51bGwuJwogICAgKTsKICAgIHJldHVybgogIH0KICBpZiAoIWhhc093
bihvYmosIGtleSkpIHsKICAgIHJldHVybgogIH0KICBkZWxldGUgb2JqW2tleV07CiAgaWYgKCFv
YikgewogICAgcmV0dXJuCiAgfQogIG9iLmRlcC5ub3RpZnkoKTsKfQoKLyoqCiAqIENvbGxlY3Qg
ZGVwZW5kZW5jaWVzIG9uIGFycmF5IGVsZW1lbnRzIHdoZW4gdGhlIGFycmF5IGlzIHRvdWNoZWQs
IHNpbmNlCiAqIHdlIGNhbm5vdCBpbnRlcmNlcHQgYXJyYXkgZWxlbWVudCBhY2Nlc3MgbGlrZSBw
cm9wZXJ0eSBnZXR0ZXJzLgogKi8KZnVuY3Rpb24gZGVwZW5kQXJyYXkgKHZhbHVlKSB7CiAgZm9y
ICh2YXIgZSA9ICh2b2lkIDApLCBpID0gMCwgbCA9IHZhbHVlLmxlbmd0aDsgaSA8IGw7IGkrKykg
ewogICAgZSA9IHZhbHVlW2ldOwogICAgZSAmJiBlLl9fb2JfXyAmJiBlLl9fb2JfXy5kZXAuZGVw
ZW5kKCk7CiAgICBpZiAoQXJyYXkuaXNBcnJheShlKSkgewogICAgICBkZXBlbmRBcnJheShlKTsK
ICAgIH0KICB9Cn0KCi8qICAqLwoKLyoqCiAqIE9wdGlvbiBvdmVyd3JpdGluZyBzdHJhdGVnaWVz
IGFyZSBmdW5jdGlvbnMgdGhhdCBoYW5kbGUKICogaG93IHRvIG1lcmdlIGEgcGFyZW50IG9wdGlv
biB2YWx1ZSBhbmQgYSBjaGlsZCBvcHRpb24KICogdmFsdWUgaW50byB0aGUgZmluYWwgdmFsdWUu
CiAqLwp2YXIgc3RyYXRzID0gY29uZmlnLm9wdGlvbk1lcmdlU3RyYXRlZ2llczsKCi8qKgogKiBP
cHRpb25zIHdpdGggcmVzdHJpY3Rpb25zCiAqLwp7CiAgc3RyYXRzLmVsID0gc3RyYXRzLnByb3Bz
RGF0YSA9IGZ1bmN0aW9uIChwYXJlbnQsIGNoaWxkLCB2bSwga2V5KSB7CiAgICBpZiAoIXZtKSB7
CiAgICAgIHdhcm4oCiAgICAgICAgIm9wdGlvbiBcIiIgKyBrZXkgKyAiXCIgY2FuIG9ubHkgYmUg
dXNlZCBkdXJpbmcgaW5zdGFuY2UgIiArCiAgICAgICAgJ2NyZWF0aW9uIHdpdGggdGhlIGBuZXdg
IGtleXdvcmQuJwogICAgICApOwogICAgfQogICAgcmV0dXJuIGRlZmF1bHRTdHJhdChwYXJlbnQs
IGNoaWxkKQogIH07Cn0KCi8qKgogKiBIZWxwZXIgdGhhdCByZWN1cnNpdmVseSBtZXJnZXMgdHdv
IGRhdGEgb2JqZWN0cyB0b2dldGhlci4KICovCmZ1bmN0aW9uIG1lcmdlRGF0YSAodG8sIGZyb20p
IHsKICBpZiAoIWZyb20pIHsgcmV0dXJuIHRvIH0KICB2YXIga2V5LCB0b1ZhbCwgZnJvbVZhbDsK
ICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGZyb20pOwogIGZvciAodmFyIGkgPSAwOyBpIDwga2V5
cy5sZW5ndGg7IGkrKykgewogICAga2V5ID0ga2V5c1tpXTsKICAgIHRvVmFsID0gdG9ba2V5XTsK
ICAgIGZyb21WYWwgPSBmcm9tW2tleV07CiAgICBpZiAoIWhhc093bih0bywga2V5KSkgewogICAg
ICBzZXQkMSh0bywga2V5LCBmcm9tVmFsKTsKICAgIH0gZWxzZSBpZiAoaXNQbGFpbk9iamVjdCh0
b1ZhbCkgJiYgaXNQbGFpbk9iamVjdChmcm9tVmFsKSkgewogICAgICBtZXJnZURhdGEodG9WYWws
IGZyb21WYWwpOwogICAgfQogIH0KICByZXR1cm4gdG8KfQoKLyoqCiAqIERhdGEKICovCnN0cmF0
cy5kYXRhID0gZnVuY3Rpb24gKAogIHBhcmVudFZhbCwKICBjaGlsZFZhbCwKICB2bQopIHsKICBp
ZiAoIXZtKSB7CiAgICAvLyBpbiBhIFZ1ZS5leHRlbmQgbWVyZ2UsIGJvdGggc2hvdWxkIGJlIGZ1
bmN0aW9ucwogICAgaWYgKCFjaGlsZFZhbCkgewogICAgICByZXR1cm4gcGFyZW50VmFsCiAgICB9
CiAgICBpZiAodHlwZW9mIGNoaWxkVmFsICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICJkZXZlbG9w
bWVudCIgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKAogICAgICAgICdUaGUgImRhdGEiIG9wdGlv
biBzaG91bGQgYmUgYSBmdW5jdGlvbiAnICsKICAgICAgICAndGhhdCByZXR1cm5zIGEgcGVyLWlu
c3RhbmNlIHZhbHVlIGluIGNvbXBvbmVudCAnICsKICAgICAgICAnZGVmaW5pdGlvbnMuJywKICAg
ICAgICB2bQogICAgICApOwogICAgICByZXR1cm4gcGFyZW50VmFsCiAgICB9CiAgICBpZiAoIXBh
cmVudFZhbCkgewogICAgICByZXR1cm4gY2hpbGRWYWwKICAgIH0KICAgIC8vIHdoZW4gcGFyZW50
VmFsICYgY2hpbGRWYWwgYXJlIGJvdGggcHJlc2VudCwKICAgIC8vIHdlIG5lZWQgdG8gcmV0dXJu
IGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZQogICAgLy8gbWVyZ2VkIHJlc3VsdCBvZiBib3Ro
IGZ1bmN0aW9ucy4uLiBubyBuZWVkIHRvCiAgICAvLyBjaGVjayBpZiBwYXJlbnRWYWwgaXMgYSBm
dW5jdGlvbiBoZXJlIGJlY2F1c2UKICAgIC8vIGl0IGhhcyB0byBiZSBhIGZ1bmN0aW9uIHRvIHBh
c3MgcHJldmlvdXMgbWVyZ2VzLgogICAgcmV0dXJuIGZ1bmN0aW9uIG1lcmdlZERhdGFGbiAoKSB7
CiAgICAgIHJldHVybiBtZXJnZURhdGEoCiAgICAgICAgY2hpbGRWYWwuY2FsbCh0aGlzKSwKICAg
ICAgICBwYXJlbnRWYWwuY2FsbCh0aGlzKQogICAgICApCiAgICB9CiAgfSBlbHNlIGlmIChwYXJl
bnRWYWwgfHwgY2hpbGRWYWwpIHsKICAgIHJldHVybiBmdW5jdGlvbiBtZXJnZWRJbnN0YW5jZURh
dGFGbiAoKSB7CiAgICAgIC8vIGluc3RhbmNlIG1lcmdlCiAgICAgIHZhciBpbnN0YW5jZURhdGEg
PSB0eXBlb2YgY2hpbGRWYWwgPT09ICdmdW5jdGlvbicKICAgICAgICA/IGNoaWxkVmFsLmNhbGwo
dm0pCiAgICAgICAgOiBjaGlsZFZhbDsKICAgICAgdmFyIGRlZmF1bHREYXRhID0gdHlwZW9mIHBh
cmVudFZhbCA9PT0gJ2Z1bmN0aW9uJwogICAgICAgID8gcGFyZW50VmFsLmNhbGwodm0pCiAgICAg
ICAgOiB1bmRlZmluZWQ7CiAgICAgIGlmIChpbnN0YW5jZURhdGEpIHsKICAgICAgICByZXR1cm4g
bWVyZ2VEYXRhKGluc3RhbmNlRGF0YSwgZGVmYXVsdERhdGEpCiAgICAgIH0gZWxzZSB7CiAgICAg
ICAgcmV0dXJuIGRlZmF1bHREYXRhCiAgICAgIH0KICAgIH0KICB9Cn07CgovKioKICogSG9va3Mg
YW5kIHBhcmFtIGF0dHJpYnV0ZXMgYXJlIG1lcmdlZCBhcyBhcnJheXMuCiAqLwpmdW5jdGlvbiBt
ZXJnZUhvb2sgKAogIHBhcmVudFZhbCwKICBjaGlsZFZhbAopIHsKICByZXR1cm4gY2hpbGRWYWwK
ICAgID8gcGFyZW50VmFsCiAgICAgID8gcGFyZW50VmFsLmNvbmNhdChjaGlsZFZhbCkKICAgICAg
OiBBcnJheS5pc0FycmF5KGNoaWxkVmFsKQogICAgICAgID8gY2hpbGRWYWwKICAgICAgICA6IFtj
aGlsZFZhbF0KICAgIDogcGFyZW50VmFsCn0KCmNvbmZpZy5fbGlmZWN5Y2xlSG9va3MuZm9yRWFj
aChmdW5jdGlvbiAoaG9vaykgewogIHN0cmF0c1tob29rXSA9IG1lcmdlSG9vazsKfSk7CgovKioK
ICogQXNzZXRzCiAqCiAqIFdoZW4gYSB2bSBpcyBwcmVzZW50IChpbnN0YW5jZSBjcmVhdGlvbiks
IHdlIG5lZWQgdG8gZG8KICogYSB0aHJlZS13YXkgbWVyZ2UgYmV0d2VlbiBjb25zdHJ1Y3RvciBv
cHRpb25zLCBpbnN0YW5jZQogKiBvcHRpb25zIGFuZCBwYXJlbnQgb3B0aW9ucy4KICovCmZ1bmN0
aW9uIG1lcmdlQXNzZXRzIChwYXJlbnRWYWwsIGNoaWxkVmFsKSB7CiAgdmFyIHJlcyA9IE9iamVj
dC5jcmVhdGUocGFyZW50VmFsIHx8IG51bGwpOwogIHJldHVybiBjaGlsZFZhbAogICAgPyBleHRl
bmQocmVzLCBjaGlsZFZhbCkKICAgIDogcmVzCn0KCmNvbmZpZy5fYXNzZXRUeXBlcy5mb3JFYWNo
KGZ1bmN0aW9uICh0eXBlKSB7CiAgc3RyYXRzW3R5cGUgKyAncyddID0gbWVyZ2VBc3NldHM7Cn0p
OwoKLyoqCiAqIFdhdGNoZXJzLgogKgogKiBXYXRjaGVycyBoYXNoZXMgc2hvdWxkIG5vdCBvdmVy
d3JpdGUgb25lCiAqIGFub3RoZXIsIHNvIHdlIG1lcmdlIHRoZW0gYXMgYXJyYXlzLgogKi8Kc3Ry
YXRzLndhdGNoID0gZnVuY3Rpb24gKHBhcmVudFZhbCwgY2hpbGRWYWwpIHsKICAvKiBpc3RhbmJ1
bCBpZ25vcmUgaWYgKi8KICBpZiAoIWNoaWxkVmFsKSB7IHJldHVybiBwYXJlbnRWYWwgfQogIGlm
ICghcGFyZW50VmFsKSB7IHJldHVybiBjaGlsZFZhbCB9CiAgdmFyIHJldCA9IHt9OwogIGV4dGVu
ZChyZXQsIHBhcmVudFZhbCk7CiAgZm9yICh2YXIga2V5IGluIGNoaWxkVmFsKSB7CiAgICB2YXIg
cGFyZW50ID0gcmV0W2tleV07CiAgICB2YXIgY2hpbGQgPSBjaGlsZFZhbFtrZXldOwogICAgaWYg
KHBhcmVudCAmJiAhQXJyYXkuaXNBcnJheShwYXJlbnQpKSB7CiAgICAgIHBhcmVudCA9IFtwYXJl
bnRdOwogICAgfQogICAgcmV0W2tleV0gPSBwYXJlbnQKICAgICAgPyBwYXJlbnQuY29uY2F0KGNo
aWxkKQogICAgICA6IFtjaGlsZF07CiAgfQogIHJldHVybiByZXQKfTsKCi8qKgogKiBPdGhlciBv
YmplY3QgaGFzaGVzLgogKi8Kc3RyYXRzLnByb3BzID0Kc3RyYXRzLm1ldGhvZHMgPQpzdHJhdHMu
Y29tcHV0ZWQgPSBmdW5jdGlvbiAocGFyZW50VmFsLCBjaGlsZFZhbCkgewogIGlmICghY2hpbGRW
YWwpIHsgcmV0dXJuIHBhcmVudFZhbCB9CiAgaWYgKCFwYXJlbnRWYWwpIHsgcmV0dXJuIGNoaWxk
VmFsIH0KICB2YXIgcmV0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICBleHRlbmQocmV0LCBwYXJl
bnRWYWwpOwogIGV4dGVuZChyZXQsIGNoaWxkVmFsKTsKICByZXR1cm4gcmV0Cn07CgovKioKICog
RGVmYXVsdCBzdHJhdGVneS4KICovCnZhciBkZWZhdWx0U3RyYXQgPSBmdW5jdGlvbiAocGFyZW50
VmFsLCBjaGlsZFZhbCkgewogIHJldHVybiBjaGlsZFZhbCA9PT0gdW5kZWZpbmVkCiAgICA/IHBh
cmVudFZhbAogICAgOiBjaGlsZFZhbAp9OwoKLyoqCiAqIFZhbGlkYXRlIGNvbXBvbmVudCBuYW1l
cwogKi8KZnVuY3Rpb24gY2hlY2tDb21wb25lbnRzIChvcHRpb25zKSB7CiAgZm9yICh2YXIga2V5
IGluIG9wdGlvbnMuY29tcG9uZW50cykgewogICAgdmFyIGxvd2VyID0ga2V5LnRvTG93ZXJDYXNl
KCk7CiAgICBpZiAoaXNCdWlsdEluVGFnKGxvd2VyKSB8fCBjb25maWcuaXNSZXNlcnZlZFRhZyhs
b3dlcikpIHsKICAgICAgd2FybigKICAgICAgICAnRG8gbm90IHVzZSBidWlsdC1pbiBvciByZXNl
cnZlZCBIVE1MIGVsZW1lbnRzIGFzIGNvbXBvbmVudCAnICsKICAgICAgICAnaWQ6ICcgKyBrZXkK
ICAgICAgKTsKICAgIH0KICB9Cn0KCi8qKgogKiBFbnN1cmUgYWxsIHByb3BzIG9wdGlvbiBzeW50
YXggYXJlIG5vcm1hbGl6ZWQgaW50byB0aGUKICogT2JqZWN0LWJhc2VkIGZvcm1hdC4KICovCmZ1
bmN0aW9uIG5vcm1hbGl6ZVByb3BzIChvcHRpb25zKSB7CiAgdmFyIHByb3BzID0gb3B0aW9ucy5w
cm9wczsKICBpZiAoIXByb3BzKSB7IHJldHVybiB9CiAgdmFyIHJlcyA9IHt9OwogIHZhciBpLCB2
YWwsIG5hbWU7CiAgaWYgKEFycmF5LmlzQXJyYXkocHJvcHMpKSB7CiAgICBpID0gcHJvcHMubGVu
Z3RoOwogICAgd2hpbGUgKGktLSkgewogICAgICB2YWwgPSBwcm9wc1tpXTsKICAgICAgaWYgKHR5
cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgbmFtZSA9IGNhbWVsaXplKHZhbCk7CiAg
ICAgICAgcmVzW25hbWVdID0geyB0eXBlOiBudWxsIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAg
d2FybigncHJvcHMgbXVzdCBiZSBzdHJpbmdzIHdoZW4gdXNpbmcgYXJyYXkgc3ludGF4LicpOwog
ICAgICB9CiAgICB9CiAgfSBlbHNlIGlmIChpc1BsYWluT2JqZWN0KHByb3BzKSkgewogICAgZm9y
ICh2YXIga2V5IGluIHByb3BzKSB7CiAgICAgIHZhbCA9IHByb3BzW2tleV07CiAgICAgIG5hbWUg
PSBjYW1lbGl6ZShrZXkpOwogICAgICByZXNbbmFtZV0gPSBpc1BsYWluT2JqZWN0KHZhbCkKICAg
ICAgICA/IHZhbAogICAgICAgIDogeyB0eXBlOiB2YWwgfTsKICAgIH0KICB9CiAgb3B0aW9ucy5w
cm9wcyA9IHJlczsKfQoKLyoqCiAqIE5vcm1hbGl6ZSByYXcgZnVuY3Rpb24gZGlyZWN0aXZlcyBp
bnRvIG9iamVjdCBmb3JtYXQuCiAqLwpmdW5jdGlvbiBub3JtYWxpemVEaXJlY3RpdmVzIChvcHRp
b25zKSB7CiAgdmFyIGRpcnMgPSBvcHRpb25zLmRpcmVjdGl2ZXM7CiAgaWYgKGRpcnMpIHsKICAg
IGZvciAodmFyIGtleSBpbiBkaXJzKSB7CiAgICAgIHZhciBkZWYgPSBkaXJzW2tleV07CiAgICAg
IGlmICh0eXBlb2YgZGVmID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZGlyc1trZXldID0geyBi
aW5kOiBkZWYsIHVwZGF0ZTogZGVmIH07CiAgICAgIH0KICAgIH0KICB9Cn0KCi8qKgogKiBNZXJn
ZSB0d28gb3B0aW9uIG9iamVjdHMgaW50byBhIG5ldyBvbmUuCiAqIENvcmUgdXRpbGl0eSB1c2Vk
IGluIGJvdGggaW5zdGFudGlhdGlvbiBhbmQgaW5oZXJpdGFuY2UuCiAqLwpmdW5jdGlvbiBtZXJn
ZU9wdGlvbnMgKAogIHBhcmVudCwKICBjaGlsZCwKICB2bQopIHsKICB7CiAgICBjaGVja0NvbXBv
bmVudHMoY2hpbGQpOwogIH0KICBub3JtYWxpemVQcm9wcyhjaGlsZCk7CiAgbm9ybWFsaXplRGly
ZWN0aXZlcyhjaGlsZCk7CiAgdmFyIGV4dGVuZHNGcm9tID0gY2hpbGQuZXh0ZW5kczsKICBpZiAo
ZXh0ZW5kc0Zyb20pIHsKICAgIHBhcmVudCA9IHR5cGVvZiBleHRlbmRzRnJvbSA9PT0gJ2Z1bmN0
aW9uJwogICAgICA/IG1lcmdlT3B0aW9ucyhwYXJlbnQsIGV4dGVuZHNGcm9tLm9wdGlvbnMsIHZt
KQogICAgICA6IG1lcmdlT3B0aW9ucyhwYXJlbnQsIGV4dGVuZHNGcm9tLCB2bSk7CiAgfQogIGlm
IChjaGlsZC5taXhpbnMpIHsKICAgIGZvciAodmFyIGkgPSAwLCBsID0gY2hpbGQubWl4aW5zLmxl
bmd0aDsgaSA8IGw7IGkrKykgewogICAgICB2YXIgbWl4aW4gPSBjaGlsZC5taXhpbnNbaV07CiAg
ICAgIGlmIChtaXhpbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBWdWUkMykgewogICAgICAgIG1peGlu
ID0gbWl4aW4ub3B0aW9uczsKICAgICAgfQogICAgICBwYXJlbnQgPSBtZXJnZU9wdGlvbnMocGFy
ZW50LCBtaXhpbiwgdm0pOwogICAgfQogIH0KICB2YXIgb3B0aW9ucyA9IHt9OwogIHZhciBrZXk7
CiAgZm9yIChrZXkgaW4gcGFyZW50KSB7CiAgICBtZXJnZUZpZWxkKGtleSk7CiAgfQogIGZvciAo
a2V5IGluIGNoaWxkKSB7CiAgICBpZiAoIWhhc093bihwYXJlbnQsIGtleSkpIHsKICAgICAgbWVy
Z2VGaWVsZChrZXkpOwogICAgfQogIH0KICBmdW5jdGlvbiBtZXJnZUZpZWxkIChrZXkpIHsKICAg
IHZhciBzdHJhdCA9IHN0cmF0c1trZXldIHx8IGRlZmF1bHRTdHJhdDsKICAgIG9wdGlvbnNba2V5
XSA9IHN0cmF0KHBhcmVudFtrZXldLCBjaGlsZFtrZXldLCB2bSwga2V5KTsKICB9CiAgcmV0dXJu
IG9wdGlvbnMKfQoKLyoqCiAqIFJlc29sdmUgYW4gYXNzZXQuCiAqIFRoaXMgZnVuY3Rpb24gaXMg
dXNlZCBiZWNhdXNlIGNoaWxkIGluc3RhbmNlcyBuZWVkIGFjY2VzcwogKiB0byBhc3NldHMgZGVm
aW5lZCBpbiBpdHMgYW5jZXN0b3IgY2hhaW4uCiAqLwpmdW5jdGlvbiByZXNvbHZlQXNzZXQgKAog
IG9wdGlvbnMsCiAgdHlwZSwKICBpZCwKICB3YXJuTWlzc2luZwopIHsKICAvKiBpc3RhbmJ1bCBp
Z25vcmUgaWYgKi8KICBpZiAodHlwZW9mIGlkICE9PSAnc3RyaW5nJykgewogICAgcmV0dXJuCiAg
fQogIHZhciBhc3NldHMgPSBvcHRpb25zW3R5cGVdOwogIC8vIGNoZWNrIGxvY2FsIHJlZ2lzdHJh
dGlvbiB2YXJpYXRpb25zIGZpcnN0CiAgaWYgKGhhc093bihhc3NldHMsIGlkKSkgeyByZXR1cm4g
YXNzZXRzW2lkXSB9CiAgdmFyIGNhbWVsaXplZElkID0gY2FtZWxpemUoaWQpOwogIGlmIChoYXNP
d24oYXNzZXRzLCBjYW1lbGl6ZWRJZCkpIHsgcmV0dXJuIGFzc2V0c1tjYW1lbGl6ZWRJZF0gfQog
IHZhciBQYXNjYWxDYXNlSWQgPSBjYXBpdGFsaXplKGNhbWVsaXplZElkKTsKICBpZiAoaGFzT3du
KGFzc2V0cywgUGFzY2FsQ2FzZUlkKSkgeyByZXR1cm4gYXNzZXRzW1Bhc2NhbENhc2VJZF0gfQog
IC8vIGZhbGxiYWNrIHRvIHByb3RvdHlwZSBjaGFpbgogIHZhciByZXMgPSBhc3NldHNbaWRdIHx8
IGFzc2V0c1tjYW1lbGl6ZWRJZF0gfHwgYXNzZXRzW1Bhc2NhbENhc2VJZF07CiAgaWYgKCJkZXZl
bG9wbWVudCIgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuTWlzc2luZyAmJiAhcmVzKSB7CiAgICB3
YXJuKAogICAgICAnRmFpbGVkIHRvIHJlc29sdmUgJyArIHR5cGUuc2xpY2UoMCwgLTEpICsgJzog
JyArIGlkLAogICAgICBvcHRpb25zCiAgICApOwogIH0KICByZXR1cm4gcmVzCn0KCi8qICAqLwoK
ZnVuY3Rpb24gdmFsaWRhdGVQcm9wICgKICBrZXksCiAgcHJvcE9wdGlvbnMsCiAgcHJvcHNEYXRh
LAogIHZtCikgewogIHZhciBwcm9wID0gcHJvcE9wdGlvbnNba2V5XTsKICB2YXIgYWJzZW50ID0g
IWhhc093bihwcm9wc0RhdGEsIGtleSk7CiAgdmFyIHZhbHVlID0gcHJvcHNEYXRhW2tleV07CiAg
Ly8gaGFuZGxlIGJvb2xlYW4gcHJvcHMKICBpZiAoaXNCb29sZWFuVHlwZShwcm9wLnR5cGUpKSB7
CiAgICBpZiAoYWJzZW50ICYmICFoYXNPd24ocHJvcCwgJ2RlZmF1bHQnKSkgewogICAgICB2YWx1
ZSA9IGZhbHNlOwogICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gJycgfHwgdmFsdWUgPT09IGh5cGhl
bmF0ZShrZXkpKSB7CiAgICAgIHZhbHVlID0gdHJ1ZTsKICAgIH0KICB9CiAgLy8gY2hlY2sgZGVm
YXVsdCB2YWx1ZQogIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICB2YWx1ZSA9IGdldFBy
b3BEZWZhdWx0VmFsdWUodm0sIHByb3AsIGtleSk7CiAgICAvLyBzaW5jZSB0aGUgZGVmYXVsdCB2
YWx1ZSBpcyBhIGZyZXNoIGNvcHksCiAgICAvLyBtYWtlIHN1cmUgdG8gb2JzZXJ2ZSBpdC4KICAg
IHZhciBwcmV2U2hvdWxkQ29udmVydCA9IG9ic2VydmVyU3RhdGUuc2hvdWxkQ29udmVydDsKICAg
IG9ic2VydmVyU3RhdGUuc2hvdWxkQ29udmVydCA9IHRydWU7CiAgICBvYnNlcnZlKHZhbHVlKTsK
ICAgIG9ic2VydmVyU3RhdGUuc2hvdWxkQ29udmVydCA9IHByZXZTaG91bGRDb252ZXJ0OwogIH0K
ICB7CiAgICBhc3NlcnRQcm9wKHByb3AsIGtleSwgdmFsdWUsIHZtLCBhYnNlbnQpOwogIH0KICBy
ZXR1cm4gdmFsdWUKfQoKLyoqCiAqIEdldCB0aGUgZGVmYXVsdCB2YWx1ZSBvZiBhIHByb3AuCiAq
LwpmdW5jdGlvbiBnZXRQcm9wRGVmYXVsdFZhbHVlICh2bSwgcHJvcCwga2V5KSB7CiAgLy8gbm8g
ZGVmYXVsdCwgcmV0dXJuIHVuZGVmaW5lZAogIGlmICghaGFzT3duKHByb3AsICdkZWZhdWx0Jykp
IHsKICAgIHJldHVybiB1bmRlZmluZWQKICB9CiAgdmFyIGRlZiA9IHByb3AuZGVmYXVsdDsKICAv
LyB3YXJuIGFnYWluc3Qgbm9uLWZhY3RvcnkgZGVmYXVsdHMgZm9yIE9iamVjdCAmIEFycmF5CiAg
aWYgKGlzT2JqZWN0KGRlZikpIHsKICAgICJkZXZlbG9wbWVudCIgIT09ICdwcm9kdWN0aW9uJyAm
JiB3YXJuKAogICAgICAnSW52YWxpZCBkZWZhdWx0IHZhbHVlIGZvciBwcm9wICInICsga2V5ICsg
JyI6ICcgKwogICAgICAnUHJvcHMgd2l0aCB0eXBlIE9iamVjdC9BcnJheSBtdXN0IHVzZSBhIGZh
Y3RvcnkgZnVuY3Rpb24gJyArCiAgICAgICd0byByZXR1cm4gdGhlIGRlZmF1bHQgdmFsdWUuJywK
ICAgICAgdm0KICAgICk7CiAgfQogIC8vIHRoZSByYXcgcHJvcCB2YWx1ZSB3YXMgYWxzbyB1bmRl
ZmluZWQgZnJvbSBwcmV2aW91cyByZW5kZXIsCiAgLy8gcmV0dXJuIHByZXZpb3VzIGRlZmF1bHQg
dmFsdWUgdG8gYXZvaWQgdW5uZWNlc3Nhcnkgd2F0Y2hlciB0cmlnZ2VyCiAgaWYgKHZtICYmIHZt
LiRvcHRpb25zLnByb3BzRGF0YSAmJgogICAgdm0uJG9wdGlvbnMucHJvcHNEYXRhW2tleV0gPT09
IHVuZGVmaW5lZCAmJgogICAgdm1ba2V5XSAhPT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gdm1b
a2V5XQogIH0KICAvLyBjYWxsIGZhY3RvcnkgZnVuY3Rpb24gZm9yIG5vbi1GdW5jdGlvbiB0eXBl
cwogIHJldHVybiB0eXBlb2YgZGVmID09PSAnZnVuY3Rpb24nICYmIHByb3AudHlwZSAhPT0gRnVu
Y3Rpb24KICAgID8gZGVmLmNhbGwodm0pCiAgICA6IGRlZgp9CgovKioKICogQXNzZXJ0IHdoZXRo
ZXIgYSBwcm9wIGlzIHZhbGlkLgogKi8KZnVuY3Rpb24gYXNzZXJ0UHJvcCAoCiAgcHJvcCwKICBu
YW1lLAogIHZhbHVlLAogIHZtLAogIGFic2VudAopIHsKICBpZiAocHJvcC5yZXF1aXJlZCAmJiBh
YnNlbnQpIHsKICAgIHdhcm4oCiAgICAgICdNaXNzaW5nIHJlcXVpcmVkIHByb3A6ICInICsgbmFt
ZSArICciJywKICAgICAgdm0KICAgICk7CiAgICByZXR1cm4KICB9CiAgaWYgKHZhbHVlID09IG51
bGwgJiYgIXByb3AucmVxdWlyZWQpIHsKICAgIHJldHVybgogIH0KICB2YXIgdHlwZSA9IHByb3Au
dHlwZTsKICB2YXIgdmFsaWQgPSAhdHlwZSB8fCB0eXBlID09PSB0cnVlOwogIHZhciBleHBlY3Rl
ZFR5cGVzID0gW107CiAgaWYgKHR5cGUpIHsKICAgIGlmICghQXJyYXkuaXNBcnJheSh0eXBlKSkg
ewogICAgICB0eXBlID0gW3R5cGVdOwogICAgfQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0eXBl
Lmxlbmd0aCAmJiAhdmFsaWQ7IGkrKykgewogICAgICB2YXIgYXNzZXJ0ZWRUeXBlID0gYXNzZXJ0
VHlwZSh2YWx1ZSwgdHlwZVtpXSk7CiAgICAgIGV4cGVjdGVkVHlwZXMucHVzaChhc3NlcnRlZFR5
cGUuZXhwZWN0ZWRUeXBlKTsKICAgICAgdmFsaWQgPSBhc3NlcnRlZFR5cGUudmFsaWQ7CiAgICB9
CiAgfQogIGlmICghdmFsaWQpIHsKICAgIHdhcm4oCiAgICAgICdJbnZhbGlkIHByb3A6IHR5cGUg
Y2hlY2sgZmFpbGVkIGZvciBwcm9wICInICsgbmFtZSArICciLicgKwogICAgICAnIEV4cGVjdGVk
ICcgKyBleHBlY3RlZFR5cGVzLm1hcChjYXBpdGFsaXplKS5qb2luKCcsICcpICsKICAgICAgJywg
Z290ICcgKyBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpLnNsaWNlKDgsIC0x
KSArICcuJywKICAgICAgdm0KICAgICk7CiAgICByZXR1cm4KICB9CiAgdmFyIHZhbGlkYXRvciA9
IHByb3AudmFsaWRhdG9yOwogIGlmICh2YWxpZGF0b3IpIHsKICAgIGlmICghdmFsaWRhdG9yKHZh
bHVlKSkgewogICAgICB3YXJuKAogICAgICAgICdJbnZhbGlkIHByb3A6IGN1c3RvbSB2YWxpZGF0
b3IgY2hlY2sgZmFpbGVkIGZvciBwcm9wICInICsgbmFtZSArICciLicsCiAgICAgICAgdm0KICAg
ICAgKTsKICAgIH0KICB9Cn0KCi8qKgogKiBBc3NlcnQgdGhlIHR5cGUgb2YgYSB2YWx1ZQogKi8K
ZnVuY3Rpb24gYXNzZXJ0VHlwZSAodmFsdWUsIHR5cGUpIHsKICB2YXIgdmFsaWQ7CiAgdmFyIGV4
cGVjdGVkVHlwZSA9IGdldFR5cGUodHlwZSk7CiAgaWYgKGV4cGVjdGVkVHlwZSA9PT0gJ1N0cmlu
ZycpIHsKICAgIHZhbGlkID0gdHlwZW9mIHZhbHVlID09PSAoZXhwZWN0ZWRUeXBlID0gJ3N0cmlu
ZycpOwogIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSAnTnVtYmVyJykgewogICAgdmFsaWQg
PSB0eXBlb2YgdmFsdWUgPT09IChleHBlY3RlZFR5cGUgPSAnbnVtYmVyJyk7CiAgfSBlbHNlIGlm
IChleHBlY3RlZFR5cGUgPT09ICdCb29sZWFuJykgewogICAgdmFsaWQgPSB0eXBlb2YgdmFsdWUg
PT09IChleHBlY3RlZFR5cGUgPSAnYm9vbGVhbicpOwogIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBl
ID09PSAnRnVuY3Rpb24nKSB7CiAgICB2YWxpZCA9IHR5cGVvZiB2YWx1ZSA9PT0gKGV4cGVjdGVk
VHlwZSA9ICdmdW5jdGlvbicpOwogIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSAnT2JqZWN0
JykgewogICAgdmFsaWQgPSBpc1BsYWluT2JqZWN0KHZhbHVlKTsKICB9IGVsc2UgaWYgKGV4cGVj
dGVkVHlwZSA9PT0gJ0FycmF5JykgewogICAgdmFsaWQgPSBBcnJheS5pc0FycmF5KHZhbHVlKTsK
ICB9IGVsc2UgewogICAgdmFsaWQgPSB2YWx1ZSBpbnN0YW5jZW9mIHR5cGU7CiAgfQogIHJldHVy
biB7CiAgICB2YWxpZDogdmFsaWQsCiAgICBleHBlY3RlZFR5cGU6IGV4cGVjdGVkVHlwZQogIH0K
fQoKLyoqCiAqIFVzZSBmdW5jdGlvbiBzdHJpbmcgbmFtZSB0byBjaGVjayBidWlsdC1pbiB0eXBl
cywKICogYmVjYXVzZSBhIHNpbXBsZSBlcXVhbGl0eSBjaGVjayB3aWxsIGZhaWwgd2hlbiBydW5u
aW5nCiAqIGFjcm9zcyBkaWZmZXJlbnQgdm1zIC8gaWZyYW1lcy4KICovCmZ1bmN0aW9uIGdldFR5
cGUgKGZuKSB7CiAgdmFyIG1hdGNoID0gZm4gJiYgZm4udG9TdHJpbmcoKS5tYXRjaCgvXlxzKmZ1
bmN0aW9uIChcdyspLyk7CiAgcmV0dXJuIG1hdGNoICYmIG1hdGNoWzFdCn0KCmZ1bmN0aW9uIGlz
Qm9vbGVhblR5cGUgKGZuKSB7CiAgaWYgKCFBcnJheS5pc0FycmF5KGZuKSkgewogICAgcmV0dXJu
IGdldFR5cGUoZm4pID09PSAnQm9vbGVhbicKICB9CiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGZu
Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICBpZiAoZ2V0VHlwZShmbltpXSkgPT09ICdCb29s
ZWFuJykgewogICAgICByZXR1cm4gdHJ1ZQogICAgfQogIH0KICAvKiBpc3RhbmJ1bCBpZ25vcmUg
bmV4dCAqLwogIHJldHVybiBmYWxzZQp9CgoKCnZhciB1dGlsID0gT2JqZWN0LmZyZWV6ZSh7Cglk
ZWZpbmVSZWFjdGl2ZTogZGVmaW5lUmVhY3RpdmUkJDEsCglfdG9TdHJpbmc6IF90b1N0cmluZywK
CXRvTnVtYmVyOiB0b051bWJlciwKCW1ha2VNYXA6IG1ha2VNYXAsCglpc0J1aWx0SW5UYWc6IGlz
QnVpbHRJblRhZywKCXJlbW92ZTogcmVtb3ZlJDEsCgloYXNPd246IGhhc093biwKCWlzUHJpbWl0
aXZlOiBpc1ByaW1pdGl2ZSwKCWNhY2hlZDogY2FjaGVkLAoJY2FtZWxpemU6IGNhbWVsaXplLAoJ
Y2FwaXRhbGl6ZTogY2FwaXRhbGl6ZSwKCWh5cGhlbmF0ZTogaHlwaGVuYXRlLAoJYmluZDogYmlu
ZCQxLAoJdG9BcnJheTogdG9BcnJheSwKCWV4dGVuZDogZXh0ZW5kLAoJaXNPYmplY3Q6IGlzT2Jq
ZWN0LAoJaXNQbGFpbk9iamVjdDogaXM=</Default>
</Parameter>

<Parameter name="Frag916644214336285718623729">
<Default>dmFyIHRhciA9ICcgJyArIGNscyArICcgJzsKICAgIHdoaWxlIChjdXIuaW5kZXhPZih0YXIpID49
IDApIHsKICAgICAgY3VyID0gY3VyLnJlcGxhY2UodGFyLCAnICcpOwogICAgfQogICAgZWwuc2V0
QXR0cmlidXRlKCdjbGFzcycsIGN1ci50cmltKCkpOwogIH0KfQoKLyogICovCgp2YXIgaGFzVHJh
bnNpdGlvbiA9IGluQnJvd3NlciAmJiAhaXNJRTk7CnZhciBUUkFOU0lUSU9OID0gJ3RyYW5zaXRp
b24nOwp2YXIgQU5JTUFUSU9OID0gJ2FuaW1hdGlvbic7CgovLyBUcmFuc2l0aW9uIHByb3BlcnR5
L2V2ZW50IHNuaWZmaW5nCnZhciB0cmFuc2l0aW9uUHJvcCA9ICd0cmFuc2l0aW9uJzsKdmFyIHRy
YW5zaXRpb25FbmRFdmVudCA9ICd0cmFuc2l0aW9uZW5kJzsKdmFyIGFuaW1hdGlvblByb3AgPSAn
YW5pbWF0aW9uJzsKdmFyIGFuaW1hdGlvbkVuZEV2ZW50ID0gJ2FuaW1hdGlvbmVuZCc7CmlmICho
YXNUcmFuc2l0aW9uKSB7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKHdpbmRvdy5v
bnRyYW5zaXRpb25lbmQgPT09IHVuZGVmaW5lZCAmJgogICAgd2luZG93Lm9ud2Via2l0dHJhbnNp
dGlvbmVuZCAhPT0gdW5kZWZpbmVkKSB7CiAgICB0cmFuc2l0aW9uUHJvcCA9ICdXZWJraXRUcmFu
c2l0aW9uJzsKICAgIHRyYW5zaXRpb25FbmRFdmVudCA9ICd3ZWJraXRUcmFuc2l0aW9uRW5kJzsK
ICB9CiAgaWYgKHdpbmRvdy5vbmFuaW1hdGlvbmVuZCA9PT0gdW5kZWZpbmVkICYmCiAgICB3aW5k
b3cub253ZWJraXRhbmltYXRpb25lbmQgIT09IHVuZGVmaW5lZCkgewogICAgYW5pbWF0aW9uUHJv
cCA9ICdXZWJraXRBbmltYXRpb24nOwogICAgYW5pbWF0aW9uRW5kRXZlbnQgPSAnd2Via2l0QW5p
bWF0aW9uRW5kJzsKICB9Cn0KCnZhciByYWYgPSAoaW5Ccm93c2VyICYmIHdpbmRvdy5yZXF1ZXN0
QW5pbWF0aW9uRnJhbWUpIHx8IHNldFRpbWVvdXQ7CmZ1bmN0aW9uIG5leHRGcmFtZSAoZm4pIHsK
ICByYWYoZnVuY3Rpb24gKCkgewogICAgcmFmKGZuKTsKICB9KTsKfQoKZnVuY3Rpb24gYWRkVHJh
bnNpdGlvbkNsYXNzIChlbCwgY2xzKSB7CiAgKGVsLl90cmFuc2l0aW9uQ2xhc3NlcyB8fCAoZWwu
X3RyYW5zaXRpb25DbGFzc2VzID0gW10pKS5wdXNoKGNscyk7CiAgYWRkQ2xhc3MoZWwsIGNscyk7
Cn0KCmZ1bmN0aW9uIHJlbW92ZVRyYW5zaXRpb25DbGFzcyAoZWwsIGNscykgewogIGlmIChlbC5f
dHJhbnNpdGlvbkNsYXNzZXMpIHsKICAgIHJlbW92ZSQxKGVsLl90cmFuc2l0aW9uQ2xhc3Nlcywg
Y2xzKTsKICB9CiAgcmVtb3ZlQ2xhc3MoZWwsIGNscyk7Cn0KCmZ1bmN0aW9uIHdoZW5UcmFuc2l0
aW9uRW5kcyAoCiAgZWwsCiAgZXhwZWN0ZWRUeXBlLAogIGNiCikgewogIHZhciByZWYgPSBnZXRU
cmFuc2l0aW9uSW5mbyhlbCwgZXhwZWN0ZWRUeXBlKTsKICB2YXIgdHlwZSA9IHJlZi50eXBlOwog
IHZhciB0aW1lb3V0ID0gcmVmLnRpbWVvdXQ7CiAgdmFyIHByb3BDb3VudCA9IHJlZi5wcm9wQ291
bnQ7CiAgaWYgKCF0eXBlKSB7IHJldHVybiBjYigpIH0KICB2YXIgZXZlbnQgPSB0eXBlID09PSBU
UkFOU0lUSU9OID8gdHJhbnNpdGlvbkVuZEV2ZW50IDogYW5pbWF0aW9uRW5kRXZlbnQ7CiAgdmFy
IGVuZGVkID0gMDsKICB2YXIgZW5kID0gZnVuY3Rpb24gKCkgewogICAgZWwucmVtb3ZlRXZlbnRM
aXN0ZW5lcihldmVudCwgb25FbmQpOwogICAgY2IoKTsKICB9OwogIHZhciBvbkVuZCA9IGZ1bmN0
aW9uIChlKSB7CiAgICBpZiAoZS50YXJnZXQgPT09IGVsKSB7CiAgICAgIGlmICgrK2VuZGVkID49
IHByb3BDb3VudCkgewogICAgICAgIGVuZCgpOwogICAgICB9CiAgICB9CiAgfTsKICBzZXRUaW1l
b3V0KGZ1bmN0aW9uICgpIHsKICAgIGlmIChlbmRlZCA8IHByb3BDb3VudCkgewogICAgICBlbmQo
KTsKICAgIH0KICB9LCB0aW1lb3V0ICsgMSk7CiAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwg
b25FbmQpOwp9Cgp2YXIgdHJhbnNmb3JtUkUgPSAvXGIodHJhbnNmb3JtfGFsbCkoLHwkKS87Cgpm
dW5jdGlvbiBnZXRUcmFuc2l0aW9uSW5mbyAoZWwsIGV4cGVjdGVkVHlwZSkgewogIHZhciBzdHls
ZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCk7CiAgdmFyIHRyYW5zaXRpb25lRGVsYXlz
ID0gc3R5bGVzW3RyYW5zaXRpb25Qcm9wICsgJ0RlbGF5J10uc3BsaXQoJywgJyk7CiAgdmFyIHRy
YW5zaXRpb25EdXJhdGlvbnMgPSBzdHlsZXNbdHJhbnNpdGlvblByb3AgKyAnRHVyYXRpb24nXS5z
cGxpdCgnLCAnKTsKICB2YXIgdHJhbnNpdGlvblRpbWVvdXQgPSBnZXRUaW1lb3V0KHRyYW5zaXRp
b25lRGVsYXlzLCB0cmFuc2l0aW9uRHVyYXRpb25zKTsKICB2YXIgYW5pbWF0aW9uRGVsYXlzID0g
c3R5bGVzW2FuaW1hdGlvblByb3AgKyAnRGVsYXknXS5zcGxpdCgnLCAnKTsKICB2YXIgYW5pbWF0
aW9uRHVyYXRpb25zID0gc3R5bGVzW2FuaW1hdGlvblByb3AgKyAnRHVyYXRpb24nXS5zcGxpdCgn
LCAnKTsKICB2YXIgYW5pbWF0aW9uVGltZW91dCA9IGdldFRpbWVvdXQoYW5pbWF0aW9uRGVsYXlz
LCBhbmltYXRpb25EdXJhdGlvbnMpOwoKICB2YXIgdHlwZTsKICB2YXIgdGltZW91dCA9IDA7CiAg
dmFyIHByb3BDb3VudCA9IDA7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGV4cGVj
dGVkVHlwZSA9PT0gVFJBTlNJVElPTikgewogICAgaWYgKHRyYW5zaXRpb25UaW1lb3V0ID4gMCkg
ewogICAgICB0eXBlID0gVFJBTlNJVElPTjsKICAgICAgdGltZW91dCA9IHRyYW5zaXRpb25UaW1l
b3V0OwogICAgICBwcm9wQ291bnQgPSB0cmFuc2l0aW9uRHVyYXRpb25zLmxlbmd0aDsKICAgIH0K
ICB9IGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gQU5JTUFUSU9OKSB7CiAgICBpZiAoYW5pbWF0
aW9uVGltZW91dCA+IDApIHsKICAgICAgdHlwZSA9IEFOSU1BVElPTjsKICAgICAgdGltZW91dCA9
IGFuaW1hdGlvblRpbWVvdXQ7CiAgICAgIHByb3BDb3VudCA9IGFuaW1hdGlvbkR1cmF0aW9ucy5s
ZW5ndGg7CiAgICB9CiAgfSBlbHNlIHsKICAgIHRpbWVvdXQgPSBNYXRoLm1heCh0cmFuc2l0aW9u
VGltZW91dCwgYW5pbWF0aW9uVGltZW91dCk7CiAgICB0eXBlID0gdGltZW91dCA+IDAKICAgICAg
PyB0cmFuc2l0aW9uVGltZW91dCA+IGFuaW1hdGlvblRpbWVvdXQKICAgICAgICA/IFRSQU5TSVRJ
T04KICAgICAgICA6IEFOSU1BVElPTgogICAgICA6IG51bGw7CiAgICBwcm9wQ291bnQgPSB0eXBl
CiAgICAgID8gdHlwZSA9PT0gVFJBTlNJVElPTgogICAgICAgID8gdHJhbnNpdGlvbkR1cmF0aW9u
cy5sZW5ndGgKICAgICAgICA6IGFuaW1hdGlvbkR1cmF0aW9ucy5sZW5ndGgKICAgICAgOiAwOwog
IH0KICB2YXIgaGFzVHJhbnNmb3JtID0KICAgIHR5cGUgPT09IFRSQU5TSVRJT04gJiYKICAgIHRy
YW5zZm9ybVJFLnRlc3Qoc3R5bGVzW3RyYW5zaXRpb25Qcm9wICsgJ1Byb3BlcnR5J10pOwogIHJl
dHVybiB7CiAgICB0eXBlOiB0eXBlLAogICAgdGltZW91dDogdGltZW91dCwKICAgIHByb3BDb3Vu
dDogcHJvcENvdW50LAogICAgaGFzVHJhbnNmb3JtOiBoYXNUcmFuc2Zvcm0KICB9Cn0KCmZ1bmN0
aW9uIGdldFRpbWVvdXQgKGRlbGF5cywgZHVyYXRpb25zKSB7CiAgLyogaXN0YW5idWwgaWdub3Jl
IG5leHQgKi8KICB3aGlsZSAoZGVsYXlzLmxlbmd0aCA8IGR1cmF0aW9ucy5sZW5ndGgpIHsKICAg
IGRlbGF5cyA9IGRlbGF5cy5jb25jYXQoZGVsYXlzKTsKICB9CgogIHJldHVybiBNYXRoLm1heC5h
cHBseShudWxsLCBkdXJhdGlvbnMubWFwKGZ1bmN0aW9uIChkLCBpKSB7CiAgICByZXR1cm4gdG9N
cyhkKSArIHRvTXMoZGVsYXlzW2ldKQogIH0pKQp9CgpmdW5jdGlvbiB0b01zIChzKSB7CiAgcmV0
dXJuIE51bWJlcihzLnNsaWNlKDAsIC0xKSkgKiAxMDAwCn0KCi8qICAqLwoKZnVuY3Rpb24gZW50
ZXIgKHZub2RlLCB0b2dnbGVEaXNwbGF5KSB7CiAgdmFyIGVsID0gdm5vZGUuZWxtOwoKICAvLyBj
YWxsIGxlYXZlIGNhbGxiYWNrIG5vdwogIGlmIChlbC5fbGVhdmVDYikgewogICAgZWwuX2xlYXZl
Q2IuY2FuY2VsbGVkID0gdHJ1ZTsKICAgIGVsLl9sZWF2ZUNiKCk7CiAgfQoKICB2YXIgZGF0YSA9
IHJlc29sdmVUcmFuc2l0aW9uKHZub2RlLmRhdGEudHJhbnNpdGlvbik7CiAgaWYgKCFkYXRhKSB7
CiAgICByZXR1cm4KICB9CgogIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogIGlmIChlbC5fZW50
ZXJDYiB8fCBlbC5ub2RlVHlwZSAhPT0gMSkgewogICAgcmV0dXJuCiAgfQoKICB2YXIgY3NzID0g
ZGF0YS5jc3M7CiAgdmFyIHR5cGUgPSBkYXRhLnR5cGU7CiAgdmFyIGVudGVyQ2xhc3MgPSBkYXRh
LmVudGVyQ2xhc3M7CiAgdmFyIGVudGVyQWN0aXZlQ2xhc3MgPSBkYXRhLmVudGVyQWN0aXZlQ2xh
c3M7CiAgdmFyIGFwcGVhckNsYXNzID0gZGF0YS5hcHBlYXJDbGFzczsKICB2YXIgYXBwZWFyQWN0
aXZlQ2xhc3MgPSBkYXRhLmFwcGVhckFjdGl2ZUNsYXNzOwogIHZhciBiZWZvcmVFbnRlciA9IGRh
dGEuYmVmb3JlRW50ZXI7CiAgdmFyIGVudGVyID0gZGF0YS5lbnRlcjsKICB2YXIgYWZ0ZXJFbnRl
ciA9IGRhdGEuYWZ0ZXJFbnRlcjsKICB2YXIgZW50ZXJDYW5jZWxsZWQgPSBkYXRhLmVudGVyQ2Fu
Y2VsbGVkOwogIHZhciBiZWZvcmVBcHBlYXIgPSBkYXRhLmJlZm9yZUFwcGVhcjsKICB2YXIgYXBw
ZWFyID0gZGF0YS5hcHBlYXI7CiAgdmFyIGFmdGVyQXBwZWFyID0gZGF0YS5hZnRlckFwcGVhcjsK
ICB2YXIgYXBwZWFyQ2FuY2VsbGVkID0gZGF0YS5hcHBlYXJDYW5jZWxsZWQ7CgogIC8vIGFjdGl2
ZUluc3RhbmNlIHdpbGwgYWx3YXlzIGJlIHRoZSA8dHJhbnNpdGlvbj4gY29tcG9uZW50IG1hbmFn
aW5nIHRoaXMKICAvLyB0cmFuc2l0aW9uLiBPbmUgZWRnZSBjYXNlIHRvIGNoZWNrIGlzIHdoZW4g
dGhlIDx0cmFuc2l0aW9uPiBpcyBwbGFjZWQKICAvLyBhcyB0aGUgcm9vdCBub2RlIG9mIGEgY2hp
bGQgY29tcG9uZW50LiBJbiB0aGF0IGNhc2Ugd2UgbmVlZCB0byBjaGVjawogIC8vIDx0cmFuc2l0
aW9uPidzIHBhcmVudCBmb3IgYXBwZWFyIGNoZWNrLgogIHZhciBjb250ZXh0ID0gYWN0aXZlSW5z
dGFuY2U7CiAgdmFyIHRyYW5zaXRpb25Ob2RlID0gYWN0aXZlSW5zdGFuY2UuJHZub2RlOwogIHdo
aWxlICh0cmFuc2l0aW9uTm9kZSAmJiB0cmFuc2l0aW9uTm9kZS5wYXJlbnQpIHsKICAgIHRyYW5z
aXRpb25Ob2RlID0gdHJhbnNpdGlvbk5vZGUucGFyZW50OwogICAgY29udGV4dCA9IHRyYW5zaXRp
b25Ob2RlLmNvbnRleHQ7CiAgfQoKICB2YXIgaXNBcHBlYXIgPSAhY29udGV4dC5faXNNb3VudGVk
IHx8ICF2bm9kZS5pc1Jvb3RJbnNlcnQ7CgogIGlmIChpc0FwcGVhciAmJiAhYXBwZWFyICYmIGFw
cGVhciAhPT0gJycpIHsKICAgIHJldHVybgogIH0KCiAgdmFyIHN0YXJ0Q2xhc3MgPSBpc0FwcGVh
ciA/IGFwcGVhckNsYXNzIDogZW50ZXJDbGFzczsKICB2YXIgYWN0aXZlQ2xhc3MgPSBpc0FwcGVh
ciA/IGFwcGVhckFjdGl2ZUNsYXNzIDogZW50ZXJBY3RpdmVDbGFzczsKICB2YXIgYmVmb3JlRW50
ZXJIb29rID0gaXNBcHBlYXIgPyAoYmVmb3JlQXBwZWFyIHx8IGJlZm9yZUVudGVyKSA6IGJlZm9y
ZUVudGVyOwogIHZhciBlbnRlckhvb2sgPSBpc0FwcGVhciA/ICh0eXBlb2YgYXBwZWFyID09PSAn
ZnVuY3Rpb24nID8gYXBwZWFyIDogZW50ZXIpIDogZW50ZXI7CiAgdmFyIGFmdGVyRW50ZXJIb29r
ID0gaXNBcHBlYXIgPyAoYWZ0ZXJBcHBlYXIgfHwgYWZ0ZXJFbnRlcikgOiBhZnRlckVudGVyOwog
IHZhciBlbnRlckNhbmNlbGxlZEhvb2sgPSBpc0FwcGVhciA/IChhcHBlYXJDYW5jZWxsZWQgfHwg
ZW50ZXJDYW5jZWxsZWQpIDogZW50ZXJDYW5jZWxsZWQ7CgogIHZhciBleHBlY3RzQ1NTID0gY3Nz
ICE9PSBmYWxzZSAmJiAhaXNJRTk7CiAgdmFyIHVzZXJXYW50c0NvbnRyb2wgPQogICAgZW50ZXJI
b29rICYmCiAgICAvLyBlbnRlckhvb2sgbWF5IGJlIGEgYm91bmQgbWV0aG9kIHdoaWNoIGV4cG9z
ZXMKICAgIC8vIHRoZSBsZW5ndGggb2Ygb3JpZ2luYWwgZm4gYXMgX2xlbmd0aAogICAgKGVudGVy
SG9vay5fbGVuZ3RoIHx8IGVudGVySG9vay5sZW5ndGgpID4gMTsKCiAgdmFyIGNiID0gZWwuX2Vu
dGVyQ2IgPSBvbmNlKGZ1bmN0aW9uICgpIHsKICAgIGlmIChleHBlY3RzQ1NTKSB7CiAgICAgIHJl
bW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgYWN0aXZlQ2xhc3MpOwogICAgfQogICAgaWYgKGNiLmNh
bmNlbGxlZCkgewogICAgICBpZiAoZXhwZWN0c0NTUykgewogICAgICAgIHJlbW92ZVRyYW5zaXRp
b25DbGFzcyhlbCwgc3RhcnRDbGFzcyk7CiAgICAgIH0KICAgICAgZW50ZXJDYW5jZWxsZWRIb29r
ICYmIGVudGVyQ2FuY2VsbGVkSG9vayhlbCk7CiAgICB9IGVsc2UgewogICAgICBhZnRlckVudGVy
SG9vayAmJiBhZnRlckVudGVySG9vayhlbCk7CiAgICB9CiAgICBlbC5fZW50ZXJDYiA9IG51bGw7
CiAgfSk7CgogIGlmICghdm5vZGUuZGF0YS5zaG93KSB7CiAgICAvLyByZW1vdmUgcGVuZGluZyBs
ZWF2ZSBlbGVtZW50IG9uIGVudGVyIGJ5IGluamVjdGluZyBhbiBpbnNlcnQgaG9vawogICAgbWVy
Z2VWTm9kZUhvb2sodm5vZGUuZGF0YS5ob29rIHx8ICh2bm9kZS5kYXRhLmhvb2sgPSB7fSksICdp
bnNlcnQnLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBwYXJlbnQgPSBlbC5wYXJlbnROb2RlOwog
ICAgICB2YXIgcGVuZGluZ05vZGUgPSBwYXJlbnQgJiYgcGFyZW50Ll9wZW5kaW5nICYmIHBhcmVu
dC5fcGVuZGluZ1t2bm9kZS5rZXldOwogICAgICBpZiAocGVuZGluZ05vZGUgJiYKICAgICAgICAg
IHBlbmRpbmdOb2RlLmNvbnRleHQgPT09IHZub2RlLmNvbnRleHQgJiYKICAgICAgICAgIHBlbmRp
bmdOb2RlLnRhZyA9PT0gdm5vZGUudGFnICYmCiAgICAgICAgICBwZW5kaW5nTm9kZS5lbG0uX2xl
YXZlQ2IpIHsKICAgICAgICBwZW5kaW5nTm9kZS5lbG0uX2xlYXZlQ2IoKTsKICAgICAgfQogICAg
ICBlbnRlckhvb2sgJiYgZW50ZXJIb29rKGVsLCBjYik7CiAgICB9LCAndHJhbnNpdGlvbi1pbnNl
cnQnKTsKICB9CgogIC8vIHN0YXJ0IGVudGVyIHRyYW5zaXRpb24KICBiZWZvcmVFbnRlckhvb2sg
JiYgYmVmb3JlRW50ZXJIb29rKGVsKTsKICBpZiAoZXhwZWN0c0NTUykgewogICAgYWRkVHJhbnNp
dGlvbkNsYXNzKGVsLCBzdGFydENsYXNzKTsKICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgYWN0
aXZlQ2xhc3MpOwogICAgbmV4dEZyYW1lKGZ1bmN0aW9uICgpIHsKICAgICAgcmVtb3ZlVHJhbnNp
dGlvbkNsYXNzKGVsLCBzdGFydENsYXNzKTsKICAgICAgaWYgKCFjYi5jYW5jZWxsZWQgJiYgIXVz
ZXJXYW50c0NvbnRyb2wpIHsKICAgICAgICB3aGVuVHJhbnNpdGlvbkVuZHMoZWwsIHR5cGUsIGNi
KTsKICAgICAgfQogICAgfSk7CiAgfQoKICBpZiAodm5vZGUuZGF0YS5zaG93KSB7CiAgICB0b2dn
bGVEaXNwbGF5ICYmIHRvZ2dsZURpc3BsYXkoKTsKICAgIGVudGVySG9vayAmJiBlbnRlckhvb2so
ZWwsIGNiKTsKICB9CgogIGlmICghZXhwZWN0c0NTUyAmJiAhdXNlcldhbnRzQ29udHJvbCkgewog
ICAgY2IoKTsKICB9Cn0KCmZ1bmN0aW9uIGxlYXZlICh2bm9kZSwgcm0pIHsKICB2YXIgZWwgPSB2
bm9kZS5lbG07CgogIC8vIGNhbGwgZW50ZXIgY2FsbGJhY2sgbm93CiAgaWYgKGVsLl9lbnRlckNi
KSB7CiAgICBlbC5fZW50ZXJDYi5jYW5jZWxsZWQgPSB0cnVlOwogICAgZWwuX2VudGVyQ2IoKTsK
ICB9CgogIHZhciBkYXRhID0gcmVzb2x2ZVRyYW5zaXRpb24odm5vZGUuZGF0YS50cmFuc2l0aW9u
KTsKICBpZiAoIWRhdGEpIHsKICAgIHJldHVybiBybSgpCiAgfQoKICAvKiBpc3RhbmJ1bCBpZ25v
cmUgaWYgKi8KICBpZiAoZWwuX2xlYXZlQ2IgfHwgZWwubm9kZVR5cGUgIT09IDEpIHsKICAgIHJl
dHVybgogIH0KCiAgdmFyIGNzcyA9IGRhdGEuY3NzOwogIHZhciB0eXBlID0gZGF0YS50eXBlOwog
IHZhciBsZWF2ZUNsYXNzID0gZGF0YS5sZWF2ZUNsYXNzOwogIHZhciBsZWF2ZUFjdGl2ZUNsYXNz
ID0gZGF0YS5sZWF2ZUFjdGl2ZUNsYXNzOwogIHZhciBiZWZvcmVMZWF2ZSA9IGRhdGEuYmVmb3Jl
TGVhdmU7CiAgdmFyIGxlYXZlID0gZGF0YS5sZWF2ZTsKICB2YXIgYWZ0ZXJMZWF2ZSA9IGRhdGEu
YWZ0ZXJMZWF2ZTsKICB2YXIgbGVhdmVDYW5jZWxsZWQgPSBkYXRhLmxlYXZlQ2FuY2VsbGVkOwog
IHZhciBkZWxheUxlYXZlID0gZGF0YS5kZWxheUxlYXZlOwoKICB2YXIgZXhwZWN0c0NTUyA9IGNz
cyAhPT0gZmFsc2UgJiYgIWlzSUU5OwogIHZhciB1c2VyV2FudHNDb250cm9sID0KICAgIGxlYXZl
ICYmCiAgICAvLyBsZWF2ZSBob29rIG1heSBiZSBhIGJvdW5kIG1ldGhvZCB3aGljaCBleHBvc2Vz
CiAgICAvLyB0aGUgbGVuZ3RoIG9mIG9yaWdpbmFsIGZuIGFzIF9sZW5ndGgKICAgIChsZWF2ZS5f
bGVuZ3RoIHx8IGxlYXZlLmxlbmd0aCkgPiAxOwoKICB2YXIgY2IgPSBlbC5fbGVhdmVDYiA9IG9u
Y2UoZnVuY3Rpb24gKCkgewogICAgaWYgKGVsLnBhcmVudE5vZGUgJiYgZWwucGFyZW50Tm9kZS5f
cGVuZGluZykgewogICAgICBlbC5wYXJlbnROb2RlLl9wZW5kaW5nW3Zub2RlLmtleV0gPSBudWxs
OwogICAgfQogICAgaWYgKGV4cGVjdHNDU1MpIHsKICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNz
KGVsLCBsZWF2ZUFjdGl2ZUNsYXNzKTsKICAgIH0KICAgIGlmIChjYi5jYW5jZWxsZWQpIHsKICAg
ICAgaWYgKGV4cGVjdHNDU1MpIHsKICAgICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWwsIGxl
YXZlQ2xhc3MpOwogICAgICB9CiAgICAgIGxlYXZlQ2FuY2VsbGVkICYmIGxlYXZlQ2FuY2VsbGVk
KGVsKTsKICAgIH0gZWxzZSB7CiAgICAgIHJtKCk7CiAgICAgIGFmdGVyTGVhdmUgJiYgYWZ0ZXJM
ZWF2ZShlbCk7CiAgICB9CiAgICBlbC5fbGVhdmVDYiA9IG51bGw7CiAgfSk7CgogIGlmIChkZWxh
eUxlYXZlKSB7CiAgICBkZWxheUxlYXZlKHBlcmZvcm1MZWF2ZSk7CiAgfSBlbHNlIHsKICAgIHBl
cmZvcm1MZWF2ZSgpOwogIH0KCiAgZnVuY3Rpb24gcGVyZm9ybUxlYXZlICgpIHsKICAgIC8vIHRo
ZSBkZWxheWVkIGxlYXZlIG1heSBoYXZlIGFscmVhZHkgYmVlbiBjYW5jZWxsZWQKICAgIGlmIChj
Yi5jYW5jZWxsZWQpIHsKICAgICAgcmV0dXJuCiAgICB9CiAgICAvLyByZWNvcmQgbGVhdmluZyBl
bGVtZW50CiAgICBpZiAoIXZub2RlLmRhdGEuc2hvdykgewogICAgICAoZWwucGFyZW50Tm9kZS5f
cGVuZGluZyB8fCAoZWwucGFyZW50Tm9kZS5fcGVuZGluZyA9IHt9KSlbdm5vZGUua2V5XSA9IHZu
b2RlOwogICAgfQogICAgYmVmb3JlTGVhdmUgJiYgYmVmb3JlTGVhdmUoZWwpOwogICAgaWYgKGV4
cGVjdHNDU1MpIHsKICAgICAgYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCBsZWF2ZUNsYXNzKTsKICAg
ICAgYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCBsZWF2ZUFjdGl2ZUNsYXNzKTsKICAgICAgbmV4dEZy
YW1lKGZ1bmN0aW9uICgpIHsKICAgICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWwsIGxlYXZl
Q2xhc3MpOwogICAgICAgIGlmICghY2IuY2FuY2VsbGVkICYmICF1c2VyV2FudHNDb250cm9sKSB7
CiAgICAgICAgICB3aGVuVHJhbnNpdGlvbkVuZHMoZWwsIHR5cGUsIGNiKTsKICAgICAgICB9CiAg
ICAgIH0pOwogICAgfQogICAgbGVhdmUgJiYgbGVhdmUoZWwsIGNiKTsKICAgIGlmICghZXhwZWN0
c0NTUyAmJiAhdXNlcldhbnRzQ29udHJvbCkgewogICAgICBjYigpOwogICAgfQogIH0KfQoKZnVu
Y3Rpb24gcmVzb2x2ZVRyYW5zaXRpb24gKGRlZiQkMSkgewogIGlmICghZGVmJCQxKSB7CiAgICBy
ZXR1cm4KICB9CiAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KICBpZiAodHlwZW9mIGRlZiQk
MSA9PT0gJ29iamVjdCcpIHsKICAgIHZhciByZXMgPSB7fTsKICAgIGlmIChkZWYkJDEuY3NzICE9
PSBmYWxzZSkgewogICAgICBleHRlbmQocmVzLCBhdXRvQ3NzVHJhbnNpdGlvbihkZWYkJDEubmFt
ZSB8fCAndicpKTsKICAgIH0KICAgIGV4dGVuZChyZXMsIGRlZiQkMSk7CiAgICByZXR1cm4gcmVz
CiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmJCQxID09PSAnc3RyaW5nJykgewogICAgcmV0dXJuIGF1
dG9Dc3NUcmFuc2l0aW9uKGRlZiQkMSkKICB9Cn0KCnZhciBhdXRvQ3NzVHJhbnNpdGlvbiA9IGNh
Y2hlZChmdW5jdGlvbiAobmFtZSkgewogIHJldHVybiB7CiAgICBlbnRlckNsYXNzOiAobmFtZSAr
ICItZW50ZXIiKSwKICAgIGxlYXZlQ2xhc3M6IChuYW1lICsgIi1sZWF2ZSIpLAogICAgYXBwZWFy
Q2xhc3M6IChuYW1lICsgIi1lbnRlciIpLAogICAgZW50ZXJBY3RpdmVDbGFzczogKG5hbWUgKyAi
LWVudGVyLWFjdGl2ZSIpLAogICAgbGVhdmVBY3RpdmVDbGFzczogKG5hbWUgKyAiLWxlYXZlLWFj
dGl2ZSIpLAogICAgYXBwZWFyQWN0aXZlQ2xhc3M6IChuYW1lICsgIi1lbnRlci1hY3RpdmUiKQog
IH0KfSk7CgpmdW5jdGlvbiBvbmNlIChmbikgewogIHZhciBjYWxsZWQgPSBmYWxzZTsKICByZXR1
cm4gZnVuY3Rpb24gKCkgewogICAgaWYgKCFjYWxsZWQpIHsKICAgICAgY2FsbGVkID0gdHJ1ZTsK
ICAgICAgZm4oKTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIF9lbnRlciAoXywgdm5vZGUpIHsKICBp
ZiAoIXZub2RlLmRhdGEuc2hvdykgewogICAgZW50ZXIodm5vZGUpOwogIH0KfQoKdmFyIHRyYW5z
aXRpb24gPSBpbkJyb3dzZXIgPyB7CiAgY3JlYXRlOiBfZW50ZXIsCiAgYWN0aXZhdGU6IF9lbnRl
ciwKICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSAodm5vZGUsIHJtKSB7CiAgICAvKiBpc3RhbmJ1
bCBpZ25vcmUgZWxzZSAqLwogICAgaWYgKCF2bm9kZS5kYXRhLnNob3cpIHsKICAgICAgbGVhdmUo
dm5vZGUsIHJtKTsKICAgIH0gZWxzZSB7CiAgICAgIHJtKCk7CiAgICB9CiAgfQp9IDoge307Cgp2
YXIgcGxhdGZvcm1Nb2R1bGVzID0gWwogIGF0dHJzLAogIGtsYXNzLAogIGV2ZW50cywKICBkb21Q
cm9wcywKICBzdHlsZSwKICB0cmFuc2l0aW9uCl07CgovKiAgKi8KCi8vIHRoZSBkaXJlY3RpdmUg
bW9kdWxlIHNob3VsZCBiZSBhcHBsaWVkIGxhc3QsIGFmdGVyIGFsbAovLyBidWlsdC1pbiBtb2R1
bGVzIGhhdmUgYmVlbiBhcHBsaWVkLgp2YXIgbW9kdWxlcyA9IHBsYXRmb3JtTW9kdWxlcy5jb25j
YXQoYmFzZU1vZHVsZXMpOwoKdmFyIHBhdGNoJDEgPSBjcmVhdGVQYXRjaEZ1bmN0aW9uKHsgbm9k
ZU9wczogbm9kZU9wcywgbW9kdWxlczogbW9kdWxlcyB9KTsKCi8qKgogKiBOb3QgdHlwZSBjaGVj
a2luZyB0aGlzIGZpbGUgYmVjYXVzZSBmbG93IGRvZXNuJ3QgbGlrZSBhdHRhY2hpbmcKICogcHJv
cGVydGllcyB0byBFbGVtZW50cy4KICovCgp2YXIgbW9kZWxhYmxlVGFnUkUgPSAvXmlucHV0fHNl
bGVjdHx0ZXh0YXJlYXx2dWUtY29tcG9uZW50LVswLTldKygtWzAtOWEtekEtWl8tXSopPyQvOwoK
LyogaXN0YW5idWwgaWdub3JlIGlmICovCmlmIChpc0lFOSkgewogIC8vIGh0dHA6Ly93d3cubWF0
dHM0MTEuY29tL3Bvc3QvaW50ZXJuZXQtZXhwbG9yZXItOS1vbmlucHV0LwogIGRvY3VtZW50LmFk
ZEV2ZW50TGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsIGZ1bmN0aW9uICgpIHsKICAgIHZhciBl
bCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7CiAgICBpZiAoZWwgJiYgZWwudm1vZGVsKSB7CiAg
ICAgIHRyaWdnZXIoZWwsICdpbnB1dCcpOwogICAgfQogIH0pOwp9Cgp2YXIgbW9kZWwgPSB7CiAg
aW5zZXJ0ZWQ6IGZ1bmN0aW9uIGluc2VydGVkIChlbCwgYmluZGluZywgdm5vZGUpIHsKICAgIHsK
ICAgICAgaWYgKCFtb2RlbGFibGVUYWdSRS50ZXN0KHZub2RlLnRhZykpIHsKICAgICAgICB3YXJu
KAogICAgICAgICAgInYtbW9kZWwgaXMgbm90IHN1cHBvcnRlZCBvbiBlbGVtZW50IHR5cGU6IDwi
ICsgKHZub2RlLnRhZykgKyAiPi4gIiArCiAgICAgICAgICAnSWYgeW91IGFyZSB3b3JraW5nIHdp
dGggY29udGVudGVkaXRhYmxlLCBpdFwncyByZWNvbW1lbmRlZCB0byAnICsKICAgICAgICAgICd3
cmFwIGEgbGlicmFyeSBkZWRpY2F0ZWQgZm9yIHRoYXQgcHVycG9zZSBpbnNpZGUgYSBjdXN0b20g
Y29tcG9uZW50LicsCiAgICAgICAgICB2bm9kZS5jb250ZXh0CiAgICAgICAgKTsKICAgICAgfQog
ICAgfQogICAgaWYgKHZub2RlLnRhZyA9PT0gJ3NlbGVjdCcpIHsKICAgICAgdmFyIGNiID0gZnVu
Y3Rpb24gKCkgewogICAgICAgIHNldFNlbGVjdGVkKGVsLCBiaW5kaW5nLCB2bm9kZS5jb250ZXh0
KTsKICAgICAgfTsKICAgICAgY2IoKTsKICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAg
ICAgIGlmIChpc0lFIHx8IGlzRWRnZSkgewogICAgICAgIHNldFRpbWVvdXQoY2IsIDApOwogICAg
ICB9CiAgICB9IGVsc2UgaWYgKHZub2RlLnRhZyA9PT0gJ3RleHRhcmVhJyB8fCBlbC50eXBlID09
PSAndGV4dCcpIHsKICAgICAgZWwuX3ZNb2RpZmllcnMgPSBiaW5kaW5nLm1vZGlmaWVyczsKICAg
ICAgaWYgKCFiaW5kaW5nLm1vZGlmaWVycy5sYXp5KSB7CiAgICAgICAgaWYgKCFpc0FuZHJvaWQp
IHsKICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbXBvc2l0aW9uc3RhcnQnLCBvbkNv
bXBvc2l0aW9uU3RhcnQpOwogICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY29tcG9zaXRp
b25lbmQnLCBvbkNvbXBvc2l0aW9uRW5kKTsKICAgICAgICB9CiAgICAgICAgLyogaXN0YW5idWwg
aWdub3JlIGlmICovCiAgICAgICAgaWYgKGlzSUU5KSB7CiAgICAgICAgICBlbC52bW9kZWwgPSB0
cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCiAgY29tcG9uZW50VXBkYXRlZDogZnVu
Y3Rpb24gY29tcG9uZW50VXBkYXRlZCAoZWwsIGJpbmRpbmcsIHZub2RlKSB7CiAgICBpZiAodm5v
ZGUudGFnID09PSAnc2VsZWN0JykgewogICAgICBzZXRTZWxlY3RlZChlbCwgYmluZGluZywgdm5v
ZGUuY29udGV4dCk7CiAgICAgIC8vIGluIGNhc2UgdGhlIG9wdGlvbnMgcmVuZGVyZWQgYnkgdi1m
b3IgaGF2ZSBjaGFuZ2VkLAogICAgICAvLyBpdCdzIHBvc3NpYmxlIHRoYXQgdGhlIHZhbHVlIGlz
IG91dC1vZi1zeW5jIHdpdGggdGhlIHJlbmRlcmVkIG9wdGlvbnMuCiAgICAgIC8vIGRldGVjdCBz
dWNoIGNhc2VzIGFuZCBmaWx0ZXIgb3V0IHZhbHVlcyB0aGF0IG5vIGxvbmdlciBoYXMgYSBtYXRj
aGluZwogICAgICAvLyBvcHRpb24gaW4gdGhlIERPTS4KICAgICAgdmFyIG5lZWRSZXNldCA9IGVs
Lm11bHRpcGxlCiAgICAgICAgPyBiaW5kaW5nLnZhbHVlLnNvbWUoZnVuY3Rpb24gKHYpIHsgcmV0
dXJuIGhhc05vTWF0Y2hpbmdPcHRpb24odiwgZWwub3B0aW9ucyk7IH0pCiAgICAgICAgOiBiaW5k
aW5nLnZhbHVlICE9PSBiaW5kaW5nLm9sZFZhbHVlICYmIGhhc05vTWF0Y2hpbmdPcHRpb24oYmlu
ZGluZy52YWx1ZSwgZWwub3B0aW9ucyk7CiAgICAgIGlmIChuZWVkUmVzZXQpIHsKICAgICAgICB0
cmlnZ2VyKGVsLCAnY2hhbmdlJyk7CiAgICAgIH0KICAgIH0KICB9Cn07CgpmdW5jdGlvbiBzZXRT
ZWxlY3RlZCAoZWwsIGJpbmRpbmcsIHZtKSB7CiAgdmFyIHZhbHVlID0gYmluZGluZy52YWx1ZTsK
ICB2YXIgaXNNdWx0aXBsZSA9IGVsLm11bHRpcGxlOwogIGlmIChpc011bHRpcGxlICYmICFBcnJh
eS5pc0FycmF5KHZhbHVlKSkgewogICAgImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYm
IHdhcm4oCiAgICAgICI8c2VsZWN0IG11bHRpcGxlIHYtbW9kZWw9XCIiICsgKGJpbmRpbmcuZXhw
cmVzc2lvbikgKyAiXCI+ICIgKwogICAgICAiZXhwZWN0cyBhbiBBcnJheSB2YWx1ZSBmb3IgaXRz
IGJpbmRpbmcsIGJ1dCBnb3QgIiArIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFs
dWUpLnNsaWNlKDgsIC0xKSksCiAgICAgIHZtCiAgICApOwogICAgcmV0dXJuCiAgfQogIHZhciBz
ZWxlY3RlZCwgb3B0aW9uOwogIGZvciAodmFyIGkgPSAwLCBsID0gZWwub3B0aW9ucy5sZW5ndGg7
IGkgPCBsOyBpKyspIHsKICAgIG9wdGlvbiA9IGVsLm9wdGlvbnNbaV07CiAgICBpZiAoaXNNdWx0
aXBsZSkgewogICAgICBzZWxlY3RlZCA9IGxvb3NlSW5kZXhPZih2YWx1ZSwgZ2V0VmFsdWUob3B0
aW9uKSkgPiAtMTsKICAgICAgaWYgKG9wdGlvbi5zZWxlY3RlZCAhPT0gc2VsZWN0ZWQpIHsKICAg
ICAgICBvcHRpb24uc2VsZWN0ZWQgPSBzZWxlY3RlZDsKICAgICAgfQogICAgfSBlbHNlIHsKICAg
ICAgaWYgKGxvb3NlRXF1YWwoZ2V0VmFsdWUob3B0aW9uKSwgdmFsdWUpKSB7CiAgICAgICAgaWYg
KGVsLnNlbGVjdGVkSW5kZXggIT09IGkpIHsKICAgICAgICAgIGVsLnNlbGVjdGVkSW5kZXggPSBp
OwogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgICAgfQogICAgfQogIH0KICBpZiAoIWlzTXVs
dGlwbGUpIHsKICAgIGVsLnNlbGVjdGVkSW5kZXggPSAtMTsKICB9Cn0KCmZ1bmN0aW9uIGhhc05v
TWF0Y2hpbmdPcHRpb24gKHZhbHVlLCBvcHRpb25zKSB7CiAgZm9yICh2YXIgaSA9IDAsIGwgPSBv
cHRpb25zLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgaWYgKGxvb3NlRXF1YWwoZ2V0VmFsdWUo
b3B0aW9uc1tpXSksIHZhbHVlKSkgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KICB9CiAgcmV0
dXJuIHRydWUKfQoKZnVuY3Rpb24gZ2V0VmFsdWUgKG9wdGlvbikgewogIHJldHVybiAnX3ZhbHVl
JyBpbiBvcHRpb24KICAgID8gb3B0aW9uLl92YWx1ZQogICAgOiBvcHRpb24udmFsdWUKfQoKZnVu
Y3Rpb24gb25Db21wb3NpdGlvblN0YXJ0IChlKSB7CiAgZS50YXJnZXQuY29tcG9zaW5nID0gdHJ1
ZTsKfQoKZnVuY3Rpb24gb25Db21wb3NpdGlvbkVuZCAoZSkgewogIGUudGFyZ2V0LmNvbXBvc2lu
ZyA9IGZhbHNlOwogIHRyaWdnZXIoZS50YXJnZXQsICdpbnB1dCcpOwp9CgpmdW5jdGlvbiB0cmln
Z2VyIChlbCwgdHlwZSkgewogIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVu
dHMnKTsKICBlLmluaXRFdmVudCh0eXBlLCB0cnVlLCB0cnVlKTsKICBlbC5kaXNwYXRjaEV2ZW50
KGUpOwp9CgovKiAgKi8KCi8vIHJlY3Vyc2l2ZWx5IHNlYXJjaCBmb3IgcG9zc2libGUgdHJhbnNp
dGlvbiBkZWZpbmVkIGluc2lkZSB0aGUgY29tcG9uZW50IHJvb3QKZnVuY3Rpb24gbG9jYXRlTm9k
ZSAodm5vZGUpIHsKICByZXR1cm4gdm5vZGUuY2hpbGQgJiYgKCF2bm9kZS5kYXRhIHx8ICF2bm9k
ZS5kYXRhLnRyYW5zaXRpb24pCiAgICA/IGxvY2F0ZU5vZGUodm5vZGUuY2hpbGQuX3Zub2RlKQog
ICAgOiB2bm9kZQp9Cgp2YXIgc2hvdyA9IHsKICBiaW5kOiBmdW5jdGlvbiBiaW5kIChlbCwgcmVm
LCB2bm9kZSkgewogICAgdmFyIHZhbHVlID0gcmVmLnZhbHVlOwoKICAgIHZub2RlID0gbG9jYXRl
Tm9kZSh2bm9kZSk7CiAgICB2YXIgdHJhbnNpdGlvbiA9IHZub2RlLmRhdGEgJiYgdm5vZGUuZGF0
YS50cmFuc2l0aW9uOwogICAgdmFyIG9yaWdpbmFsRGlzcGxheSA9IGVsLl9fdk9yaWdpbmFsRGlz
cGxheSA9CiAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJyA/ICcnIDogZWwuc3R5bGUu
ZGlzcGxheTsKICAgIGlmICh2YWx1ZSAmJiB0cmFuc2l0aW9uICYmICFpc0lFOSkgewogICAgICB2
bm9kZS5kYXRhLnNob3cgPSB0cnVlOwogICAgICBlbnRlcih2bm9kZSwgZnVuY3Rpb24gKCkgewog
ICAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPSBvcmlnaW5hbERpc3BsYXk7CiAgICAgIH0pOwogICAg
fSBlbHNlIHsKICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IHZhbHVlID8gb3JpZ2luYWxEaXNwbGF5
IDogJ25vbmUnOwogICAgfQogIH0sCiAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUgKGVsLCByZWYs
IHZub2RlKSB7CiAgICB2YXIgdmFsdWUgPSByZWYudmFsdWU7CiAgICB2YXIgb2xkVmFsdWUgPSBy
ZWYub2xkVmFsdWU7CgogICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgICBpZiAodmFsdWUg
PT09IG9sZFZhbHVlKSB7IHJldHVybiB9CiAgICB2bm9kZSA9IGxvY2F0ZU5vZGUodm5vZGUpOwog
ICAgdmFyIHRyYW5zaXRpb24gPSB2bm9kZS5kYXRhICYmIHZub2RlLmRhdGEudHJhbnNpdGlvbjsK
ICAgIGlmICh0cmFuc2l0aW9uICYmICFpc0lFOSkgewogICAgICB2bm9kZS5kYXRhLnNob3cgPSB0
cnVlOwogICAgICBpZiAodmFsdWUpIHsKICAgICAgICBlbnRlcih2bm9kZSwgZnVuY3Rpb24gKCkg
ewogICAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IGVsLl9fdk9yaWdpbmFsRGlzcGxheTsKICAg
ICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsZWF2ZSh2bm9kZSwgZnVuY3Rpb24gKCkg
ewogICAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICB9KTsKICAgICAg
fQogICAgfSBlbHNlIHsKICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IHZhbHVlID8gZWwuX192T3Jp
Z2luYWxEaXNwbGF5IDogJ25vbmUnOwogICAgfQogIH0KfTsKCnZhciBwbGF0Zm9ybURpcmVjdGl2
ZXMgPSB7CiAgbW9kZWw6IG1vZGVsLAogIHNob3c6IHNob3cKfTsKCi8qICAqLwoKLy8gUHJvdmlk
ZXMgdHJhbnNpdGlvbiBzdXBwb3J0IGZvciBhIHNpbmdsZSBlbGVtZW50L2NvbXBvbmVudC4KLy8g
c3VwcG9ydHMgdHJhbnNpdGlvbiBtb2RlIChvdXQtaW4gLyBpbi1vdXQpCgp2YXIgdHJhbnNpdGlv
blByb3BzID0gewogIG5hbWU6IFN0cmluZywKICBhcHBlYXI6IEJvb2xlYW4sCiAgY3NzOiBCb29s
ZWFuLAogIG1vZGU6IFN0cmluZywKICB0eXBlOiBTdHJpbmcsCiAgZW50ZXJDbGFzczogU3RyaW5n
LAogIGxlYXZlQ2xhc3M6IFN0cmluZywKICBlbnRlckFjdGl2ZUNsYXNzOiBTdHJpbmcsCiAgbGVh
dmVBY3RpdmVDbGFzczogU3RyaW5nLAogIGFwcGVhckNsYXNzOiBTdHJpbmcsCiAgYXBwZWFyQWN0
aXZlQ2xhc3M6IFN0cmluZwp9OwoKLy8gaW4gY2FzZSB0aGUgY2hpbGQgaXMgYWxzbyBhbiBhYnN0
cmFjdCBjb21wb25lbnQsIGUuZy4gPGtlZXAtYWxpdmU+Ci8vIHdlIHdhbnQgdG8gcmVjdXJzaXZl
bHkgcmV0cmlldmUgdGhlIHJlYWwgY29tcG9uZW50IHRvIGJlIHJlbmRlcmVkCmZ1bmN0aW9uIGdl
dFJlYWxDaGlsZCAodm5vZGUpIHsKICB2YXIgY29tcE9wdGlvbnMgPSB2bm9kZSAmJiB2bm9kZS5j
b21wb25lbnRPcHRpb25zOwogIGlmIChjb21wT3B0aW9ucyAmJiBjb21wT3B0aW9ucy5DdG9yLm9w
dGlvbnMuYWJzdHJhY3QpIHsKICAgIHJldHVybiBnZXRSZWFsQ2hpbGQoZ2V0Rmlyc3RDb21wb25l
bnRDaGlsZChjb21wT3B0aW9ucy5jaGlsZHJlbikpCiAgfSBlbHNlIHsKICAgIHJldHVybiB2bm9k
ZQogIH0KfQoKZnVuY3Rpb24gZXh0cmFjdFRyYW5zaXRpb25EYXRhIChjb21wKSB7CiAgdmFyIGRh
dGEgPSB7fTsKICB2YXIgb3B0aW9ucyA9IGNvbXAuJG9wdGlvbnM7CiAgLy8gcHJvcHMKICBmb3Ig
KHZhciBrZXkgaW4gb3B0aW9ucy5wcm9wc0RhdGEpIHsKICAgIGRhdGFba2V5XSA9IGNvbXBba2V5
XTsKICB9CiAgLy8gZXZlbnRzLgogIC8vIGV4dHJhY3QgbGlzdGVuZXJzIGFuZCBwYXNzIHRoZW0g
ZGlyZWN0bHkgdG8gdGhlIHRyYW5zaXRpb24gbWV0aG9kcwogIHZhciBsaXN0ZW5lcnMgPSBvcHRp
b25zLl9wYXJlbnRMaXN0ZW5lcnM7CiAgZm9yICh2YXIga2V5JDEgaW4gbGlzdGVuZXJzKSB7CiAg
ICBkYXRhW2NhbWVsaXplKGtleSQxKV0gPSBsaXN0ZW5lcnNba2V5JDFdLmZuOwogIH0KICByZXR1
cm4gZGF0YQp9CgpmdW5jdGlvbiBwbGFjZWhvbGRlciAoaCwgcmF3Q2hpbGQpIHsKICByZXR1cm4g
L1xkLWtlZXAtYWxpdmUkLy50ZXN0KHJhd0NoaWxkLnRhZykKICAgID8gaCgna2VlcC1hbGl2ZScp
CiAgICA6IG51bGwKfQoKZnVuY3Rpb24gaGFzUGFyZW50VHJhbnNpdGlvbiAodm5vZGUpIHsKICB3
aGlsZSAoKHZub2RlID0gdm5vZGUucGFyZW50KSkgewogICAgaWYgKHZub2RlLmRhdGEudHJhbnNp
dGlvbikgewogICAgICByZXR1cm4gdHJ1ZQogICAgfQogIH0KfQoKdmFyIFRyYW5zaXRpb24gPSB7
CiAgbmFtZTogJ3RyYW5zaXRpb24nLAogIHByb3BzOiB0cmFuc2l0aW9uUHJvcHMsCiAgYWJzdHJh
Y3Q6IHRydWUsCiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIgKGgpIHsKICAgIHZhciB0aGlzJDEg
PSB0aGlzOwoKICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuJHNsb3RzLmRlZmF1bHQ7CiAgICBpZiAo
IWNoaWxkcmVuKSB7CiAgICAgIHJldHVybgogICAgfQoKICAgIC8vIGZpbHRlciBvdXQgdGV4dCBu
b2RlcyAocG9zc2libGUgd2hpdGVzcGFjZXMpCiAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLmZpbHRl
cihmdW5jdGlvbiAoYykgeyByZXR1cm4gYy50YWc7IH0pOwogICAgLyogaXN0YW5idWwgaWdub3Jl
IGlmICovCiAgICBpZiAoIWNoaWxkcmVuLmxlbmd0aCkgewogICAgICByZXR1cm4KICAgIH0KCiAg
ICAvLyB3YXJuIG11bHRpcGxlIGVsZW1lbnRzCiAgICBpZiAoImRldmVsb3BtZW50IiAhPT0gJ3By
b2R1Y3Rpb24nICYmIGNoaWxkcmVuLmxlbmd0aCA+IDEpIHsKICAgICAgd2FybigKICAgICAgICAn
PHRyYW5zaXRpb24+IGNhbiBvbmx5IGJlIHVzZWQgb24gYSBzaW5nbGUgZWxlbWVudC4gVXNlICcg
KwogICAgICAgICc8dHJhbnNpdGlvbi1ncm91cD4gZm9yIGxpc3RzLicsCiAgICAgICAgdGhpcy4k
cGFyZW50CiAgICAgICk7CiAgICB9CgogICAgdmFyIG1vZGUgPSB0aGlzLm1vZGU7CgogICAgLy8g
d2FybiBpbnZhbGlkIG1vZGUKICAgIGlmICgiZGV2ZWxvcG1lbnQiICE9PSAncHJvZHVjdGlvbicg
JiYKICAgICAgICBtb2RlICYmIG1vZGUgIT09ICdpbi1vdXQnICYmIG1vZGUgIT09ICdvdXQtaW4n
KSB7CiAgICAgIHdhcm4oCiAgICAgICAgJ2ludmFsaWQgPHRyYW5zaXRpb24+IG1vZGU6ICcgKyBt
b2RlLAogICAgICAgIHRoaXMuJHBhcmVudAogICAgICApOwogICAgfQoKICAgIHZhciByYXdDaGls
ZCA9IGNoaWxkcmVuWzBdOwoKICAgIC8vIGlmIHRoaXMgaXMgYSBjb21wb25lbnQgcm9vdCBub2Rl
IGFuZCB0aGUgY29tcG9uZW50J3MKICAgIC8vIHBhcmVudCBjb250YWluZXIgbm9kZSBhbHNvIGhh
cyB0cmFuc2l0aW9uLCBza2lwLgogICAgaWYgKGhhc1BhcmVudFRyYW5zaXRpb24odGhpcy4kdm5v
ZGUpKSB7CiAgICAgIHJldHVybiByYXdDaGlsZAogICAgfQoKICAgIC8vIGFwcGx5IHRyYW5zaXRp
b24gZGF0YSB0byBjaGlsZAogICAgLy8gdXNlIGdldFJlYWxDaGlsZCgpIHRvIGlnbm9yZSBhYnN0
cmFjdCBjb21wb25lbnRzIGUuZy4ga2VlcC1hbGl2ZQogICAgdmFyIGNoaWxkID0gZ2V0UmVhbENo
aWxkKHJhd0NoaWxkKTsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKCFjaGls
ZCkgewogICAgICByZXR1cm4gcmF3Q2hpbGQKICAgIH0KCiAgICBpZiAodGhpcy5fbGVhdmluZykg
ewogICAgICByZXR1cm4gcGxhY2Vob2xkZXIoaCwgcmF3Q2hpbGQpCiAgICB9CgogICAgdmFyIGtl
eSA9IGNoaWxkLmtleSA9IGNoaWxkLmtleSA9PSBudWxsIHx8IGNoaWxkLmlzU3RhdGljCiAgICAg
ID8gKCJfX3YiICsgKGNoaWxkLnRhZyArIHRoaXMuX3VpZCkgKyAiX18iKQogICAgICA6IGNoaWxk
LmtleTsKICAgIHZhciBkYXRhID0gKGNoaWxkLmRhdGEgfHwgKGNoaWxkLmRhdGEgPSB7fSkpLnRy
YW5zaXRpb24gPSBleHRyYWN0VHJhbnNpdGlvbkRhdGEodGhpcyk7CiAgICB2YXIgb2xkUmF3Q2hp
bGQgPSB0aGlzLl92bm9kZTsKICAgIHZhciBvbGRDaGlsZCA9IGdldFJlYWxDaGlsZChvbGRSYXdD
aGlsZCk7CgogICAgLy8gbWFyayB2LXNob3cKICAgIC8vIHNvIHRoYXQgdGhlIHRyYW5zaXRpb24g
bW9kdWxlIGNhbiBoYW5kIG92ZXIgdGhlIGNvbnRyb2wgdG8gdGhlIGRpcmVjdGl2ZQogICAgaWYg
KGNoaWxkLmRhdGEuZGlyZWN0aXZlcyAmJiBjaGlsZC5kYXRhLmRpcmVjdGl2ZXMuc29tZShmdW5j
dGlvbiAoZCkgeyByZXR1cm4gZC5uYW1lID09PSAnc2hvdyc7IH0pKSB7CiAgICAgIGNoaWxkLmRh
dGEuc2hvdyA9IHRydWU7CiAgICB9CgogICAgaWYgKG9sZENoaWxkICYmIG9sZENoaWxkLmRhdGEg
JiYgb2xkQ2hpbGQua2V5ICE9PSBrZXkpIHsKICAgICAgLy8gcmVwbGFjZSBvbGQgY2hpbGQgdHJh
bnNpdGlvbiBkYXRhIHdpdGggZnJlc2ggb25lCiAgICAgIC8vIGltcG9ydGFudCBmb3IgZHluYW1p
YyB0cmFuc2l0aW9ucyEKICAgICAgdmFyIG9sZERhdGEgPSBvbGRDaGlsZC5kYXRhLnRyYW5zaXRp
b24gPSBleHRlbmQoe30sIGRhdGEpOwoKICAgICAgLy8gaGFuZGxlIHRyYW5zaXRpb24gbW9kZQog
ICAgICBpZiAobW9kZSA9PT0gJ291dC1pbicpIHsKICAgICAgICAvLyByZXR1cm4gcGxhY2Vob2xk
ZXIgbm9kZSBhbmQgcXVldWUgdXBkYXRlIHdoZW4gbGVhdmUgZmluaXNoZXMKICAgICAgICB0aGlz
Ll9sZWF2aW5nID0gdHJ1ZTsKICAgICAgICBtZXJnZVZOb2RlSG9vayhvbGREYXRhLCAnYWZ0ZXJM
ZWF2ZScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRoaXMkMS5fbGVhdmluZyA9IGZhbHNlOwog
ICAgICAgICAgdGhpcyQxLiRmb3JjZVVwZGF0ZSgpOwogICAgICAgIH0sIGtleSk7CiAgICAgICAg
cmV0dXJuIHBsYWNlaG9sZGVyKGgsIHJhd0NoaWxkKQogICAgICB9IGVsc2UgaWYgKG1vZGUgPT09
ICdpbi1vdXQnKSB7CiAgICAgICAgdmFyIGRlbGF5ZWRMZWF2ZTsKICAgICAgICB2YXIgcGVyZm9y
bUxlYXZlID0gZnVuY3Rpb24gKCkgeyBkZWxheWVkTGVhdmUoKTsgfTsKICAgICAgICBtZXJnZVZO
b2RlSG9vayhkYXRhLCAnYWZ0ZXJFbnRlcicsIHBlcmZvcm1MZWF2ZSwga2V5KTsKICAgICAgICBt
ZXJnZVZOb2RlSG9vayhkYXRhLCAnZW50ZXJDYW5jZWxsZWQnLCBwZXJmb3JtTGVhdmUsIGtleSk7
CiAgICAgICAgbWVyZ2VWTm9kZUhvb2sob2xkRGF0YSwgJ2RlbGF5TGVhdmUnLCBmdW5jdGlvbiAo
bGVhdmUpIHsKICAgICAgICAgIGRlbGF5ZWRMZWF2ZSA9IGxlYXZlOwogICAgICAgIH0sIGtleSk7
CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcmF3Q2hpbGQKICB9Cn07CgovKiAgKi8KCi8vIFBy
b3ZpZGVzIHRyYW5zaXRpb24gc3VwcG9ydCBmb3IgbGlzdCBpdGVtcy4KLy8gc3VwcG9ydHMgbW92
ZSB0cmFuc2l0aW9ucyB1c2luZyB0aGUgRkxJUCB0ZWNobmlxdWUuCgovLyBCZWNhdXNlIHRoZSB2
ZG9tJ3MgY2hpbGRyZW4gdXBkYXRlIGFsZ29yaXRobSBpcyAidW5zdGFibGUiIC0gaS5lLgovLyBp
dCBkb2Vzbid0IGd1YXJhbnRlZSB0aGUgcmVsYXRpdmUgcG9zaXRpb25pbmcgb2YgcmVtb3ZlZCBl
bGVtZW50cywKLy8gd2UgZm9yY2UgdHJhbnNpdGlvbi1ncm91cCB0byB1cGRhdGUgaXRzIGNoaWxk
cmVuIGludG8gdHdvIHBhc3NlczoKLy8gaW4gdGhlIGZpcnN0IHBhc3MsIHdlIHJlbW92ZSBhbGwg
bm9kZXMgdGhhdCBuZWVkIHRvIGJlIHJlbW92ZWQsCi8vIHRyaWdnZXJpbmcgdGhlaXIgbGVhdmlu
ZyB0cmFuc2l0aW9uOyBpbiB0aGUgc2Vjb25kIHBhc3MsIHdlIGluc2VydC9tb3ZlCi8vIGludG8g
dGhlIGZpbmFsIGRpc2lyZWQgc3RhdGUuIFRoaXMgd2F5IGluIHRoZSBzZWNvbmQgcGFzcyByZW1v
dmVkCi8vIG5vZGVzIHdpbGwgcmVtYWluIHdoZXJlIHRoZXkgc2hvdWxkIGJlLgoKdmFyIHByb3Bz
ID0gZXh0ZW5kKHsKICB0YWc6IFN0cmluZywKICBtb3ZlQ2xhc3M6IFN0cmluZwp9LCB0cmFuc2l0
aW9uUHJvcHMpOwoKZGVsZXRlIHByb3BzLm1vZGU7Cgp2YXIgVHJhbnNpdGlvbkdyb3VwID0gewog
IHByb3BzOiBwcm9wcywKCiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIgKGgpIHsKICAgIHZhciB0
YWcgPSB0aGlzLnRhZyB8fCB0aGlzLiR2bm9kZS5kYXRhLnRhZyB8fCAnc3Bhbic7CiAgICB2YXIg
bWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHZhciBwcmV2Q2hpbGRyZW4gPSB0aGlzLnBy
ZXZDaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47CiAgICB2YXIgcmF3Q2hpbGRyZW4gPSB0aGlzLiRz
bG90cy5kZWZhdWx0IHx8IFtdOwogICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbiA9IFtd
OwogICAgdmFyIHRyYW5zaXRpb25EYXRhID0gZXh0cmFjdFRyYW5zaXRpb25EYXRhKHRoaXMpOwoK
ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmF3Q2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgICAg
dmFyIGMgPSByYXdDaGlsZHJlbltpXTsKICAgICAgaWYgKGMudGFnKSB7CiAgICAgICAgaWYgKGMu
a2V5ICE9IG51bGwgJiYgU3RyaW5nKGMua2V5KS5pbmRleE9mKCdfX3ZsaXN0JykgIT09IDApIHsK
ICAgICAgICAgIGNoaWxkcmVuLnB1c2goYyk7CiAgICAgICAgICBtYXBbYy5rZXldID0gYwogICAg
ICAgICAgOyhjLmRhdGEgfHwgKGMuZGF0YSA9IHt9KSkudHJhbnNpdGlvbiA9IHRyYW5zaXRpb25E
YXRhOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgb3B0cyA9IGMuY29tcG9uZW50T3B0
aW9uczsKICAgICAgICAgIHZhciBuYW1lID0gb3B0cwogICAgICAgICAgICA/IChvcHRzLkN0b3Iu
b3B0aW9ucy5uYW1lIHx8IG9wdHMudGFnKQogICAgICAgICAgICA6IGMudGFnOwogICAgICAgICAg
d2FybigoIjx0cmFuc2l0aW9uLWdyb3VwPiBjaGlsZHJlbiBtdXN0IGJlIGtleWVkOiA8IiArIG5h
bWUgKyAiPiIpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAocHJldkNoaWxkcmVu
KSB7CiAgICAgIHZhciBrZXB0ID0gW107CiAgICAgIHZhciByZW1vdmVkID0gW107CiAgICAgIGZv
ciAodmFyIGkkMSA9IDA7IGkkMSA8IHByZXZDaGlsZHJlbi5sZW5ndGg7IGkkMSsrKSB7CiAgICAg
ICAgdmFyIGMkMSA9IHByZXZDaGlsZHJlbltpJDFdOwogICAgICAgIGMkMS5kYXRhLnRyYW5zaXRp
b24gPSB0cmFuc2l0aW9uRGF0YTsKICAgICAgICBjJDEuZGF0YS5wb3MgPSBjJDEuZWxtLmdldEJv
dW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGlmIChtYXBbYyQxLmtleV0pIHsKICAgICAgICAg
IGtlcHQucHVzaChjJDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZW1vdmVkLnB1c2go
YyQxKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5rZXB0ID0gaCh0YWcsIG51bGwsIGtl
cHQpOwogICAgICB0aGlzLnJlbW92ZWQgPSByZW1vdmVkOwogICAgfQoKICAgIHJldHVybiBoKHRh
ZywgbnVsbCwgY2hpbGRyZW4pCiAgfSwKCiAgYmVmb3JlVXBkYXRlOiBmdW5jdGlvbiBiZWZvcmVV
cGRhdGUgKCkgewogICAgLy8gZm9yY2UgcmVtb3ZpbmcgcGFzcwogICAgdGhpcy5fX3BhdGNoX18o
CiAgICAgIHRoaXMuX3Zub2RlLAogICAgICB0aGlzLmtlcHQsCiAgICAgIGZhbHNlLCAvLyBoeWRy
YXRpbmcKICAgICAgdHJ1ZSAvLyByZW1vdmVPbmx5ICghaW1wb3J0YW50LCBhdm9pZHMgdW5uZWNl
c3NhcnkgbW92ZXMpCiAgICApOwogICAgdGhpcy5fdm5vZGUgPSB0aGlzLmtlcHQ7CiAgfSwKCiAg
dXBkYXRlZDogZnVuY3Rpb24gdXBkYXRlZCAoKSB7CiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLnBy
ZXZDaGlsZHJlbjsKICAgIHZhciBtb3ZlQ2xhc3MgPSB0aGlzLm1vdmVDbGFzcyB8fCAoKHRoaXMu
bmFtZSB8fCAndicpICsgJy1tb3ZlJyk7CiAgICBpZiAoIWNoaWxkcmVuLmxlbmd0aCB8fCAhdGhp
cy5oYXNNb3ZlKGNoaWxkcmVuWzBdLmVsbSwgbW92ZUNsYXNzKSkgewogICAgICByZXR1cm4KICAg
IH0KCiAgICAvLyB3ZSBkaXZpZGUgdGhlIHdvcmsgaW50byB0aHJlZSBsb29wcyB0byBhdm9pZCBt
aXhpbmcgRE9NIHJlYWRzIGFuZCB3cml0ZXMKICAgIC8vIGluIGVhY2ggaXRlcmF0aW9uIC0gd2hp
Y2ggaGVscHMgcHJldmVudCBsYXlvdXQgdGhyYXNoaW5nLgogICAgY2hpbGRyZW4uZm9yRWFjaChj
YWxsUGVuZGluZ0Nicyk7CiAgICBjaGlsZHJlbi5mb3JFYWNoKHJlY29yZFBvc2l0aW9uKTsKICAg
IGNoaWxkcmVuLmZvckVhY2goYXBwbHlUcmFuc2xhdGlvbik7CgogICAgLy8gZm9yY2UgcmVmbG93
IHRvIHB1dCBldmVyeXRoaW5nIGluIHBvc2l0aW9uCiAgICB2YXIgZiA9IGRvY3VtZW50LmJvZHku
b2Zmc2V0SGVpZ2h0OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCgogICAgY2hpbGRyZW4uZm9yRWFj
aChmdW5jdGlvbiAoYykgewogICAgICBpZiAoYy5kYXRhLm1vdmVkKSB7CiAgICAgICAgdmFyIGVs
ID0gYy5lbG07CiAgICAgICAgdmFyIHMgPSBlbC5zdHlsZTsKICAgICAgICBhZGRUcmFuc2l0aW9u
Q2xhc3MoZWwsIG1vdmVDbGFzcyk7CiAgICAgICAgcy50cmFuc2Zvcm0gPSBzLldlYmtpdFRyYW5z
Zm9ybSA9IHMudHJhbnNpdGlvbkR1cmF0aW9uID0gJyc7CiAgICAgICAgZWwuYWRkRXZlbnRMaXN0
ZW5lcih0cmFuc2l0aW9uRW5kRXZlbnQsIGVsLl9tb3ZlQ2IgPSBmdW5jdGlvbiBjYiAoZSkgewog
ICAgICAgICAgaWYgKCFlIHx8IC90cmFuc2Zvcm0kLy50ZXN0KGUucHJvcGVydHlOYW1lKSkgewog
ICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKHRyYW5zaXRpb25FbmRFdmVudCwgY2Ip
OwogICAgICAgICAgICBlbC5fbW92ZUNiID0gbnVsbDsKICAgICAgICAgICAgcmVtb3ZlVHJhbnNp
dGlvbkNsYXNzKGVsLCBtb3ZlQ2xhc3MpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9
CiAgICB9KTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBoYXNNb3ZlOiBmdW5jdGlvbiBoYXNNb3Zl
IChlbCwgbW92ZUNsYXNzKSB7CiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgICBp
ZiAoIWhhc1RyYW5zaXRpb24pIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgICBp
ZiAodGhpcy5faGFzTW92ZSAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX2hhc01vdmUK
ICAgICAgfQogICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIG1vdmVDbGFzcyk7CiAgICAgIHZh
ciBpbmZvID0gZ2V0VHJhbnNpdGlvbkluZm8oZWwpOwogICAgICByZW1vdmVUcmFuc2l0aW9uQ2xh
c3MoZWwsIG1vdmVDbGFzcyk7CiAgICAgIHJldHVybiAodGhpcy5faGFzTW92ZSA9IGluZm8uaGFz
VHJhbnNmb3JtKQogICAgfQogIH0KfTsKCmZ1bmN0aW9uIGNhbGxQZW5kaW5nQ2JzIChjKSB7CiAg
LyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGMuZWxtLl9tb3ZlQ2IpIHsKICAgIGMuZWxt
Ll9tb3ZlQ2IoKTsKICB9CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGMuZWxtLl9l
bnRlckNiKSB7CiAgICBjLmVsbS5fZW50ZXJDYigpOwogIH0KfQoKZnVuY3Rpb24gcmVjb3JkUG9z
aXRpb24gKGMpIHsKICBjLmRhdGEubmV3UG9zID0gYy5lbG0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0
KCk7Cn0KCmZ1bmN0aW9uIGFwcGx5VHJhbnNsYXRpb24gKGMpIHsKICB2YXIgb2xkUG9zID0gYy5k
YXRhLnBvczsKICB2YXIgbmV3UG9zID0gYy5kYXRhLm5ld1BvczsKICB2YXIgZHggPSBvbGRQb3Mu
bGVmdCAtIG5ld1Bvcy5sZWZ0OwogIHZhciBkeSA9IG9sZFBvcy50b3AgLSBuZXdQb3MudG9wOwog
IGlmIChkeCB8fCBkeSkgewogICAgYy5kYXRhLm1vdmVkID0gdHJ1ZTsKICAgIHZhciBzID0gYy5l
bG0uc3R5bGU7CiAgICBzLnRyYW5zZm9ybSA9IHMuV2Via2l0VHJhbnNmb3JtID0gInRyYW5zbGF0
ZSgiICsgZHggKyAicHgsIiArIGR5ICsgInB4KSI7CiAgICBzLnRyYW5zaXRpb25EdXJhdGlvbiA9
ICcwcyc7CiAgfQp9Cgp2YXIgcGxhdGZvcm1Db21wb25lbnRzID0gewogIFRyYW5zaXRpb246IFRy
YW5zaXRpb24sCiAgVHJhbnNpdGlvbkdyb3VwOiBUcmFuc2l0aW9uR3JvdXAKfTsKCi8qICAqLwoK
Ly8gaW5zdGFsbCBwbGF0Zm9ybSBzcGVjaWZpYyB1dGlscwpWdWUkMy5jb25maWcuaXNVbmtub3du
RWxlbWVudCA9IGlzVW5rbm93bkVsZW1lbnQ7ClZ1ZSQzLmNvbmZpZy5pc1Jlc2VydmVkVGFnID0g
aXNSZXNlcnZlZFRhZzsKVnVlJDMuY29uZmlnLmdldFRhZ05hbWVzcGFjZSA9IGdldFRhZ05hbWVz
cGFjZTsKVnVlJDMuY29uZmlnLm11c3RVc2VQcm9wID0gbXVzdFVzZVByb3A7CgovLyBpbnN0YWxs
IHBsYXRmb3JtIHJ1bnRpbWUgZGlyZWN0aXZlcyAmIGNvbXBvbmVudHMKZXh0ZW5kKFZ1ZSQzLm9w
dGlvbnMuZGlyZWN0aXZlcywgcGxhdGZvcm1EaXJlY3RpdmVzKTsKZXh0ZW5kKFZ1ZSQzLm9wdGlv
bnMuY29tcG9uZW50cywgcGxhdGZvcm1Db21wb25lbnRzKTsKCi8vIGluc3RhbGwgcGxhdGZvcm0g
cGF0Y2ggZnVuY3Rpb24KVnVlJDMucHJvdG90eXBlLl9fcGF0Y2hfXyA9IGluQnJvd3NlciA/IHBh
dGNoJDEgOiBub29wOwoKLy8gd3JhcCBtb3VudApWdWUkMy5wcm90b3R5cGUuJG1vdW50ID0gZnVu
Y3Rpb24gKAogIGVsLAogIGh5ZHJhdGluZwopIHsKICBlbCA9IGVsICYmIGluQnJvd3NlciA/IHF1
ZXJ5KGVsKSA6IHVuZGVmaW5lZDsKICByZXR1cm4gdGhpcy5fbW91bnQoZWwsIGh5ZHJhdGluZykK
fTsKCi8vIGRldnRvb2xzIGdsb2JhbCBob29rCi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCnNl
dFRpbWVvdXQoZnVuY3Rpb24gKCkgewogIGlmIChjb25maWcuZGV2dG9vbHMpIHsKICAgIGlmIChk
ZXZ0b29scykgewogICAgICBkZXZ0b29scy5lbWl0KCdpbml0JywgVnVlJDMpOwogICAgfSBlbHNl
IGlmICgKICAgICAgImRldmVsb3BtZW50IiAhPT0gJ3Byb2R1Y3Rpb24nICYmCiAgICAgIGluQnJv
d3NlciAmJiAhaXNFZGdlICYmIC9DaHJvbWVcL1xkKy8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVz
ZXJBZ2VudCkKICAgICkgewogICAgICBjb25zb2xlLmxvZygKICAgICAgICAnRG93bmxvYWQgdGhl
IFZ1ZSBEZXZ0b29scyBmb3IgYSBiZXR0ZXIgZGV2ZWxvcG1lbnQgZXhwZXJpZW5jZTpcbicgKwog
ICAgICAgICdodHRwczovL2dpdGh1Yi5jb20vdnVlanMvdnVlLWRldnRvb2xzJwogICAgICApOwog
ICAgfQogIH0KfSwgMCk7CgovKiAgKi8KCi8vIGNoZWNrIHdoZXRoZXIgY3VycmVudCBicm93c2Vy
IGVuY29kZXMgYSBjaGFyIGluc2lkZSBhdHRyaWJ1dGUgdmFsdWVzCmZ1bmN0aW9uIHNob3VsZERl
Y29kZSAoY29udGVudCwgZW5jb2RlZCkgewogIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVt
ZW50KCdkaXYnKTsKICBkaXYuaW5uZXJIVE1MID0gIjxkaXYgYT1cIiIgKyBjb250ZW50ICsgIlwi
PiI7CiAgcmV0dXJuIGRpdi5pbm5lckhUTUwuaW5kZXhPZihlbmNvZGVkKSA+IDAKfQoKLy8gIzM2
NjMKLy8gSUUgZW5jb2RlcyBuZXdsaW5lcyBpbnNpZGUgYXR0cmlidXRlIHZhbHVlcyB3aGlsZSBv
dGhlciBicm93c2VycyBkb24ndAp2YXIgc2hvdWxkRGVjb2RlTmV3bGluZXMgPSBpbkJyb3dzZXIg
PyBzaG91bGREZWNvZGUoJ1xuJywgJyYjMTA7JykgOiBmYWxzZTsKCi8qICAqLwoKdmFyIGRlY29k
ZXI7CgpmdW5jdGlvbiBkZWNvZGUgKGh0bWwpIHsKICBkZWNvZGVyID0gZGVjb2RlciB8fCBkb2N1
bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICBkZWNvZGVyLmlubmVySFRNTCA9IGh0bWw7CiAg
cmV0dXJuIGRlY29kZXIudGV4dENvbnRlbnQKfQoKLyogICovCgp2YXIgaXNVbmFyeVRhZyA9IG1h
a2VNYXAoCiAgJ2FyZWEsYmFzZSxicixjb2wsZW1iZWQsZnJhbWUsaHIsaW1nLGlucHV0LGlzaW5k
ZXgsa2V5Z2VuLCcgKwogICdsaW5rLG1ldGEscGFyYW0sc291cmNlLHRyYWNrLHdicicsCiAgdHJ1
ZQopOwoKLy8gRWxlbWVudHMgdGhhdCB5b3UgY2FuLCBpbnRlbnRpb25hbGx5LCBsZWF2ZSBvcGVu
Ci8vIChhbmQgd2hpY2ggY2xvc2UgdGhlbXNlbHZlcykKdmFyIGNhbkJlTGVmdE9wZW5UYWcgPSBt
YWtlTWFwKAogICdjb2xncm91cCxkZCxkdCxsaSxvcHRpb25zLHAsdGQsdGZvb3QsdGgsdGhlYWQs
dHIsc291cmNlJywKICB0cnVlCik7CgovLyBIVE1MNSB0YWdzIGh0dHBzOi8vaHRtbC5zcGVjLndo
YXR3Zy5vcmcvbXVsdGlwYWdlL2luZGljZXMuaHRtbCNlbGVtZW50cy0zCi8vIFBocmFzaW5nIENv
bnRlbnQgaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvZG9tLmh0bWwjcGhy
YXNpbmctY29udGVudAp2YXIgaXNOb25QaHJhc2luZ1RhZyA9IG1ha2VNYXAoCiAgJ2FkZHJlc3Ms
YXJ0aWNsZSxhc2lkZSxiYXNlLGJsb2NrcXVvdGUsYm9keSxjYXB0aW9uLGNvbCxjb2xncm91cCxk
ZCwnICsKICAnZGV0YWlscyxkaWFsb2csZGl2LGRsLGR0LGZpZWxkc2V0LGZpZ2NhcHRpb24sZmln
dXJlLGZvb3Rlcixmb3JtLCcgKwogICdoMSxoMixoMyxoNCxoNSxoNixoZWFkLGhlYWRlcixoZ3Jv
dXAsaHIsaHRtbCxsZWdlbmQsbGksbWVudWl0ZW0sbWV0YSwnICsKICAnb3B0Z3JvdXAsb3B0aW9u
LHBhcmFtLHJwLHJ0LHNvdXJjZSxzdHlsZSxzdW1tYXJ5LHRib2R5LHRkLHRmb290LHRoLHRoZWFk
LCcgKwogICd0aXRsZSx0cix0cmFjaycsCiAgdHJ1ZQopOwoKLyoqCiAqIE5vdCB0eXBlLWNoZWNr
aW5nIHRoaXMgZmlsZSBiZWNhdXNlIGl0J3MgbW9zdGx5IHZlbmRvciBjb2RlLgogKi8KCi8qIQog
KiBIVE1MIFBhcnNlciBCeSBKb2huIFJlc2lnIChlam9obi5vcmcpCiAqIE1vZGlmaWVkIGJ5IEp1
cml5ICJrYW5nYXgiIFpheXRzZXYKICogT3JpZ2luYWwgY29kZSBieSBFcmlrIEFydmlkc3Nvbiwg
TW96aWxsYSBQdWJsaWMgTGljZW5zZQogKiBodHRwOi8vZXJpay5lYWUubmV0L3NpbXBsZWh0bWxw
YXJzZXIvc2ltcGxlaHRtbHBhcnNlci5qcwogKi8KCi8vIFJlZ3VsYXIgRXhwcmVzc2lvbnMgZm9y
IHBhcnNpbmcgdGFncyBhbmQgYXR0cmlidXRlcwp2YXIgc2luZ2xlQXR0cklkZW50aWZpZXIgPSAv
KFteXHMiJzw+Lz1dKykvOwp2YXIgc2luZ2xlQXR0ckFzc2lnbiA9IC8oPzo9KS87CnZhciBzaW5n
bGVBdHRyVmFsdWVzID0gWwogIC8vIGF0dHIgdmFsdWUgZG91YmxlIHF1b3RlcwogIC8iKFteIl0q
KSIrLy5zb3VyY2UsCiAgLy8gYXR0ciB2YWx1ZSwgc2luZ2xlIHF1b3RlcwogIC8nKFteJ10qKScr
Ly5zb3VyY2UsCiAgLy8gYXR0ciB2YWx1ZSwgbm8gcXVvdGVzCiAgLyhbXlxzIic9PD5gXSspLy5z
b3VyY2UKXTsKdmFyIGF0dHJpYnV0ZSA9IG5ldyBSZWdFeHAoCiAgJ15cXHMqJyArIHNpbmdsZUF0
dHJJZGVudGlmaWVyLnNvdXJjZSArCiAgJyg/OlxccyooJyArIHNpbmdsZUF0dHJBc3NpZ24uc291
cmNlICsgJyknICsKICAnXFxzKig/OicgKyBzaW5nbGVBdHRyVmFsdWVzLmpvaW4oJ3wnKSArICcp
KT8nCik7CgovLyBjb3VsZCB1c2UgaHR0cHM6Ly93d3cudzMub3JnL1RSLzE5OTkvUkVDLXhtbC1u
YW1lcy0xOTk5MDExNC8jTlQtUU5hbWUKLy8gYnV0IGZvciBWdWUgdGVtcGxhdGVzIHdlIGNhbiBl
bmZvcmNlIGEgc2ltcGxlIGNoYXJzZXQKdmFyIG5jbmFtZSA9ICdbYS16QS1aX11bXFx3XFwtXFwu
XSonOwp2YXIgcW5hbWVDYXB0dXJlID0gJygoPzonICsgbmNuYW1lICsgJ1xcOik/JyArIG5jbmFt
ZSArICcpJzsKdmFyIHN0YXJ0VGFnT3BlbiA9IG5ldyBSZWdFeHAoJ148JyArIHFuYW1lQ2FwdHVy
ZSk7CnZhciBzdGFydFRhZ0Nsb3NlID0gL15ccyooXC8/KT4vOwp2YXIgZW5kVGFnID0gbmV3IFJl
Z0V4cCgnXjxcXC8nICsgcW5hbWVDYXB0dXJlICsgJ1tePl0qPicpOwp2YXIgZG9jdHlwZSA9IC9e
PCFET0NUWVBFIFtePl0rPi9pOwp2YXIgY29tbWVudCA9IC9ePCEtLS87CnZhciBjb25kaXRpb25h
bENvbW1lbnQgPSAvXjwhXFsvOwoKdmFyIElTX1JFR0VYX0NBUFRVUklOR19CUk9LRU4gPSBmYWxz
ZTsKJ3gnLnJlcGxhY2UoL3goLik/L2csIGZ1bmN0aW9uIChtLCBnKSB7CiAgSVNfUkVHRVhfQ0FQ
VFVSSU5HX0JST0tFTiA9IGcgPT09ICcnOwp9KTsKCi8vIFNwZWNpYWwgRWxlbWVudHMgKGNhbiBj
b250YWluIGFueXRoaW5nKQp2YXIgaXNTY3JpcHRPclN0eWxlID0gbWFrZU1hcCgnc2NyaXB0LHN0
eWxlJywgdHJ1ZSk7CnZhciBoYXNMYW5nID0gZnVuY3Rpb24gKGF0dHIpIHsgcmV0dXJuIGF0dHIu
bmFtZSA9PT0gJ2xhbmcnICYmIGF0dHIudmFsdWUgIT09ICdodG1sJzsgfTsKdmFyIGlzU3BlY2lh
bFRhZyA9IGZ1bmN0aW9uICh0YWcsIGlzU0ZDLCBzdGFjaykgewogIGlmIChpc1NjcmlwdE9yU3R5
bGUodGFnKSkgewogICAgcmV0dXJuIHRydWUKICB9CiAgaWYgKGlzU0ZDICYmIHN0YWNrLmxlbmd0
aCA9PT0gMSkgewogICAgLy8gdG9wLWxldmVsIHRlbXBsYXRlIHRoYXQgaGFzIG5vIHByZS1wcm9j
ZXNzb3IKICAgIGlmICh0YWcgPT09ICd0ZW1wbGF0ZScgJiYgIXN0YWNrWzBdLmF0dHJzLnNvbWUo
aGFzTGFuZykpIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9IGVsc2UgewogICAgICByZXR1cm4g
dHJ1ZQogICAgfQogIH0KICByZXR1cm4gZmFsc2UKfTsKCnZhciByZUNhY2hlID0ge307Cgp2YXIg
bHRSRSA9IC8mbHQ7L2c7CnZhciBndFJFID0gLyZndDsvZzsKdmFyIG5sUkUgPSAvJiMxMDsvZzsK
dmFyIGFtcFJFID0gLyZhbXA7L2c7CnZhciBxdW90ZVJFID0gLyZxdW90Oy9nOwoKZnVuY3Rpb24g
ZGVjb2RlQXR0ciAodmFsdWUsIHNob3VsZERlY29kZU5ld2xpbmVzKSB7CiAgaWYgKHNob3VsZERl
Y29kZU5ld2xpbmVzKSB7CiAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UobmxSRSwgJ1xuJyk7CiAg
fQogIHJldHVybiB2YWx1ZQogICAgLnJlcGxhY2UobHRSRSwgJzwnKQogICAgLnJlcGxhY2UoZ3RS
RSwgJz4nKQogICAgLnJlcGxhY2UoYW1wUkUsICcmJykKICAgIC5yZXBsYWNlKHF1b3RlUkUsICci
JykKfQoKZnVuY3Rpb24gcGFyc2VIVE1MIChodG1sLCBvcHRpb25zKSB7CiAgdmFyIHN0YWNrID0g
W107CiAgdmFyIGV4cGVjdEhUTUwgPSBvcHRpb25zLmV4cGVjdEhUTUw7CiAgdmFyIGlzVW5hcnlU
YWckJDEgPSBvcHRpb25zLmlzVW5hcnlUYWcgfHwgbm87CiAgdmFyIGluZGV4ID0gMDsKICB2YXIg
bGFzdCwgbGFzdFRhZzsKICB3aGlsZSAoaHRtbCkgewogICAgbGFzdCA9IGh0bWw7CiAgICAvLyBN
YWtlIHN1cmUgd2UncmUgbm90IGluIGEgc2NyaXB0IG9yIHN0eWxlIGVsZW1lbnQKICAgIGlmICgh
bGFzdFRhZyB8fCAhaXNTcGVjaWFsVGFnKGxhc3RUYWcsIG9wdGlvbnMuc2ZjLCBzdGFjaykpIHsK
ICAgICAgdmFyIHRleHRFbmQgPSBodG1sLmluZGV4T2YoJzwnKTsKICAgICAgaWYgKHRleHRFbmQg
PT09IDApIHsKICAgICAgICAvLyBDb21tZW50OgogICAgICAgIGlmIChjb21tZW50LnRlc3QoaHRt
bCkpIHsKICAgICAgICAgIHZhciBjb21tZW50RW5kID0gaHRtbC5pbmRleE9mKCctLT4nKTsKCiAg
ICAgICAgICBpZiAoY29tbWVudEVuZCA+PSAwKSB7CiAgICAgICAgICAgIGFkdmFuY2UoY29tbWVu
dEVuZCArIDMpOwogICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgfQogICAgICAgIH0KCiAg
ICAgICAgLy8gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db25kaXRpb25hbF9jb21tZW50
I0Rvd25sZXZlbC1yZXZlYWxlZF9jb25kaXRpb25hbF9jb21tZW50CiAgICAgICAgaWYgKGNvbmRp
dGlvbmFsQ29tbWVudC50ZXN0KGh0bWwpKSB7CiAgICAgICAgICB2YXIgY29uZGl0aW9uYWxFbmQg
PSBodG1sLmluZGV4T2YoJ10+Jyk7CgogICAgICAgICAgaWYgKGNvbmRpdGlvbmFsRW5kID49IDAp
IHsKICAgICAgICAgICAgYWR2YW5jZShjb25kaXRpb25hbEVuZCArIDIpOwogICAgICAgICAgICBj
b250aW51ZQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gRG9jdHlwZToKICAgICAg
ICB2YXIgZG9jdHlwZU1hdGNoID0gaHRtbC5tYXRjaChkb2N0eXBlKTsKICAgICAgICBpZiAoZG9j
dHlwZU1hdGNoKSB7CiAgICAgICAgICBhZHZhbmNlKGRvY3R5cGVNYXRjaFswXS5sZW5ndGgpOwog
ICAgICAgICAgY29udGludWUKICAgICAgICB9CgogICAgICAgIC8vIEVuZCB0YWc6CiAgICAgICAg
dmFyIGVuZFRhZ01hdGNoID0gaHRtbC5tYXRjaChlbmRUYWcpOwogICAgICAgIGlmIChlbmRUYWdN
YXRjaCkgewogICAgICAgICAgdmFyIGN1ckluZGV4ID0gaW5kZXg7CiAgICAgICAgICBhZHZhbmNl
KGVuZFRhZ01hdGNoWzBdLmxlbmd0aCk7CiAgICAgICAgICBwYXJzZUVuZFRhZyhlbmRUYWdNYXRj
aFswXSwgZW5kVGFnTWF0Y2hbMV0sIGN1ckluZGV4LCBpbmRleCk7CiAgICAgICAgICBjb250aW51
ZQogICAgICAgIH0KCiAgICAgICAgLy8gU3RhcnQgdGFnOgogICAgICAgIHZhciBzdGFydFRhZ01h
dGNoID0gcGFyc2VTdGFydFRhZygpOwogICAgICAgIGlmIChzdGFydFRhZ01hdGNoKSB7CiAgICAg
ICAgICBoYW5kbGVTdGFydFRhZyhzdGFydFRhZ01hdGNoKTsKICAgICAgICAgIGNvbnRpbnVlCiAg
ICAgICAgfQogICAgICB9CgogICAgICB2YXIgdGV4dCA9ICh2b2lkIDApLCByZXN0JDEgPSAodm9p
ZCAwKSwgbmV4dCA9ICh2b2lkIDApOwogICAgICBpZiAodGV4dEVuZCA+IDApIHsKICAgICAgICBy
ZXN0JDEgPSBodG1sLnNsaWNlKHRleHRFbmQpOwogICAgICAgIHdoaWxlICgKICAgICAgICAgICFl
bmRUYWcudGVzdChyZXN0JDEpICYmCiAgICAgICAgICAhc3RhcnRUYWdPcGVuLnRlc3QocmVzdCQx
KSAmJgogICAgICAgICAgIWNvbW1lbnQudGVzdChyZXN0JDEpICYmCiAgICAgICAgICAhY29uZGl0
aW9uYWxDb21tZW50LnRlc3QocmVzdCQxKQogICAgICAgICkgewogICAgICAgICAgLy8gPCBpbiBw
bGFpbiB0ZXh0LCBiZSBmb3JnaXZpbmc=</Default>
</Parameter>

<Method name="ContentType">
<ClassMethod>1</ClassMethod>
<FormalSpec>FileName</FormalSpec>
<ReturnType>%Library.String</ReturnType>
<Implementation><![CDATA[
     s rashirenie=$p(FileName ,".", $l(FileName,"."))
     q:rashirenie="html" "text/html"
     q:rashirenie="htm" "text/html"
     q:rashirenie="css" "text/css"
     q:rashirenie="js" "application/javascript"
     q:rashirenie="txt" "text/plain"
     q "application/octet-stream"
]]></Implementation>
</Method>

<Method name="OnPage">
<Description>
18/05/2017  12:02:42</Description>
<ClassMethod>1</ClassMethod>
<ReturnType>%Library.Status</ReturnType>
<Implementation><![CDATA[
   w $system.Encryption.Base64Decode(..#Frag916644214336275393184859)

   w $system.Encryption.Base64Decode(..#Frag916644214336233193835390)

   w $system.Encryption.Base64Decode(..#Frag91664421433626082294730)

   w $system.Encryption.Base64Decode(..#Frag916644214336259390010677)

   w $system.Encryption.Base64Decode(..#Frag916644214336285718623729)

   w $system.Encryption.Base64Decode(..#Frag916644214336221796288690)

   w $system.Encryption.Base64Decode(..#Frag91664421433626797493787)

     Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPreHTTP">
<ClassMethod>1</ClassMethod>
<ReturnType>%Library.Boolean</ReturnType>
<Implementation><![CDATA[
    if $d(%request.Data("download",1))
    {
       Do %response.SetHeader("Content-Disposition: attachment; filename=","VueJSv216.js") 
       Do %response.SetHeader("Content-Length","216942") 
       q 1  
    }
    Do %response.SetHeader("Content-Type","application/javascript")   
    q 1
]]></Implementation>
</Method>
</Class>
</Export>
